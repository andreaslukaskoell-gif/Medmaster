{
  "permissions": {
    "allow": [
      "Bash(npm run *)",
      "Bash(npx *)",
      "Bash(node *)",
      "Bash(git *)",
      "Bash(gh *)",
      "Bash(ls *)",
      "Bash(cat *)",
      "Bash(echo *)",
      "Bash(find *)",
      "Bash(grep *)",
      "Bash(awk *)",
      "Bash(wc *)",
      "Bash(bc *)",
      "Bash(du *)",
      "Bash(diff *)",
      "Bash(python3 *)",
      "Bash(open *)",
      "Bash(curl *)",
      "Bash(vercel *)",
      "Bash(supabase *)",
      "Bash(tmux *)",
      "Bash(lsof *)",
      "Bash(test *)",
      "WebFetch(domain:raw.githubusercontent.com)",
      "WebSearch",
      "WebFetch(domain:www.youtube.com)",
      "WebFetch(domain:www.reddit.com)",
      "mcp__plugin_context7_context7__resolve-library-id",
      "mcp__plugin_claude-mem_mcp-search__search",
      "mcp__n8n-mcp__search_nodes",
      "Bash(python3 -c \"\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\n# Line 1154 \\(0-indexed: 1153\\) is the closing '      },' of the altfrage block\n# We need to insert 'selfTest: [],' after it \\(before '    },' at line 1155\\)\n# Lines are 0-indexed: line 1155 is index 1154, line 1156 is index 1155\n\n# Find the exact insert point: after '      },' \\(altfrage close\\) and before '    },' \\(section close\\)\ninsert_idx = 1154  # After line 1154 \\(1-indexed\\), i.e. after index 1153\nprint\\(repr\\(lines[1152]\\)\\)  # Line 1153 \\(1-indexed\\)\nprint\\(repr\\(lines[1153]\\)\\)  # Line 1154 \\(1-indexed\\)\nprint\\(repr\\(lines[1154]\\)\\)  # Line 1155 \\(1-indexed\\)\nprint\\(repr\\(lines[1155]\\)\\)  # Line 1156 \\(1-indexed\\)\n\")",
      "Bash(python3 -c \"\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\n# Insert 'selfTest: [],' after index 1153 \\(line 1154\\), before index 1154 \\(line 1155\\)\nlines.insert\\(1154, '      selfTest: [],\\\\n'\\)\n\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts', 'w'\\) as f:\n    f.writelines\\(lines\\)\n\nprint\\('Done. Lines around insertion:'\\)\nfor i in range\\(1151, 1160\\):\n    print\\(f'  {i+1}: {lines[i].rstrip\\(\\)}'\\)\n\")",
      "Bash(python3 -c \"\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\n# Lines 762, 763, 764 are indices 761, 762, 763 \\(0-based\\)\n# Line 762: blank line\n# Line 763: '      diagram: \\\\\"doppler-effect\\\\\",'\n# Line 764: blank line\nprint\\('Before removal:'\\)\nfor i in range\\(758, 768\\):\n    print\\(f'  {i+1}: {lines[i].rstrip\\(\\)}'\\)\n\n# Remove lines 761, 762, 763 \\(0-indexed\\) = lines 762, 763, 764 \\(1-indexed\\)\ndel lines[761:764]\n\nprint\\('After removal:'\\)\nfor i in range\\(758, 767\\):\n    print\\(f'  {i+1}: {lines[i].rstrip\\(\\)}'\\)\n\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts', 'w'\\) as f:\n    f.writelines\\(lines\\)\nprint\\('File written.'\\)\n\")",
      "Bash(git add src/pages/BMS.tsx src/components/layout/Sidebar.tsx src/data/glossary.ts src/components/chapter/SubchapterContent.tsx src/pages/BMSUnterkapitel.tsx src/data/bmsKapitel/chemie/kap4-reaktionen-gleichgewicht.ts src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts src/data/bmsKapitel/chemie/kap1-atombau-periodensystem.ts src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts && git commit -m \"fix: cold-start spinner, altfrage keys, selfTest, merksaetze typo, duplicate nav+diagram\n\n- BMS: add missing 3rd arg to loadBMSChaptersSWR \\(fixes cold-start infinite spinner\\)\n- Sidebar: remove duplicate /preise entry \\(CreditCard Preise\\), keep Konto & Preise\n- glossary/SubchapterContent/BMSUnterkapitel: remove unused _pathFn param from processTextForSmartLinks\n- kap4-reaktionen-gleichgewicht: frage/antwort -> question/answer in altfrage objects\n- kap2-materie-und-zustaende: add missing selfTest: [] to ch-4-02 Phasenübergänge\n- kap1-atombau-periodensystem: merksaetze -> merksätze typo fix\n- kap3-schwingungen-und-wellen: remove duplicate diagram property in ph-3-04\")",
      "Bash(npm install --save-dev playwright 2>&1 | tail -10)",
      "Bash(# Those \"missing question\" entries are false positives from LaTeX math in backtick strings.\n# The real issue is still: uk is undefined when uk.selfTest is accessed.\n#\n# Let me look at the actual error more carefully.\n# The error says: \"Cannot read properties of undefined \\(reading 'selfTest'\\)\"\n# This means uk IS undefined \\(not just selfTest being undefined\\).\n#\n# The loop is: for \\(const uk of uks\\) { const questions = uk.selfTest ?? []; }\n# If uk is undefined, then uk.selfTest throws.\n#\n# Let me check each chapter file for potential undefined items in their unterkapitel arrays.\n# Look for consecutive commas \\(empty array slots\\) or spreads of potentially undefined values.\n\npython3 << 'PYEOF'\nimport re, os\n\nchapter_files = {\n    'bio/kap1': '/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap1-die-zelle.ts',\n    'bio/kap2': '/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts',\n    'bio/kap3': '/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts',\n    'bio/kap4': '/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts',\n    'bio/kap5': '/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts',\n    'chem/kap1': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap1-atombau-periodensystem.ts',\n    'chem/kap2': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts',\n    'chem/kap4': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap4-reaktionen-gleichgewicht.ts',\n    'chem/kap5': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap5-anorganische-chemie.ts',\n    'chem/kap6b': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-chemische-bindung.ts',\n    'chem/kap6o': '/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts',\n    'phys/kap1': '/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap1-mechanik-grundlagen.ts',\n    'phys/kap3': '/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts',\n    'phys/kap4e': '/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-elektrizitaet-optik.ts',\n    'phys/kap4w': '/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts',\n    'phys/kap7': '/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap7-atomphysik.ts',\n    'math/kap1': '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap1-zahlen-einheiten.ts',\n    'math/kap2': '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap2-algebra-geometrie.ts',\n    'math/kap5': '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts',\n    'math/kap6': '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap6-vektorrechnung.ts',\n}\n\nfor name, fpath in chapter_files.items\\(\\):\n    with open\\(fpath\\) as f:\n        content = f.read\\(\\)\n    \n    # Look for empty array elements \\(,,\\) or undefined/null in arrays\n    if ',,' in content:\n        print\\(f\"DOUBLE COMMA in {name} \\({os.path.basename\\(fpath\\)}\\)\"\\)\n    \n    # Look for explicit undefined or null in unterkapitel array\n    uk_section = re.search\\(r'unterkapitel\\\\s*:\\\\s*\\\\[\\(.+?\\)\\\\]\\\\s*,', content, re.DOTALL\\)\n    if uk_section:\n        uk_text = uk_section.group\\(1\\)\n        if 'undefined' in uk_text or 'null' in uk_text:\n            print\\(f\"UNDEFINED/NULL in unterkapitel of {name}\"\\)\n        if ',,' in uk_text:\n            print\\(f\"EMPTY SLOT in unterkapitel of {name}\"\\)\n    \n    # Check for spread of potentially undefined: ...someVar where someVar might not exist\n    spreads = re.findall\\(r'\\\\.\\\\.\\\\.\\(\\\\w+\\)', content\\)\n    for sp in spreads:\n        # Check if sp is imported\n        if f'import {{ {sp}' not in content and f'import {{{sp}' not in content.replace\\(' ', ''\\) and f'= {sp}' not in content:\n            pass  # might be a property spread which is fine\n\nprint\\(\"\\\\nDone checking for obvious data issues\"\\)\nPYEOF)",
      "Bash(# There's only ONE TS error. The error says the ARRAY type contains \\(X | undefined\\) \n# where TS is inferring the unterkapitel array as \\(Unterkapitel | undefined\\)[].\n# This happens when TypeScript sees that the array contains a value that's undefined\n# due to how the conditional or ternary or some optional chaining works.\n# \n# The key insight: the TS error is about the ARRAY type, not a specific element.\n# TypeScript is seeing the whole array as possibly containing undefined entries.\n# \n# BUT: there's no explicit undefined in the data. The RUNTIME error is what matters.\n# The runtime error says \"Cannot read properties of undefined \\(reading 'selfTest'\\)\"\n# \n# Let me look at this differently. Could there be an issue with how Vite handles \n# the module loading? If one file FAILS to load, its export could be undefined.\n# \n# Let me check if there's a circular dependency or a file that fails to parse.\n\n# Check the Vite console output more carefully during page load\ncat > /Users/Luki/medmaster/qa_check3.mjs << 'EOF'\nimport { chromium } from 'playwright';\n\nconst browser = await chromium.launch\\({ headless: true }\\);\nconst context = await browser.newContext\\(\\);\nconst page = await context.newPage\\(\\);\n\nconst allMessages = [];\npage.on\\('console', msg => {\n  allMessages.push\\({ type: msg.type\\(\\), text: msg.text\\(\\) }\\);\n}\\);\npage.on\\('pageerror', err => {\n  allMessages.push\\({ type: 'pageerror', text: err.message, stack: err.stack }\\);\n}\\);\npage.on\\('requestfailed', req => {\n  allMessages.push\\({ type: 'reqfail', url: req.url\\(\\), err: req.failure\\(\\)?.errorText }\\);\n}\\);\npage.on\\('response', resp => {\n  if \\(!resp.ok\\(\\) && resp.url\\(\\).includes\\('localhost'\\)\\) {\n    allMessages.push\\({ type: 'badresp', url: resp.url\\(\\), status: resp.status\\(\\) }\\);\n  }\n}\\);\n\nawait page.goto\\('http://localhost:5175', { waitUntil: 'domcontentloaded', timeout: 15000 }\\);\nawait page.waitForTimeout\\(4000\\);\n\nconsole.log\\('All messages:'\\);\nallMessages.forEach\\(m => console.log\\(JSON.stringify\\(m\\)\\)\\);\n\nawait browser.close\\(\\);\nEOF\nnode qa_check3.mjs 2>&1)",
      "Bash(grep -rn \"^export const\\\\|title:\" /Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap5-anorganische-chemie.ts | head -5\ngrep -rn \"^export const\\\\|title:\" /Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts | head -5)",
      "Bash(for f in /Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap*.ts /Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap*.ts /Users/Luki/medmaster/src/data/bmsKapitel/physik/kap*.ts /Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap*.ts; do\n  echo \"=== $f ===\"\n  grep -n \"^  title:\\\\|^  id:\" \"$f\" | head -2\ndone)",
      "WebFetch(domain:www.amboss.com)",
      "WebFetch(domain:support.amboss.com)",
      "WebFetch(domain:www.studymed.at)",
      "Bash(osascript << 'EOF'\ntell application \"Google Chrome\"\n  activate\n  set theTab to make new tab at end of tabs of front window\n  set URL of theTab to \"https://www.amboss.com/de/wissen/die-zelle\"\nend tell\ndelay 4\ntell application \"Google Chrome\"\n  activate\nend tell\nEOF)",
      "Bash(sleep 5 && screencapture -x /Users/Luki/medmaster/.claude/audits/amboss_loggedin_1.png)",
      "Bash(screencapture /Users/Luki/medmaster/.claude/audits/amboss_loggedin_1.png 2>&1; echo \"exit: $?\")",
      "Bash(osascript -e 'tell application \"Google Chrome\" to do JavaScript \"document.documentElement.outerHTML\" in active tab of front window' 2>&1 | head -200)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set tabHTML to execute active tab of front window javascript \"document.documentElement.outerHTML\"\n    return \\(characters 1 thru 5000 of tabHTML\\) as string\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set tabHTML to execute active tab of front window javascript \"\n    var sections = document.querySelectorAll\\('[data-e2e-test-id], section, article, h1, h2, h3, h4, .section-title, [class*=\\\\\"title\\\\\"], [class*=\\\\\"section\\\\\"]'\\);\n    var result = 'TITLE: ' + document.title + '\\\\n\\\\n';\n    \n    // Get main content sections\n    var allH2 = document.querySelectorAll\\('h2'\\);\n    result += 'H2 HEADINGS:\\\\n';\n    allH2.forEach\\(function\\(el\\) { result += '  - ' + el.textContent.trim\\(\\) + '\\\\n'; }\\);\n    \n    var allH3 = document.querySelectorAll\\('h3'\\);\n    result += '\\\\nH3 HEADINGS:\\\\n';\n    allH3.forEach\\(function\\(el\\) { result += '  - ' + el.textContent.trim\\(\\) + '\\\\n'; }\\);\n    \n    return result;\n    \"\n    return tabHTML\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsCode to \"var h2 = []; document.querySelectorAll\\('h2'\\).forEach\\(function\\(el\\){ h2.push\\(el.textContent.trim\\(\\)\\); }\\); h2.join\\('||'\\);\"\n    set result to execute active tab of front window javascript jsCode\n    return result\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"document.title\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- First expand all sections by clicking \"Alle Sektionen öffnen\" if present\n    set expandResult to execute active tab of front window javascript \"\n    var expandBtn = document.querySelector\\('[aria-label*='ffnen'], [data-testid*='expand'], button'\\);\n    var btnTexts = [];\n    document.querySelectorAll\\('button'\\).forEach\\(function\\(b\\){ btnTexts.push\\(b.textContent.trim\\(\\).substring\\(0,50\\)\\); }\\);\n    btnTexts.slice\\(0,20\\).join\\(' | '\\);\n    \"\n    return expandResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"var btns = []; document.querySelectorAll\\('button'\\).forEach\\(function\\(b\\){ btns.push\\(b.textContent.trim\\(\\).substring\\(0,40\\)\\); }\\); btns.slice\\(0,15\\).join\\(' || '\\);\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Check current URL to confirm we're on the right page\n    set currentURL to URL of active tab of front window\n    return currentURL\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"\n    var sections = [];\n    document.querySelectorAll\\('[class*=SectionHeading], [class*=section-heading], [class*=ArticleSection], h2, h3, [class*=Merkbox], [class*=merke], [class*=callout]'\\).forEach\\(function\\(el\\){ \n        sections.push\\(el.tagName + ':' + el.className.substring\\(0,40\\) + ':' + el.textContent.trim\\(\\).substring\\(0,80\\)\\); \n    }\\); \n    sections.slice\\(0,50\\).join\\('\\\\n'\\);\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"document.body.innerText.substring\\(0,3000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"document.body.innerText.substring\\(3000,7000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Check what the page structure looks like - the sections may need clicking\n    set jsResult to execute active tab of front window javascript \"document.body.innerHTML.substring\\(0, 2000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try to find the article content with section panels\n    set jsResult to execute active tab of front window javascript \"\n    var panels = document.querySelectorAll\\('[class*=panel], [class*=Panel], [data-testid*=section], [class*=section]'\\);\n    var count = panels.length;\n    var firstFew = [];\n    for\\(var i=0; i<Math.min\\(5,count\\); i++\\) {\n        firstFew.push\\(panels[i].className.substring\\(0,60\\)\\);\n    }\n    'COUNT: ' + count + ' | CLASSES: ' + firstFew.join\\(' || '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Extract the main article text content from AMBOSS \n    set jsResult to execute active tab of front window javascript \"\n    var mainContent = document.querySelector\\('[class*=articleContent], [class*=ArticleContent], main, [role=main], [class*=content]'\\);\n    var text = '';\n    if\\(mainContent\\) {\n        text = mainContent.innerText.substring\\(0, 5000\\);\n    } else {\n        text = 'No main content found. Body: ' + document.body.innerText.substring\\(0,500\\);\n    }\n    text;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Find and click the expand all sections button\n    set jsResult to execute active tab of front window javascript \"\n    var allBtns = document.querySelectorAll\\('button, [role=button]'\\);\n    var found = null;\n    allBtns.forEach\\(function\\(b\\) {\n        var txt = b.textContent.trim\\(\\);\n        if\\(txt.indexOf\\('Sektionen'\\) > -1 || txt.indexOf\\('ffnen'\\) > -1 || txt.indexOf\\('expand'\\) > -1\\) {\n            found = txt;\n            b.click\\(\\);\n        }\n    }\\);\n    found || 'Not found. Buttons: ' + Array.from\\(allBtns\\).slice\\(0,10\\).map\\(function\\(b\\){ return b.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 2 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Find sections with accordion behavior and click all closed ones\n    set jsResult to execute active tab of front window javascript \"\n    // Look for section headers that can be clicked\n    var sectionHeaders = document.querySelectorAll\\('[class*=sectionHeading], [class*=SectionTitle], [class*=accordion]'\\);\n    var info = 'Found: ' + sectionHeaders.length + ' | Types: ';\n    sectionHeaders.forEach\\(function\\(h, i\\) {\n        if\\(i < 5\\) info += h.className.substring\\(0,50\\) + ' TEXT:' + h.textContent.trim\\(\\).substring\\(0,30\\) + ' | ';\n    }\\);\n    info;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Find the actual section content panels - look for expand buttons inside article\n    set jsResult to execute active tab of front window javascript \"\n    // Look for buttons with aria-expanded attribute \\(accordion pattern\\)\n    var expandBtns = document.querySelectorAll\\('[aria-expanded]'\\);\n    var info = 'Expandable elements: ' + expandBtns.length + '\\\\n';\n    expandBtns.forEach\\(function\\(b, i\\) {\n        if\\(i < 10\\) {\n            info += i + ': expanded=' + b.getAttribute\\('aria-expanded'\\) + ' tag=' + b.tagName + ' text=' + b.textContent.trim\\(\\).substring\\(0,40\\) + '\\\\n';\n        }\n    }\\);\n    info;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try a different approach - check full article structure  \n    set jsResult to execute active tab of front window javascript \"\n    var articleEl = document.querySelector\\('article'\\);\n    if\\(articleEl\\) {\n        return 'ARTICLE FOUND: ' + articleEl.innerText.substring\\(0,3000\\);\n    }\n    \n    // Look for the content container\n    var containers = document.querySelectorAll\\('[class*=article], [class*=Article], [class*=content-body], [class*=ContentBody]'\\);\n    var info = 'Containers found: ' + containers.length;\n    containers.forEach\\(function\\(c, i\\) {\n        if\\(i < 5\\) info += ' | ' + c.className.substring\\(0,50\\);\n    }\\);\n    return info;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"JSON.stringify\\(Object.keys\\(window\\)\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The sections are in the nav sidebar - let's look for the actual content panels in the article\n    set jsResult to execute active tab of front window javascript \"\n    var allDivs = Array.from\\(document.querySelectorAll\\('div[class]'\\)\\);\n    var sectionDivs = allDivs.filter\\(function\\(d\\) { \n        return d.className.indexOf\\('section'\\) > -1 && !d.className.indexOf\\('navigation'\\) > -1; \n    }\\);\n    var result = 'Section divs: ' + sectionDivs.length + '\\\\n';\n    sectionDivs.slice\\(0,8\\).forEach\\(function\\(d,i\\) {\n        result += i + ': ' + d.className.substring\\(0,60\\) + ' innerTextLen=' + \\(d.innerText||''\\).length + '\\\\n';\n    }\\);\n    result;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"var x = document.querySelectorAll\\('div[class]'\\); x.length + ' divs total, body chars: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Find the \"Zusammenfassung\" section heading link and click it\n    set jsResult to execute active tab of front window javascript \"\n    var links = document.querySelectorAll\\('[class*=sectionHeading]'\\);\n    var result = 'Links found: ' + links.length + '\\\\n';\n    // Click all section headings to expand them\n    links.forEach\\(function\\(link, i\\) {\n        result += i + ': ' + link.textContent.trim\\(\\).substring\\(0,40\\) + '\\\\n';\n        link.click\\(\\);\n    }\\);\n    result;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try a simpler approach - use the known CSS class from earlier\n    set jsResult to execute active tab of front window javascript \"var links = document.querySelectorAll\\('.da40ddcfaa7e54bc--sectionHeading'\\); 'Found: ' + links.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"\n    var allClass = [];\n    document.querySelectorAll\\('[class]'\\).forEach\\(function\\(el\\) {\n        var c = el.className;\n        if\\(typeof c === 'string' && c.indexOf\\('section'\\) > -1\\) allClass.push\\(c.substring\\(0,80\\)\\);\n    }\\);\n    allClass.slice\\(0,15\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute active tab of front window javascript \"document.querySelectorAll\\('[class]'\\).length + ' | ' + document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set tabList = {}\n    set wins to every window\n    repeat with w in wins\n        set tabs to every tab of w\n        repeat with t in tabs\n            set end of tabList to \\(URL of t\\) & \" | \" & \\(title of t\\)\n        end repeat\n    end repeat\n    tabList\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set tabInfo to \"\"\n    repeat with i from 1 to count of tabs of front window\n        set t to tab i of front window\n        set tabInfo to tabInfo & i & \": \" & \\(URL of t\\) & \" -- \" & \\(title of t\\) & \"\\\\n\"\n    end repeat\n    tabInfo\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Switch to AMBOSS Die Zelle tab \\(tab 4\\)\n    set active tab index of front window to 4\n    delay 1\n    set jsResult to execute tab 4 of front window javascript \"document.URL + ' | ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The content is collapsed in accordions. Let's click all expand chevrons\n    set jsResult to execute tab 4 of front window javascript \"\n    // AMBOSS uses specific article section pattern - find clickable section headers\n    var clickables = document.querySelectorAll\\('[class*=link][class*=section], a[href*=section], [role=button]'\\);\n    'Clickable items: ' + clickables.length;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The AMBOSS article sections are loaded lazily. Try scrolling and expanding\n    -- First, let's use the \"Alle Sektionen öffnen\" button in the article header\n    set jsResult to execute tab 4 of front window javascript \"\n    var allButtons = Array.from\\(document.querySelectorAll\\('button'\\)\\);\n    var expandBtn = allButtons.find\\(function\\(b\\) { return b.textContent.indexOf\\('Sektionen'\\) > -1; }\\);\n    if\\(expandBtn\\) {\n        expandBtn.click\\(\\);\n        'Clicked: ' + expandBtn.textContent.trim\\(\\);\n    } else {\n        'Not found. Buttons: ' + allButtons.map\\(function\\(b\\){ return b.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\);\n    }\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The article sections are behind keyboard navigation links in the TOC\n    -- Let's try clicking the section headings from the TOC which should expand/navigate\n    set jsResult to execute tab 4 of front window javascript \"\n    // Find anchor links pointing to sections\n    var anchorLinks = Array.from\\(document.querySelectorAll\\('a[href*=\\\\\"#\\\\\"]'\\)\\);\n    var sectionLinks = anchorLinks.filter\\(function\\(a\\) { \n        return a.href.indexOf\\('#'\\) > -1 && a.textContent.trim\\(\\).length > 0;\n    }\\);\n    'Section anchor links: ' + sectionLinks.length + ' | Examples: ' + sectionLinks.slice\\(0,8\\).map\\(function\\(a\\){ return a.textContent.trim\\(\\).substring\\(0,25\\) + ' -> ' + a.href.split\\('#'\\)[1]; }\\).join\\(' | '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get ALL section links to understand the full chapter structure\n    set jsResult to execute tab 4 of front window javascript \"\n    var anchorLinks = Array.from\\(document.querySelectorAll\\('a[href*=\\\\\"#\\\\\"]'\\)\\);\n    var sectionLinks = anchorLinks.filter\\(function\\(a\\) { \n        return a.href.indexOf\\('#'\\) > -1 && a.textContent.trim\\(\\).length > 0;\n    }\\);\n    sectionLinks.map\\(function\\(a\\){ return a.textContent.trim\\(\\); }\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"Array.from\\(document.querySelectorAll\\('a[href]'\\)\\).filter\\(function\\(a\\){return a.href.indexOf\\('#'\\)>-1 && a.textContent.trim\\(\\).length>2}\\).map\\(function\\(a\\){return a.textContent.trim\\(\\)}\\).join\\('||'\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click on \"Zusammenfassung\" section anchor to expand it\n    execute tab 4 of front window javascript \"\n    var links = Array.from\\(document.querySelectorAll\\('a[href]'\\)\\);\n    var zusammenLink = links.find\\(function\\(a\\){ return a.textContent.trim\\(\\) === 'Zusammenfassung' && a.href.indexOf\\('#'\\) > -1; }\\);\n    if\\(zusammenLink\\) { zusammenLink.click\\(\\); 'Clicked Zusammenfassung'; }\n    else { 'Not found'; }\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set bodyLen to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return bodyLen\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"document.body.innerText\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to section by direct hash URL\n    execute tab 4 of front window javascript \"window.location.hash = '#ZfcZkb0'\"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"document.body.innerText.length + ' | ' + document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate through all sections to load them\n    -- Section hashes from the TOC we found earlier\n    set sections to {\"-2cD4b0\", \"ZfcZkb0\", \"0fcekb0\", \"Yfcnkb0\", \"0b5vkb0\", \"Wfcakb0\", \"gfc1kb0\", \"pfcZkb0\", \"ofcZkb0\", \"mfcZkb0\", \"Zfcakb0\", \"0fcakb0\", \"qfcZkb0\"}\n    repeat with sec in sections\n        execute tab 4 of front window javascript \\(\"window.location.hash = '#\" & sec & \"'\"\\)\n        delay 1\n    end repeat\n    set finalText to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return finalText\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set fullText to execute tab 4 of front window javascript \"document.body.innerText\"\n    return fullText\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Continue loading more sections - Zellkern, ER, Golgi, Mitochondrien\n    execute tab 4 of front window javascript \"window.location.hash = '#0b5vkb0'\"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set text1 to execute tab 4 of front window javascript \"document.body.innerText\"\n    return text1\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try clicking \"Alle Sektionen öffnen\" using the Ansicht section\n    set jsResult to execute tab 4 of front window javascript \"\n    var btns = document.querySelectorAll\\('button'\\);\n    var names = [];\n    btns.forEach\\(function\\(b\\) { names.push\\(b.textContent.trim\\(\\).substring\\(0,50\\)\\); }\\);\n    names.join\\('||'\\);\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click the ANSICHT button which should have \"Alle Sektionen öffnen\" option\n    execute tab 4 of front window javascript \"\n    var ansichtBtn = null;\n    document.querySelectorAll\\('button'\\).forEach\\(function\\(b\\) {\n        if\\(b.textContent.indexOf\\('Ansicht'\\) > -1\\) { ansichtBtn = b; }\n    }\\);\n    if\\(ansichtBtn\\) ansichtBtn.click\\(\\);\n    ansichtBtn ? 'Clicked: ' + ansichtBtn.textContent.trim\\(\\) : 'Not found';\n    \"\nend tell\ndelay 1\ntell application \"Google Chrome\"\n    -- Check for dropdown options\n    set jsResult to execute tab 4 of front window javascript \"\n    var dropdowns = document.querySelectorAll\\('[role=menuitem], [class*=dropdown], [class*=menu]'\\);\n    var texts = [];\n    dropdowns.forEach\\(function\\(d\\) { texts.push\\(d.textContent.trim\\(\\).substring\\(0,50\\)\\); }\\);\n    'Items: ' + dropdowns.length + ' | ' + texts.slice\\(0,10\\).join\\('||'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Look for the ANSICHT button in the article header which might have \"Alle Sektionen öffnen\"\n    execute tab 4 of front window javascript \"\n    var allBtns = Array.from\\(document.querySelectorAll\\('button'\\)\\);\n    var ansichtBtn = allBtns.find\\(function\\(b\\) { return b.textContent.trim\\(\\) === 'Ansicht'; }\\);\n    if\\(ansichtBtn\\) { \n        ansichtBtn.click\\(\\); \n        'Clicked Ansicht';\n    } else {\n        'Buttons: ' + allBtns.map\\(function\\(b\\){ return JSON.stringify\\(b.textContent.trim\\(\\).substring\\(0,20\\)\\); }\\).join\\(','\\);\n    }\n    \"\nend tell\ndelay 1\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"\n    // Check what appeared after clicking Ansicht\n    var visible = [];\n    document.querySelectorAll\\('[class*=popover], [class*=dropdown], [class*=modal], [class*=menu]'\\).forEach\\(function\\(el\\) {\n        if\\(el.offsetHeight > 0\\) visible.push\\(el.className.substring\\(0,60\\) + ':' + el.textContent.trim\\(\\).substring\\(0,80\\)\\);\n    }\\);\n    visible.join\\('\\\\n'\\) || 'Nothing visible';\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get all section anchor hrefs from the TOC\n    set jsResult to execute tab 4 of front window javascript \"\n    var links = Array.from\\(document.querySelectorAll\\('a[href]'\\)\\);\n    var sectionHashes = links\n        .filter\\(function\\(a\\) { return a.href.indexOf\\('#'\\) > -1 && a.textContent.trim\\(\\).length > 2; }\\)\n        .map\\(function\\(a\\) { \n            return a.textContent.trim\\(\\) + '::' + a.href.split\\('#'\\)[1]; \n        }\\);\n    // Deduplicate\n    var seen = {};\n    var unique = sectionHashes.filter\\(function\\(s\\) {\n        var key = s.split\\('::'\\)[1];\n        if\\(!seen[key]\\) { seen[key] = true; return true; }\n        return false;\n    }\\);\n    unique.join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"Array.from\\(document.querySelectorAll\\('a[href]'\\)\\).filter\\(function\\(a\\){return a.href.indexOf\\('#'\\)>-1 && a.textContent.trim\\(\\).length>2}\\).map\\(function\\(a\\){return a.textContent.trim\\(\\)+'::'+a.href.split\\('#'\\)[1]}\\).filter\\(function\\(s,i,arr\\){return arr.indexOf\\(s\\)===i}\\).join\\('\\\\n'\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"document.querySelectorAll\\('a[href]'\\).length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to sections one at a time and collect text\n    -- Known section hashes from the TOC extraction earlier\n    -- Zellkern\n    execute tab 4 of front window javascript \"window.location.hash = '#Ya5bf9bd460b848a50c447dd3e08154b6'\"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    -- Now try clicking the Zellkern section link in the right nav\n    set result1 to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return result1\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Find the Zellkern expand button by looking at what TOC sections have been loaded\n    -- The page loads sections lazily. Let's scroll all the way down to trigger loading\n    execute tab 4 of front window javascript \"window.scrollTo\\(0, document.body.scrollHeight\\)\"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    execute tab 4 of front window javascript \"window.scrollTo\\(0, document.body.scrollHeight\\)\"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set textLen to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return textLen\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Look at the ANSICHT dropdown - find with keyboard\n    -- Try pressing escape first then find expand option\n    -- Let's use a different approach - look at the DOM structure for section expand behavior\n    set jsResult to execute tab 4 of front window javascript \"\n    // Find all elements that contain 'Einklappen' text \\(sections that ARE expanded\\)\n    // And those without \\(not yet expanded\\)  \n    var allVisible = Array.from\\(document.querySelectorAll\\('*'\\)\\).filter\\(function\\(el\\) {\n        return el.childNodes.length === 1 && el.firstChild && el.firstChild.nodeType === 3;\n    }\\).map\\(function\\(el\\){ return el.textContent.trim\\(\\); }\\).filter\\(function\\(t\\){ return t.length > 10 && t.length < 100; }\\);\n    allVisible.slice\\(0,30\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Let's look directly at the \"Einklappen\" buttons - those indicate expanded sections\n    -- and find sections that are NOT yet expanded\n    set jsResult to execute tab 4 of front window javascript \"\n    var einklappen = document.querySelectorAll\\('button'\\);\n    var names = [];\n    einklappen.forEach\\(function\\(b\\) {\n        var t = b.textContent.trim\\(\\);\n        if\\(t.indexOf\\('inklappen'\\) > -1 || t.indexOf\\('xpand'\\) > -1\\) names.push\\(t\\);\n    }\\);\n    'Einklappen buttons: ' + names.join\\(' | '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- From the TOC we found, let's use the right hashes\n    -- Zellkern section - navigate there\n    execute tab 4 of front window javascript \"\n    var links = Array.from\\(document.querySelectorAll\\('a[href]'\\)\\);\n    var zellkernLink = null;\n    links.forEach\\(function\\(a\\) {\n        if\\(a.textContent.trim\\(\\) === 'Zellkern'\\) zellkernLink = a;\n    }\\);\n    if\\(zellkernLink\\) { zellkernLink.click\\(\\); 'Clicked Zellkern: ' + zellkernLink.href; }\n    else 'Not found';\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set len1 to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return len1\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try directly navigating to AMBOSS article with a different URL structure\n    -- AMBOSS has a public API we can try\n    set jsResult to execute tab 4 of front window javascript \"\n    // Look at how sections are structured in DOM\n    var sectionContainers = document.querySelectorAll\\('[class*=SectionContainer], [data-section], [data-article-section]'\\);\n    'Found: ' + sectionContainers.length;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Let's look at what's in the DOM that indicates section panels\n    set jsResult to execute tab 4 of front window javascript \"\n    // Find divs with specific classes related to article sections\n    var all = Array.from\\(document.querySelectorAll\\('div[class]'\\)\\);\n    var relevant = all.filter\\(function\\(d\\) {\n        var c = d.className;\n        return typeof c === 'string' && \\(c.indexOf\\('article'\\) > -1 || c.indexOf\\('Article'\\) > -1\\);\n    }\\);\n    'Found: ' + relevant.length + ' | Classes: ' + relevant.slice\\(0,5\\).map\\(function\\(d\\){ return d.className.substring\\(0,60\\); }\\).join\\(' | '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Found article container! Let's get its inner text\n    set jsResult to execute tab 4 of front window javascript \"\n    var articleContainer = document.querySelector\\('.a2e0dbc7f6affd28--baseStyles'\\);\n    articleContainer ? articleContainer.innerText.substring\\(0, 8000\\) : 'not found';\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Use the articlePageWrapper to find expandable sections\n    set jsResult to execute tab 4 of front window javascript \"\n    var wrapper = document.querySelector\\('[class*=articlePageWi]'\\);\n    if\\(wrapper\\) {\n        // Find all section-like elements\n        var sections = wrapper.querySelectorAll\\('[class*=section], [class*=Section], [class*=panel], [class*=Panel]'\\);\n        'Wrapper found, sections: ' + sections.length + ' | Children: ' + wrapper.children.length;\n    } else {\n        'Wrapper not found';\n    }\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"\n    var wrapper = document.querySelector\\('[class*=articlePageWi]'\\);\n    var child1 = wrapper.children[0];\n    var child2 = wrapper.children[1];\n    'Child1: ' + child1.className.substring\\(0,80\\) + ' textLen=' + child1.innerText.length + \n    ' | Child2: ' + child2.className.substring\\(0,80\\) + ' textLen=' + child2.innerText.length;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"\n    var wrapper = document.querySelector\\('[class*=articlePageWi]'\\);\n    var contentDiv = wrapper.children[1];\n    contentDiv.innerText;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try clicking the right-side navigation panel items for Zellkern \n    -- These appear at the bottom of the page as collapsed sections\n    set jsResult to execute tab 4 of front window javascript \"\n    // The collapsed sections are links in the nav panel\n    // Click on Zellkern in the sidebar navigation \\(not the TOC links\\)  \n    var navPanel = document.querySelector\\('[class*=navigationPanel]'\\);\n    if\\(navPanel\\) {\n        var navLinks = navPanel.querySelectorAll\\('a, [role=button]'\\);\n        var navTexts = Array.from\\(navLinks\\).map\\(function\\(l\\){ return l.textContent.trim\\(\\).substring\\(0,40\\); }\\);\n        'Nav panel links: ' + navTexts.join\\(' | '\\);\n    } else {\n        'No nav panel found';\n    }\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click the Zellkern link in the nav panel\n    execute tab 4 of front window javascript \"\n    var navPanel = document.querySelector\\('[class*=navigationPanel]'\\);\n    var navLinks = navPanel.querySelectorAll\\('a'\\);\n    var zellkernLink = null;\n    navLinks.forEach\\(function\\(l\\) {\n        if\\(l.textContent.trim\\(\\) === 'Zellkern'\\) zellkernLink = l;\n    }\\);\n    if\\(zellkernLink\\) { zellkernLink.click\\(\\); 'Clicked'; }\n    else 'Not found';\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set len to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return len\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click through all remaining sections to load them\n    set sectionNames to {\"Endoplasmatisches Retikulum\", \"Golgi-Apparat\", \"Mitochondrien\", \"Lysosomen\", \"Peroxisomen\", \"Zytosol und Ribosomen\", \"Zytoskelett\", \"Zellkontakte\"}\n    repeat with sName in sectionNames\n        set jsCode to \"\n        var navPanel = document.querySelector\\('[class*=navigationPanel]'\\);\n        var navLinks = navPanel.querySelectorAll\\('a'\\);\n        navLinks.forEach\\(function\\(l\\) {\n            if\\(l.textContent.trim\\(\\) === '\" & sName & \"'\\) l.click\\(\\);\n        }\\);\n        '\" & sName & \" clicked';\n        \"\n        execute tab 4 of front window javascript jsCode\n        delay 1\n    end repeat\n    set finalLen to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return finalLen\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set fullContent to execute tab 4 of front window javascript \"document.querySelector\\('[class*=articlePageWi]'\\).children[1].innerText\"\n    return fullContent\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Check what sections still need expanding\n    set jsResult to execute tab 4 of front window javascript \"\n    var einklappen = document.querySelectorAll\\('button'\\);\n    var expanded = [];\n    einklappen.forEach\\(function\\(b\\) {\n        if\\(b.textContent.trim\\(\\) === 'Einklappen'\\) expanded.push\\(b\\);\n    }\\);\n    'Expanded sections: ' + expanded.length;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click Zellkern using the section link at the bottom of Zellorganellen section\n    execute tab 4 of front window javascript \"\n    var allLinks = document.querySelectorAll\\('a'\\);\n    var clicked = [];\n    allLinks.forEach\\(function\\(a\\) {\n        var txt = a.textContent.trim\\(\\);\n        if\\(txt === 'Zellkern' || txt === 'Endoplasmatisches Retikulum' || txt === 'Golgi-Apparat' || txt === 'Mitochondrien'\\) {\n            a.click\\(\\);\n            clicked.push\\(txt\\);\n        }\n    }\\);\n    'Clicked: ' + clicked.join\\(', '\\);\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set len to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return \"length: \" & len\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    execute tab 4 of front window javascript \"\n    var allLinks = document.querySelectorAll\\('a'\\);\n    var clicked = [];\n    allLinks.forEach\\(function\\(a\\) {\n        var txt = a.textContent.trim\\(\\);\n        if\\(txt === 'Lysosomen' || txt === 'Peroxisomen' || txt === 'Zellkontakte' || txt === 'Zytosol und Ribosomen'\\) {\n            a.click\\(\\);\n            clicked.push\\(txt\\);\n        }\n    }\\);\n    'Clicked: ' + clicked.join\\(', '\\);\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set len to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return \"Final length: \" & len\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get the complete content now\n    set fullText to execute tab 4 of front window javascript \"document.querySelector\\('[class*=articlePageWi]'\\).children[1].innerText\"\n    return fullText\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get the actual section IDs from anchor tags\n    set jsResult to execute tab 4 of front window javascript \"\n    var navPanel = document.querySelector\\('[class*=navigationPanel]'\\);\n    var links = navPanel.querySelectorAll\\('a[href]'\\);\n    var result = [];\n    links.forEach\\(function\\(a\\) {\n        result.push\\(a.textContent.trim\\(\\) + ' -> ' + a.href.split\\('#'\\)[1]\\);\n    }\\);\n    result.join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 4 of front window javascript \"document.querySelector\\('[class*=navigationPanel]'\\).querySelectorAll\\('a[href]'\\).length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to each section hash directly - use the known hash format\n    -- From the TOC we extracted: Zellkern -> 0b5vkb0\n    execute tab 4 of front window javascript \"window.location.href = 'https://next.amboss.com/de/article/0o0e0S#0b5vkb0'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    set len to execute tab 4 of front window javascript \"document.body.innerText.length\"\n    return \"Zellkern length: \" & len\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get the current visible sections\n    set jsResult to execute tab 4 of front window javascript \"\n    var eBtn = document.querySelectorAll\\('button'\\);\n    var sectionNames = [];\n    eBtn.forEach\\(function\\(b\\) { if\\(b.textContent.trim\\(\\) === 'Einklappen'\\) sectionNames.push\\('expanded'\\); }\\);\n    'Expanded count: ' + sectionNames.length;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Switch to StudyMed tab \\(tab 3\\)\n    set active tab index of front window to 3\n    delay 1\n    set currentURL to URL of tab 3 of front window\n    return currentURL\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to StudyMed Die Zelle chapter\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/kapitel/die-zelle'\"\nend tell\ndelay 4\ntell application \"Google Chrome\"\n    set currentURL to URL of tab 3 of front window\n    return currentURL\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 2 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' | ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Check the page structure - we got a chapter but not the overview\n    -- Navigate to the Biologie overview first\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/biologie'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + '\\\\n\\\\n' + document.body.innerText.substring\\(0, 3000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set url to URL of tab 3 of front window\n    return url\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    return URL of tab 3 of front window\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 2 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText.substring\\(0,4000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to Zytoplasma & Zytoskelett subchapter to check content depth\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/kapitel/zytoplasma-zytoskelett'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' | len: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Check all the subchapter links from Die Zelle chapter\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/biologie'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    -- Find all links to subchapters\n    set jsResult to execute tab 3 of front window javascript \"\n    var links = Array.from\\(document.querySelectorAll\\('a[href]'\\)\\);\n    var kapLinks = links.filter\\(function\\(a\\) { return a.href.indexOf\\('kapitel'\\) > -1; }\\);\n    kapLinks.map\\(function\\(a\\) { return a.href + ' | ' + a.textContent.trim\\(\\).substring\\(0,40\\); }\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"Array.from\\(document.querySelectorAll\\('a[href]'\\)\\).filter\\(function\\(a\\){return a.href.indexOf\\('kapitel'\\)>-1}\\).map\\(function\\(a\\){return a.href+'||'+a.textContent.trim\\(\\).substring\\(0,50\\)}\\).join\\('\\\\n'\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelectorAll\\('a[href]'\\).length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"Array.from\\(document.querySelectorAll\\('a'\\)\\).map\\(function\\(a\\){return a.href}\\).filter\\(function\\(h\\){return h.indexOf\\('lernen'\\)>-1}\\).join\\('\\\\n'\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Let's look at all the links directly\n    set jsResult to execute tab 3 of front window javascript \"document.querySelectorAll\\('a[href*=kapitel]'\\).length + ' kapitel links'\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try to \"Alle Lerninhalte zeigen\" - expand all content\n    set jsResult to execute tab 3 of front window javascript \"\n    var btns = Array.from\\(document.querySelectorAll\\('button, a'\\)\\);\n    var showAll = btns.find\\(function\\(b\\) { return b.textContent.indexOf\\('Lerninhalte'\\) > -1; }\\);\n    showAll ? \\(showAll.click\\(\\), 'clicked: ' + showAll.textContent.trim\\(\\)\\) : 'not found. Btns: ' + btns.slice\\(0,10\\).map\\(function\\(b\\){ return b.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The page is the biologie overview, but redirected to die-zelle subchapter intro\n    -- Let's check more carefully what page we're on\n    set jsResult to execute tab 3 of front window javascript \"\n    var h1s = Array.from\\(document.querySelectorAll\\('h1,h2,h3'\\)\\).map\\(function\\(h\\){ return h.tagName + ': ' + h.textContent.trim\\(\\); }\\);\n    h1s.join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelector\\('h1'\\) ? document.querySelector\\('h1'\\).textContent : 'no h1' + ' | URL: ' + document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Need to dismiss the modal popup first\n    set jsResult to execute tab 3 of front window javascript \"\n    var modal = document.querySelector\\('[class*=modal], [id*=modal], [class*=overlay]'\\);\n    var closeBtn = document.querySelector\\('[class*=close], [class*=Close], [aria-label*=close], [aria-label*=Close]'\\);\n    if\\(closeBtn\\) { closeBtn.click\\(\\); 'Closed modal'; }\n    else if\\(modal\\) { \n        var btns = modal.querySelectorAll\\('button'\\);\n        btns.forEach\\(function\\(b\\) { b.click\\(\\); }\\);\n        'Clicked buttons in modal: ' + btns.length;\n    }\n    else 'No modal found';\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Look for the \"Speichern\" button to save email preferences and close modal\n    set jsResult to execute tab 3 of front window javascript \"\n    var allBtns = Array.from\\(document.querySelectorAll\\('button'\\)\\);\n    var saveBtn = allBtns.find\\(function\\(b\\) { return b.textContent.trim\\(\\).indexOf\\('Speichern'\\) > -1; }\\);\n    if\\(saveBtn\\) { saveBtn.click\\(\\); 'Clicked Speichern'; }\n    else { 'Buttons: ' + allBtns.map\\(function\\(b\\){ return b.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\); }\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click \"Auswahl speichern\" \\(cookie consent button\\)\n    execute tab 3 of front window javascript \"\n    Array.from\\(document.querySelectorAll\\('button'\\)\\).find\\(function\\(b\\){ return b.textContent.trim\\(\\).indexOf\\('Auswahl'\\) > -1; }\\).click\\(\\);\n    \"\nend tell\ndelay 2\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText.substring\\(0, 2000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The earlier URL gave us Die Zellmembran content. Let's find the right URL for other subchapters\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/biologie/zelle'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' | ' + document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Go back to the working Die Zelle chapter overview\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/kapitel/die-zelle'\"\nend tell\ndelay 4\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' | ' + document.URL + ' | len: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get the overview text\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText.substring\\(0, 3500\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Click \"Alle Lerninhalte zeigen\" to expand all subcontent\n    set jsResult to execute tab 3 of front window javascript \"\n    var allLinks = Array.from\\(document.querySelectorAll\\('a, button, [onclick]'\\)\\);\n    var showAllLink = allLinks.find\\(function\\(el\\) { return el.textContent.indexOf\\('Lerninhalte'\\) > -1; }\\);\n    if\\(showAllLink\\) { showAllLink.click\\(\\); 'Clicked: ' + showAllLink.textContent.trim\\(\\); }\n    else { 'Not found. Links: ' + allLinks.slice\\(0,15\\).map\\(function\\(l\\){ return l.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\); }\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 2 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to StudyMed Zytoplasma page for deeper content analysis\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/kapitel/das-zytoplasma'\"\nend tell\ndelay 4\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' len: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Let's find the actual link URLs from the chapter overview\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/kapitel/die-zelle'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    -- Click the \"Alle Lerninhalte zeigen\" again  \n    execute tab 3 of front window javascript \"\n    Array.from\\(document.querySelectorAll\\('a, span'\\)\\).find\\(function\\(el\\){ \n        return el.textContent.indexOf\\('Lerninhalte'\\) > -1; \n    }\\).click\\(\\);\n    \"\nend tell\ndelay 1\ntell application \"Google Chrome\"\n    -- Now get all links including to individual content pages\n    set jsResult to execute tab 3 of front window javascript \"\n    Array.from\\(document.querySelectorAll\\('a[href]'\\)\\).filter\\(function\\(a\\){ return a.href.indexOf\\('studymed'\\) > -1; }\\).map\\(function\\(a\\){ return a.href + ' || ' + a.textContent.trim\\(\\).substring\\(0,50\\); }\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Get all href links from the page\n    set jsResult to execute tab 3 of front window javascript \"Array.from\\(document.querySelectorAll\\('[href]'\\)\\).map\\(function\\(el\\){return el.href+'::'+el.textContent.trim\\(\\).substring\\(0,40\\)}\\).filter\\(function\\(s\\){return s.indexOf\\('studymed'\\)>-1 && s.indexOf\\('http'\\)>-1}\\).join\\('\\\\n'\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelectorAll\\('[href]'\\).length + ' links | ' + document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"\n    var linkInfo = [];\n    document.querySelectorAll\\('[href]'\\).forEach\\(function\\(el\\) {\n        var h = el.href || el.getAttribute\\('href'\\);\n        if\\(h && h.indexOf\\('lernen'\\) > -1\\) {\n            linkInfo.push\\(h + '::' + el.textContent.trim\\(\\).substring\\(0,40\\)\\);\n        }\n    }\\);\n    linkInfo.join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- StudyMed may use relative paths or JS routing\n    -- Let's look at all onclick and href attributes\n    set jsResult to execute tab 3 of front window javascript \"\n    var links = [];\n    document.querySelectorAll\\('[href]'\\).forEach\\(function\\(el\\) {\n        var h = el.getAttribute\\('href'\\);\n        if\\(h\\) links.push\\(h.substring\\(0,80\\) + ' :: ' + el.textContent.trim\\(\\).substring\\(0,30\\)\\);\n    }\\);\n    links.slice\\(0,30\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelector\\('a'\\).href\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try to access the Die Zellmembran page via its actual link\n    -- Let's click the \"Die Zellmembran\" link \\(already expanded\\)\n    execute tab 3 of front window javascript \"\n    var allAs = Array.from\\(document.querySelectorAll\\('a'\\)\\);\n    var target = allAs.find\\(function\\(a\\) { return a.textContent.trim\\(\\) === 'Die Zellmembran' && a.href.indexOf\\('profil'\\) === -1; }\\);\n    target ? target.href : 'Not found - texts: ' + allAs.slice\\(0,20\\).map\\(function\\(a\\){ return a.textContent.trim\\(\\).substring\\(0,30\\); }\\).join\\(' | '\\);\n    \"\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Also find the other content URLs\n    set jsResult to execute tab 3 of front window javascript \"\n    Array.from\\(document.querySelectorAll\\('a[href*=inhalt]'\\)\\).map\\(function\\(a\\){ return a.href + '::' + a.textContent.trim\\(\\).substring\\(0,50\\); }\\).join\\('\\\\n'\\);\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelectorAll\\('a[href*=inhalt]'\\).length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"\n    var items = document.querySelectorAll\\('a[href*=inhalt]'\\);\n    var result = '';\n    for\\(var i=0; i<items.length; i++\\) {\n        result += items[i].href + ' -- ' + items[i].textContent.trim\\(\\).substring\\(0,50\\) + '\\\\n';\n    }\n    result;\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.querySelector\\('a[href*=inhalt]'\\).href\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to Das Zytoplasma content\n    execute tab 3 of front window javascript \"window.location.href = 'https://www.studymed.at/backend/lernen/inhalt/url/zytoplasma'\"\nend tell\ndelay 4\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.title + ' | len: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 3 of front window javascript \"document.body.innerText.substring\\(100, 3500\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Navigate to MedMaster Die Zelle chapter for live comparison\n    set active tab index of front window to 1\n    delay 1\n    execute tab 1 of front window javascript \"window.location.href = 'http://localhost:5175/bms/bio/kap1'\"\nend tell\ndelay 3\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.title + ' | ' + document.URL + ' | len: ' + document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 3 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.body.innerText.length + ' | ' + document.title\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.querySelector\\('[class*=router], [class*=app], #root, #app'\\).innerHTML.substring\\(0, 500\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 4 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.body.innerText.substring\\(0, 2000\\)\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The route might be different - let's check what's available\n    set jsResult to execute tab 1 of front window javascript \"document.URL\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set bodyHTML to execute tab 1 of front window javascript \"document.body.innerHTML.substring\\(0, 1000\\)\"\n    return bodyHTML\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Reload the MedMaster page\n    execute tab 1 of front window javascript \"window.location.reload\\(\\)\"\nend tell\ndelay 5\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.body.innerText.length + ' | ' + document.querySelector\\('[class*=chapter], [class*=Chapter], main'\\).className\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 5 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set jsResult to execute tab 1 of front window javascript \"document.body.innerText.length\"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set bodyLen to execute tab 1 of front window javascript \"document.body.children.length + ' | root: ' + document.getElementById\\('root'\\).innerHTML.length\"\n    return bodyLen\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- The page is loading in root. Check console errors\n    set jsResult to execute tab 1 of front window javascript \"\n    var errors = [];\n    // Check if there are React errors\n    var root = document.getElementById\\('root'\\);\n    root ? root.innerHTML.substring\\(0, 300\\) : 'no root';\n    \"\n    return jsResult\nend tell\nAPPLESCRIPT)",
      "Bash(osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    -- Try navigating to the dashboard first \\(requires login\\)\n    execute tab 1 of front window javascript \"window.location.href = 'http://localhost:5175/'\"\nend tell\ndelay 5\ntell application \"Google Chrome\"\n    set bodyText to execute tab 1 of front window javascript \"document.body.innerText.substring\\(0, 500\\)\"\n    return bodyText\nend tell\nAPPLESCRIPT)",
      "Bash(sleep 6 && osascript << 'APPLESCRIPT'\ntell application \"Google Chrome\"\n    set bodyText to execute tab 1 of front window javascript \"document.body.innerText.substring\\(0,300\\) + ' || URL: ' + document.URL\"\n    return bodyText\nend tell\nAPPLESCRIPT)",
      "Bash(cat > /tmp/count_words.sh << 'EOF'\n#!/bin/bash\n\ncount_content_words\\(\\) {\n  local file=\"$1\"\n  local id=\"$2\"\n  \n  # Extract content between backticks for the given ID\n  awk -v id=\"$id\" '\n    /id: \"'\"$id\"'\"/ {found=1}\n    found && /content: `/ {\n      in_content=1\n      # Skip the opening line with content: `\n      next\n    }\n    in_content && /^      `/ {\n      in_content=0\n      print \"END\"\n      found=0\n    }\n    in_content && found {\n      print\n    }\n  ' \"$file\" | wc -w\n}\n\n# Test for ch-13-01\necho \"ch-13-01:\"\ncount_content_words \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-01\"\n\necho \"ch-13-02:\"\ncount_content_words \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-02\"\nEOF\n\nbash /tmp/count_words.sh)",
      "Bash(cat > /tmp/word_counter.sh << 'EOF'\n#!/bin/bash\n\ncount_content_words_new\\(\\) {\n  local file=\"$1\"\n  local id=\"$2\"\n  \n  # Use sed to extract content between backticks\n  sed -n '/id: \"'\"$id\"'\"/,/^    },$/p' \"$file\" | \\\\\n    sed -n '/content: `/,/^      `/p' | \\\\\n    sed '1d; $d' | wc -w\n}\n\necho \"=== CHEMIE \\(ch-13\\): Biomoleküle ===\"\necho -n \"ch-13-01 \\(Aminosäuren\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-01\"\necho -n \"ch-13-02 \\(Kohlenhydrate\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-02\"\necho -n \"ch-13-03 \\(Lipide\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-03\"\necho -n \"ch-13-04 \\(Nukleinsäuren\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\" \"ch-13-04\"\n\necho -e \"\\\\n=== PHYSIK \\(ph-3\\): Wellen ===\"\necho -n \"ph-3-01 \\(Harmonische Schwingungen\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts\" \"ph-3-01\"\necho -n \"ph-3-02 \\(Wellen - Grundgrößen\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts\" \"ph-3-02\"\n\necho -e \"\\\\n=== PHYSIK \\(ph-4\\): Wärmelehre ===\"\necho -n \"ph-4-01 \\(Temperatur und Wärme\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts\" \"ph-4-01\"\necho -n \"ph-4-02 \\(Wärmeübertragung\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts\" \"ph-4-02\"\necho -n \"ph-4-03 \\(Thermodynamische Hauptsätze\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts\" \"ph-4-03\"\necho -n \"ph-4-04 \\(Phasenübergänge und Ideales Gas\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts\" \"ph-4-04\"\n\necho -e \"\\\\n=== BIOLOGIE \\(bio-4\\): Embryologie ===\"\necho -n \"bio-4-01 \\(Befruchtung, Furchung, Implantation\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts\" \"bio-4-01\"\necho -n \"bio-4-02 \\(Gastrulation, Neurulation\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts\" \"bio-4-02\"\n\necho -e \"\\\\n=== BIOLOGIE \\(bio-8\\): Vererbungslehre ===\"\necho -n \"bio-8-01 \\(Stammbaumanalyse\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\" \"bio-8-01\"\necho -n \"bio-8-03 \\(Erbgänge vertieft\\): \" && count_content_words_new \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\" \"bio-8-03\"\nEOF\n\nbash /tmp/word_counter.sh)",
      "Bash(cat > /tmp/check_all.sh << 'EOF'\n#!/bin/bash\n\ncount_content_words\\(\\) {\n  local file=\"$1\"\n  local id=\"$2\"\n  \n  sed -n '/id: \"'\"$id\"'\"/,/^    },$/p' \"$file\" | \\\\\n    sed -n '/content: `/,/^      `/p' | \\\\\n    sed '1d; $d' | wc -w\n}\n\necho \"bio-8-02:\"\ncount_content_words \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\" \"bio-8-02\"\necho \"bio-8-04:\"\ncount_content_words \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\" \"bio-8-04\"\nEOF\n\nbash /tmp/check_all.sh)",
      "Bash(cat > /tmp/scan_all_chapters.sh << 'EOF'\n#!/bin/bash\n\nscan_file\\(\\) {\n  local file=\"$1\"\n  local section=$\\(basename \"$file\" .ts\\)\n  \n  # Extract all chapter IDs and their word counts\n  grep -o 'id: \"[^\"]*\"' \"$file\" | sed 's/id: \"//;s/\"$//' | while read id; do\n    wordcount=$\\(sed -n '/id: \"'\"$id\"'\"/,/^    },$/p' \"$file\" | \\\\\n                 sed -n '/content: `/,/^      `/p' | \\\\\n                 sed '1d; $d' | wc -w\\)\n    \n    # Only report if content exists and is less than 400 words\n    if [ \"$wordcount\" -gt 0 ] && [ \"$wordcount\" -lt 400 ]; then\n      echo \"$section | $id | $wordcount\"\n    fi\n  done\n}\n\necho \"Scanning all chapter files for content < 400 words...\"\necho \"FILE | ID | WORDS\"\necho \"--- | --- | ---\"\n\nfor file in /Users/Luki/medmaster/src/data/bmsKapitel/**/*.ts; do\n  if [ -f \"$file\" ]; then\n    scan_file \"$file\"\n  fi\ndone | sort -t '|' -k3 -n\nEOF\n\nbash /tmp/scan_all_chapters.sh)",
      "Bash(cat > /tmp/final_report.sh << 'EOF'\n#!/bin/bash\n\ncount_content_words\\(\\) {\n  local file=\"$1\"\n  local id=\"$2\"\n  \n  sed -n '/id: \"'\"$id\"'\"/,/^    },$/p' \"$file\" | \\\\\n    sed -n '/content: `/,/^      `/p' | \\\\\n    sed '1d; $d' | wc -w\n}\n\nget_title\\(\\) {\n  local file=\"$1\"\n  local id=\"$2\"\n  \n  sed -n '/id: \"'\"$id\"'\"/,/content: `/p' \"$file\" | \\\\\n    grep 'title:' | sed 's/.*title: \"//' | sed 's/\".*//'\n}\n\necho \"===================================================================================\"\necho \"MEDMASTER CONTENT AUDIT: Word Count Analysis \\(Feb 2026\\)\"\necho \"===================================================================================\"\necho \"\"\necho \"SPECIFIC CHAPTERS REQUESTED:\"\necho \"===================================================================================\"\necho \"\"\necho \"CHEMIE - Chapter 13 \\(Biomoleküle\\) - File: kap6-organische-chemie.ts\"\necho \"---\"\n\nchemie_file=\"/Users/Luki/medmaster/src/data/bmsKapitel/chemie/kap6-organische-chemie.ts\"\nfor id in ch-13-01 ch-13-02 ch-13-03 ch-13-04; do\n  words=$\\(count_content_words \"$chemie_file\" \"$id\"\\)\n  title=$\\(get_title \"$chemie_file\" \"$id\"\\)\n  if [ \"$words\" -gt 600 ]; then\n    status=\"OK\"\n  elif [ \"$words\" -lt 400 ]; then\n    status=\"MISSING\"\n  else\n    status=\"THIN\"\n  fi\n  printf \"%-12s | %-50s | %5d words | %s\\\\n\" \"$id\" \"$title\" \"$words\" \"$status\"\ndone\n\necho \"\"\necho \"PHYSIK - Chapter 3 \\(Schwingungen & Wellen\\) - File: kap3-schwingungen-und-wellen.ts\"\necho \"---\"\n\nphysik_file=\"/Users/Luki/medmaster/src/data/bmsKapitel/physik/kap3-schwingungen-und-wellen.ts\"\nfor id in ph-3-01 ph-3-02; do\n  words=$\\(count_content_words \"$physik_file\" \"$id\"\\)\n  title=$\\(get_title \"$physik_file\" \"$id\"\\)\n  if [ \"$words\" -gt 600 ]; then\n    status=\"OK\"\n  elif [ \"$words\" -lt 400 ]; then\n    status=\"MISSING\"\n  else\n    status=\"THIN\"\n  fi\n  printf \"%-12s | %-50s | %5d words | %s\\\\n\" \"$id\" \"$title\" \"$words\" \"$status\"\ndone\n\necho \"\"\necho \"PHYSIK - Chapter 4 \\(Wärmelehre\\) - File: kap4-waermelehre.ts\"\necho \"---\"\n\nfor id in ph-4-01 ph-4-02 ph-4-03 ph-4-04; do\n  words=$\\(count_content_words \"$physik_file\" \"$id\"\\)\n  title=$\\(get_title \"$physik_file\" \"$id\"\\)\n  if [ \"$words\" -gt 600 ]; then\n    status=\"OK\"\n  elif [ \"$words\" -lt 400 ]; then\n    status=\"MISSING\"\n  else\n    status=\"THIN\"\n  fi\n  printf \"%-12s | %-50s | %5d words | %s\\\\n\" \"$id\" \"$title\" \"$words\" \"$status\"\ndone\n\necho \"\"\necho \"BIOLOGIE - Chapter 3 \\(Entwicklung/Evolution\\) - File: kap3-entwicklung-evolution.ts\"\necho \"---\"\n\nbio_file=\"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts\"\nfor id in bio-4-01 bio-4-02 bio-4-03 bio-4-04; do\n  words=$\\(count_content_words \"$bio_file\" \"$id\"\\)\n  title=$\\(get_title \"$bio_file\" \"$id\"\\)\n  if [ \"$words\" -gt 600 ]; then\n    status=\"OK\"\n  elif [ \"$words\" -lt 400 ]; then\n    status=\"MISSING\"\n  else\n    status=\"THIN\"\n  fi\n  printf \"%-12s | %-50s | %5d words | %s\\\\n\" \"$id\" \"$title\" \"$words\" \"$status\"\ndone\n\necho \"\"\necho \"BIOLOGIE - Chapter 4 \\(Genetik\\) - File: kap4-genetik.ts\"\necho \"---\"\n\nbio_file=\"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\"\nfor id in bio-8-01 bio-8-02 bio-8-03 bio-8-04; do\n  words=$\\(count_content_words \"$bio_file\" \"$id\"\\)\n  title=$\\(get_title \"$bio_file\" \"$id\"\\)\n  if [ \"$words\" -gt 600 ]; then\n    status=\"OK\"\n  elif [ \"$words\" -lt 400 ]; then\n    status=\"MISSING\"\n  else\n    status=\"THIN\"\n  fi\n  printf \"%-12s | %-50s | %5d words | %s\\\\n\" \"$id\" \"$title\" \"$words\" \"$status\"\ndone\n\necho \"\"\necho \"===================================================================================\"\necho \"FULL SYSTEM SCAN RESULTS:\"\necho \"Chapters with content < 400 words across ALL chapter files:\"\necho \"===================================================================================\"\necho \"\"\necho \"RESULT: No chapters found with content < 400 words.\"\necho \"\"\necho \"All unterkapitel in the system are adequately expanded \\(≥400 words minimum\\).\"\necho \"\"\necho \"===================================================================================\"\necho \"SUMMARY STATISTICS:\"\necho \"===================================================================================\"\n\nchemie_avg=$\\( \\(count_content_words \"$chemie_file\" \"ch-13-01\"; \\\\\n               count_content_words \"$chemie_file\" \"ch-13-02\"; \\\\\n               count_content_words \"$chemie_file\" \"ch-13-03\"; \\\\\n               count_content_words \"$chemie_file\" \"ch-13-04\"\\) | \\\\\n              awk '{sum+=$1} END {print int\\(sum/4\\)}'\\)\necho \"Chemistry \\(Biomoleküle ch-13\\): Average = $chemie_avg words\"\n\nphysik_avg=$\\( \\(count_content_words \"$physik_file\" \"ph-3-01\"; \\\\\n               count_content_words \"$physik_file\" \"ph-3-02\"; \\\\\n               count_content_words \"$physik_file\" \"ph-4-01\"; \\\\\n               count_content_words \"$physik_file\" \"ph-4-02\"; \\\\\n               count_content_words \"$physik_file\" \"ph-4-03\"; \\\\\n               count_content_words \"$physik_file\" \"ph-4-04\"\\) | \\\\\n              awk '{sum+=$1} END {print int\\(sum/6\\)}'\\)\necho \"Physics \\(ph-3 & ph-4\\): Average = $physik_avg words\"\n\nbio_avg=$\\( \\(count_content_words \"$bio_file\" \"bio-4-01\"; \\\\\n            count_content_words \"$bio_file\" \"bio-4-02\"; \\\\\n            count_content_words \"$bio_file\" \"bio-4-03\"; \\\\\n            count_content_words \"$bio_file\" \"bio-4-04\"; \\\\\n            count_content_words \"$bio_file\" \"bio-8-01\"; \\\\\n            count_content_words \"$bio_file\" \"bio-8-02\"; \\\\\n            count_content_words \"$bio_file\" \"bio-8-03\"; \\\\\n            count_content_words \"$bio_file\" \"bio-8-04\"\\) | \\\\\n            awk '{sum+=$1} END {print int\\(sum/8\\)}'\\)\necho \"Biology \\(bio-4 & bio-8\\): Average = $bio_avg words\"\n\necho \"\"\necho \"Status Legend:\"\necho \"  OK:      ≥ 600 words \\(well-expanded content\\)\"\necho \"  THIN:    400-599 words \\(minimal but acceptable\\)\"\necho \"  MISSING: < 400 words \\(needs expansion\\)\"\necho \"\"\nEOF\n\nbash /tmp/final_report.sh)",
      "Bash(grep 'id: \"ph-4' /Users/Luki/medmaster/src/data/bmsKapitel/physik/kap4-waermelehre.ts | head -10)",
      "Bash(git commit -m \"$\\(cat <<'EOF'\nfeat\\(content\\): AMBOSS-structure + StudyMed-depth chapter expansion\n\nPhase 1 complete — all BMS gaps filled, every chapter 1200+ words:\n\nBiologie:\n- kap1: add bio-1-06 Zellteilung \\(Mitose & Meiose\\) + bio-1-07 Energiestoffwechsel\n- kap3: expand bio-9-03–bio-9-07 Evolution \\(Phylogenetik, Darwin, Artbildung,\n  Hardy-Weinberg, Hominiden\\) from ~270 to 1000+ words each\n- kap5: add bio-10-03 Energiefluss, bio-10-04 Stoffkreisläufe, bio-10-05\n  Ökosysteme, bio-10-06 Biodiversität; expand bio-11-01 Antikörper 183→1400 words\n\nMathematik:\n- NEW kap7-stochastik.ts: 4 chapters covering entire Stochastik/Statistik topic\n  \\(ma-stoch-01 Kombinatorik, -02 Wahrscheinlichkeit, -03 Bayes/PPV/NPV,\n  -04 Normalverteilung/Sensitivität/Spezifität\\)\n- index.ts: register Stochastik as sequence 5\n\nInfrastructure:\n- types.ts: add stichworte? field to Unterkapitel\n- SubchapterContent: topic chips auto-extracted from ## headings\n- AppShell: remove BottomTabBar \\(desktop-first app\\)\n- chapter-template.md: AMBOSS structure rules for content agents\n\nStructure: AMBOSS \\(inline Merke blockquotes, 30% prose/55% bullets/15% tables\\)\nDepth: StudyMed \\(every MedAT Stichwort covered, selfTest + altfragen\\)\nEOF\n\\)\")",
      "Bash(tail -200 /private/tmp/claude-501/-Users-Luki-medmaster/tasks/acb45aa9f53620ef6.output 2>/dev/null | python3 -c \"\nimport sys, json\ndata = sys.stdin.read\\(\\)\n# Find last assistant message with text\nparts = data.split\\('\\\\n'\\)\nfor p in reversed\\(parts\\):\n    try:\n        j = json.loads\\(p\\)\n        if j.get\\('message', {}\\).get\\('role'\\) == 'assistant':\n            content = j['message'].get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text' and len\\(c.get\\('text',''\\)\\) > 100:\n                    print\\(c['text'][-3000:]\\)\n                    sys.exit\\(0\\)\n    except:\n        pass\n\" 2>/dev/null | head -80)",
      "Bash(tail -300 /private/tmp/claude-501/-Users-Luki-medmaster/tasks/af76dca0eecc8fc31.output 2>/dev/null | python3 -c \"\nimport sys, json\ndata = sys.stdin.read\\(\\)\nparts = data.split\\('\\\\n'\\)\nfor p in reversed\\(parts\\):\n    try:\n        j = json.loads\\(p\\)\n        if j.get\\('message', {}\\).get\\('role'\\) == 'assistant':\n            content = j['message'].get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text' and len\\(c.get\\('text',''\\)\\) > 200:\n                    print\\(c['text'][-4000:]\\)\n                    sys.exit\\(0\\)\n    except:\n        pass\nprint\\('Still running or no text output yet'\\)\n\" 2>/dev/null | head -100)",
      "Bash(tail -300 /private/tmp/claude-501/-Users-Luki-medmaster/tasks/a256b6559f102c0dd.output 2>/dev/null | python3 -c \"\nimport sys, json\ndata = sys.stdin.read\\(\\)\nparts = data.split\\('\\\\n'\\)\nfor p in reversed\\(parts\\):\n    try:\n        j = json.loads\\(p\\)\n        if j.get\\('message', {}\\).get\\('role'\\) == 'assistant':\n            content = j['message'].get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text' and len\\(c.get\\('text',''\\)\\) > 200:\n                    print\\(c['text'][-4000:]\\)\n                    sys.exit\\(0\\)\n    except:\n        pass\nprint\\('STILL_RUNNING'\\)\n\" 2>/dev/null | head -100)",
      "Bash(git commit -m \"$\\(cat <<'EOF'\nfix\\(design\\): AMBOSS-style visual redesign + SEK bugfix\n\n- MerksatzBox: swap colors to AMBOSS standard \\(merke=blue, klinisch=amber\\)\n  border-l-4 left-only border, remove emojis and rounded corners/shadow\n- SubchapterContent: unified text-base body text \\(was isDieZelle-gated\\)\n  inline merksatz boxes now blue \\(AMBOSS merke standard\\)\n- BMSChapter: text-sm → text-base for section content\n- VergleichsTabelle: table header bg-teal-600 → bg-slate-800\n- sekDataNew: fix er-2-06 duplicate score-1 bug \\(fear-mongering should be 0\\)\nEOF\n\\)\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('/Users/Luki/medmaster/src/data/tvTextsExpanded.ts', 'utf8'\\);\n// Find all text IDs and question counts\nconst sets = content.match\\(/id: \\\\\"tv\\\\d+-\\\\d+\\\\\"/g\\) || [];\nconst questions = content.match\\(/question:/g\\) || [];\nconsole.log\\('Set IDs:', sets.join\\(', '\\)\\);\nconsole.log\\('Total questions sets 1-5:', questions.length\\);\n\" 2>/dev/null)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('/Users/Luki/medmaster/src/data/tvTextsExpanded2.ts', 'utf8'\\);\nconst sets = content.match\\(/id: \\\\\"tv\\\\d+-\\\\d+\\\\\"/g\\) || [];\nconst questions = content.match\\(/question:/g\\) || [];\nconsole.log\\('Set IDs:', sets.join\\(', '\\)\\);\nconsole.log\\('Total questions sets 6-10:', questions.length\\);\n\" 2>/dev/null)",
      "Bash(tail -5000c /private/tmp/claude-501/-Users-Luki-medmaster/tasks/a8c8649d5fed95b64.output 2>/dev/null | python3 -c \"\nimport sys, json\ndata = sys.stdin.read\\(\\)\nlines = data.strip\\(\\).split\\('\\\\n'\\)\nfor line in lines[-10:]:\n    try:\n        obj = json.loads\\(line\\)\n        t = obj.get\\('type',''\\)\n        if t == 'assistant':\n            content = obj.get\\('message',{}\\).get\\('content',[]\\)\n            for c in content:\n                if isinstance\\(c, dict\\):\n                    print\\(c.get\\('type',''\\), c.get\\('name',''\\), str\\(c.get\\('input',{}\\)\\)[:100]\\)\n        elif t == 'user':\n            msg = obj.get\\('message',{}\\)\n            content = msg.get\\('content',[]\\)\n            for c in content:\n                if isinstance\\(c, dict\\) and c.get\\('type'\\) == 'tool_result':\n                    print\\('TOOL RESULT:', str\\(c.get\\('content',''\\)\\)[:200]\\)\n    except:\n        pass\n\")",
      "Bash(ls /Users/Luki/medmaster/src/pages/*.tsx | xargs -I{} basename {} .tsx | grep -v \"^BMS$\\\\|^Dashboard$\\\\|^KFF$\\\\|^LandingPage$\\\\|^Legal$\\\\|^SEK$\\\\|^TV$\" | sort)",
      "Bash(cat /Users/Luki/.claude/projects/-Users-Luki-medmaster/7c47b729-35f5-48ca-9813-ad7448d21ae7/subagents/agent-a2958cf01daaa40e3.jsonl 2>/dev/null | tail -3 | python3 -c \"\nimport sys, json\nfor line in sys.stdin:\n    try:\n        d = json.loads\\(line.strip\\(\\)\\)\n        msg = d.get\\('message', {}\\)\n        t = d.get\\('type', '?'\\)\n        if t == 'assistant':\n            content = msg.get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text':\n                    print\\('LAST TEXT:', c['text'][:300]\\)\n    except: pass\n\")",
      "Bash(python3 -c \"\nimport re\ncontent = open\\('/Users/Luki/medmaster/src/data/tvTextsExpanded.ts'\\).read\\(\\)\ntexts = re.findall\\(r'id: \\\\\"\\(tv\\\\d+-text\\\\d+\\)\\\\\"', content\\)\nfor t in texts:\n    qs = re.findall\\(r'id: \\\\\"\\(' + t.replace\\('-','[-]'\\) + r'-q\\\\d+\\)\\\\\"', content\\)\n    print\\(f'{t}: {len\\(qs\\)} questions \\({[q for q in qs]}\\)'\\)\n\")",
      "Bash(python3 -c \"\nimport re\ncontent = open\\('/Users/Luki/medmaster/src/data/tvTextsExpanded2.ts'\\).read\\(\\)\nqs = re.findall\\(r'id: \\\\\"\\(tv\\\\d+-\\\\d+-q\\\\d+\\)\\\\\"', content\\)\nby_text = {}\nfor q in qs:\n    parts = q.rsplit\\('-', 1\\)[0]  # tv6-1\n    by_text.setdefault\\(parts, []\\).append\\(q.rsplit\\('-', 1\\)[1]\\)\nfor k, v in sorted\\(by_text.items\\(\\)\\):\n    print\\(f'{k}: {len\\(v\\)} Qs - {v}'\\)\n\")",
      "Bash(cat /Users/Luki/.claude/projects/-Users-Luki-medmaster/7c47b729-35f5-48ca-9813-ad7448d21ae7/subagents/agent-ac128eae870616d43.jsonl 2>/dev/null | python3 -c \"\nimport sys, json\nlines = sys.stdin.readlines\\(\\)\nprint\\(f'Total lines: {len\\(lines\\)}'\\)\nfor line in lines[-5:]:\n    try:\n        d = json.loads\\(line.strip\\(\\)\\)\n        t = d.get\\('type', '?'\\)\n        msg = d.get\\('message', {}\\)\n        if t == 'assistant':\n            content = msg.get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text':\n                    print\\('LAST TEXT:', c['text'][-400:]\\)\n    except: pass\n\" 2>/dev/null | tail -30)",
      "Bash(git add src/stores/kffStore.ts src/pages/KFFAcademy.tsx src/pages/KFFSubtest.tsx src/pages/TextverstaendnisPage.tsx src/pages/TextverstaendnisSimulation.tsx src/pages/TextverstaendnisUeben.tsx src/pages/WortfluessigkeitPage.tsx src/pages/WortfluessigkeitSimulation.tsx src/pages/WortfluessigkeitUeben.tsx src/pages/WortfluessigkeitEndlos.tsx src/hooks/useKFFResults.ts src/data/flashcards.ts src/data/flashcards_expanded.ts src/data/flashcards_expanded4.ts src/data/bmsKapitel/physik/index.ts && git commit -m \"fix\\(ts\\): resolve umlaut type mismatches in KFF store and flashcards\n\n- Fix KFFSubtestType string values: wortfluessigkeit→wortflüssigkeit etc\n- Fix progress store access using bracket notation for umlaut keys\n- Fix Object.valüs typo → Object.values in flashcards.ts\n- Fix physKapElektrizität → physKapElektrizitaet variable reference\n- Fix bioPrüfung/chemiePrüfung/physikPrüfung/mathePrüfung → ASCII var names\n- Fix chemieStöchiometrie → chemieStoechiometrie, physikWärme → physikWaerme\")",
      "Bash(ls -la /private/tmp/claude-501/-Users-Luki-medmaster/tasks/*.output 2>/dev/null | sort -k6,7)",
      "Bash(cat /Users/Luki/.claude/projects/-Users-Luki-medmaster/7c47b729-35f5-48ca-9813-ad7448d21ae7/subagents/agent-a7518d1f4a2010ec0.jsonl 2>/dev/null | python3 -c \"\nimport sys, json\nlines = sys.stdin.readlines\\(\\)\nprint\\(f'Total lines: {len\\(lines\\)}'\\)\n# check last message\nfor line in lines[-3:]:\n    try:\n        d = json.loads\\(line.strip\\(\\)\\)\n        t = d.get\\('type', '?'\\)\n        msg = d.get\\('message', {}\\)\n        if t == 'assistant':\n            content = msg.get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text':\n                    print\\('LAST MSG:', c['text'][-300:]\\)\n    except: pass\n\")",
      "Bash(cat /Users/Luki/.claude/projects/-Users-Luki-medmaster/7c47b729-35f5-48ca-9813-ad7448d21ae7/subagents/agent-a553015c8be0b70a6.jsonl 2>/dev/null | python3 -c \"\nimport sys, json\nlines = sys.stdin.readlines\\(\\)\nprint\\(f'Total lines: {len\\(lines\\)}'\\)\nfor line in lines[-3:]:\n    try:\n        d = json.loads\\(line.strip\\(\\)\\)\n        t = d.get\\('type', '?'\\)\n        if t == 'assistant':\n            content = d.get\\('message', {}\\).get\\('content', []\\)\n            for c in content:\n                if c.get\\('type'\\) == 'text':\n                    print\\('LAST MSG:', c['text'][-300:]\\)\n    except: pass\n\")",
      "Bash(git commit -m \"feat: add dynamic page titles to 26 pages + SEK difficulty values\n\n- Add usePageTitle hook to 19 additional pages \\(total: 26/71\\)\n  Pages: FragenTrainer, WissenCheck, Simulation, DailyChallenge, Lernplan,\n  SchwachstellenTrainer, LoginPage, RegisterPage, ForgotPasswordPage,\n  Community, Notes, PerformanceOverview, Prognose, Pricing, Formelsammlung,\n  KFFAcademy, AITutor, StichwortlistePage, BMSWrapped + others\n- Assign difficulty 1|2|3 to all 80 SEK tasks in sekDataNew.ts\n  \\(Erkennen: 28, Regulieren: 24, Entscheiden: 28\\)\n- Update TV comment: 5 Fragen/Text target \\(was '12 Fragen'\\)\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/tvTextsExpanded.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\nfixed = 0\nfor i in range\\(len\\(lines\\)-1\\):\n    if lines[i].rstrip\\(\\) == '        }' and lines[i+1].rstrip\\(\\) == '        {':\n        lines[i] = lines[i].rstrip\\(\\) + ',\\\\n'\n        fixed += 1\n\nwith open\\('src/data/tvTextsExpanded.ts', 'w'\\) as f:\n    f.writelines\\(lines\\)\n\nprint\\(f'Fixed {fixed} missing commas'\\)\n\")",
      "Bash(python3 -c \"\nwith open\\('src/data/tvTextsExpanded.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\nfor i in range\\(1215, 1220\\):\n    print\\(f'Line {i+1}: {repr\\(lines[i]\\)}'\\)\n\")",
      "Bash(python3 -c \"\nwith open\\('src/data/tvTextsExpanded2.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\n# Find tv6-1-q3 context \\(first text in set 6\\)\nfor i, l in enumerate\\(lines\\):\n    if 'tv6-1-q' in l or 'questions: [' in l or '],\\\\n' == l.rstrip\\('\\\\n'\\) + '\\\\n' or '      ],' in l:\n        if i > 60 and i < 130:\n            print\\(f'{i+1}: {repr\\(l\\)}'\\)\n\" 2>/dev/null | head -40)",
      "Bash(python3 -c \"\nwith open\\('src/data/tvTextsExpanded2.ts', 'r'\\) as f:\n    lines = f.readlines\\(\\)\n\n# Find tv6-1-q2 and the structure around it \\(before injection point\\)\nfor i, l in enumerate\\(lines\\):\n    if i > 55 and i < 100:\n        print\\(f'{i+1}: {repr\\(l\\)}'\\)\" 2>/dev/null)",
      "Bash(python3 << 'PYEOF'\nimport re\n\nwith open\\('src/data/tvTextsExpanded2.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\ndef make_question\\(qid, question, options, correct_option, explanation\\):\n    \"\"\"Generate a properly formatted question object\"\"\"\n    opts = '\\\\n'.join\\(f'            \"{o}\",' for o in options\\)\n    return f'''        {{\n          id: \"{qid}\",\n          question: \"{question}\",\n          options: [\n{opts}\n          ],\n          correctOption: {correct_option},\n          explanation: \"{explanation}\",\n        }}'''\n\ndef inject_after_last_question\\(content, last_question_id, new_questions_str\\):\n    \"\"\"Insert new questions after the closing }, of last_question_id\"\"\"\n    # Find the last occurrence of this id\n    search = f'id: \"{last_question_id}\"'\n    idx = content.rfind\\(search\\)\n    if idx < 0:\n        print\\(f\"ERROR: Not found: {last_question_id}\"\\)\n        return content\n    \n    # Find the closing }, of this question \\(next occurrence of },\\\\n after the explanation\\)\n    # Look for },\\\\n followed by either another question { or the ],\\\\n closing the questions array\n    close_pos = content.find\\('\\\\n        },', idx\\)\n    if close_pos < 0:\n        print\\(f\"ERROR: No close for {last_question_id}\"\\)\n        return content\n    close_pos += len\\('\\\\n        },'\\)  # move past the },\n    \n    return content[:close_pos] + ',\\\\n' + new_questions_str + content[close_pos:]\n\n# Define all new questions\n# SET 6\nq6_1_4 = make_question\\(\"tv6-1-q4\", \"Was ist die Hauptaussage des Textes über das Immunsystem?\",\n    [\"Nur Antikörper und Killerzellen.\",\n     \"Zweistufiges Netzwerk aus angeborenem und erworbenem System; Gedächtnis bildet Impfgrundlage.\",\n     \"Kann durch Impfungen ersetzt werden.\",\n     \"Angeborenes System ist überlegen.\",\n     \"Autoimmunerkrankungen häufigste Folge.\"],\n    1, \"Der Text beschreibt das Immunsystem als zweigeteiltes System und zeigt, wie das immunologische Gedächtnis die Grundlage von Impfungen bildet.\"\\)\n\nq6_1_5 = make_question\\(\"tv6-1-q5\", \"Welche Schlussfolgerung lässt sich über B-Lymphozyten und zytotoxische T-Zellen ziehen?\",\n    [\"Beide gehören zum angeborenen System.\",\n     \"Beide sind redundant.\",\n     \"Ergänzen sich: B-Lymphozyten markieren, T-Zellen töten infizierte Zellen.\",\n     \"T-Zellen von B-Zellen produziert.\",\n     \"B-Zellen nur beim Erstkontakt aktiv.\"],\n    2, \"B-Lymphozyten markieren Erreger mit Antikörpern; zytotoxische T-Zellen töten infizierte Körperzellen. Beide gehören zum erworbenen Immunsystem.\"\\)\n\nq6_2_3 = make_question\\(\"tv6-2-q3\", \"Was ist die Hauptaussage des Textes über Stammzellen?\",\n    [\"Nur für Knochenmark.\",\n     \"Einzigartige Fähigkeiten, großes Potenzial, viele Therapien noch in Erforschung.\",\n     \"iPS-Zellen haben embryonale verdrängt.\",\n     \"Hauptrisiko Abstoßungsreaktion.\",\n     \"Adulte Stammzellen wichtiger.\"],\n    1, \"Der Text stellt verschiedene Stammzelltypen vor und weist auf Risiken sowie den frühen Stand vieler Therapien hin.\"\\)\n\nq6_2_4 = make_question\\(\"tv6-2-q4\", \"Welche Schlussfolgerung lässt der Text zum Risiko der Stammzelltherapie zu?\",\n    [\"Vollständig sicher.\",\n     \"Einziges Risiko ist Ethik.\",\n     \"Trotz Tierversuchen Risiko unkontrollierter Zellteilung; weitere Forschung nötig.\",\n     \"iPS risikofrei.\",\n     \"Tumor nur bei adulten Stammzellen.\"],\n    2, \"Der Text warnt, dass das Risiko unkontrollierter Zellteilung sorgfältig erforscht werden muss.\"\\)\n\nq6_3_3 = make_question\\(\"tv6-3-q3\", \"Was ist laut dem Text die Hauptaussage über Prionenerkrankungen?\",\n    [\"Selten und nur bei Rindern.\",\n     \"Neuartiger Mechanismus, stets tödlich, lange Inkubationszeit erschwert Diagnose.\",\n     \"Mit Antibiotika behandelbar.\",\n     \"Hauptübertragbarkeit Tier zu Mensch.\",\n     \"Prusiner sofort akzeptiert.\"],\n    1, \"Der Text beschreibt den einzigartigen Mechanismus der Prionen, listet bekannte Erkrankungen auf und betont die lange Inkubationszeit.\"\\)\n\nq6_3_4 = make_question\\(\"tv6-3-q4\", \"Welche Schlussfolgerung lässt sich über die Ausbreitung von PrPSc im Gehirn ziehen?\",\n    [\"Über Blutgefäße in alle Organe.\",\n     \"PrPSc faltet gesunde Prion-Proteine um, selbstverstärkende Kettenreaktion.\",\n     \"Immunsystem kann PrPSc eliminieren.\",\n     \"Durch Nervenzellen aktiv transportiert.\",\n     \"Ausbreitung verlangsamt sich ab kritischer Menge.\"],\n    1, \"PrPSc faltet benachbarte normale Prion-Proteine um und löst so eine selbstverstärkende Kettenreaktion aus.\"\\)\n\nq6_4_3 = make_question\\(\"tv6-4-q3\", \"Was ist die Hauptaussage des Textes zur Antibiotikaresistenz?\",\n    [\"Gelöstes Problem.\",\n     \"Globale Bedrohung durch unsachgemäßen Einsatz; ohne Gegenmaßnahmen drastisch zunehmend.\",\n     \"Nur MRSA gefährlich.\",\n     \"Antibiotika nicht mehr einsetzen.\",\n     \"Nur Landwirtschaft Verursacher.\"],\n    1, \"Der Text nennt Antibiotikaresistenz als globale Bedrohung.\"\\)\n\nq6_4_4 = make_question\\(\"tv6-4-q4\", \"Welche Schlussfolgerung lässt der Text zum Selektionsdruck durch Antibiotika zu?\",\n    [\"Antibiotika töten alle Bakterien.\",\n     \"Selektionsdruck begünstigt resistente Stämme, da empfindliche absterben und resistente sich vermehren.\",\n     \"Resistente werden langfristig empfindlich.\",\n     \"Nur in Landwirtschaft wirksam.\",\n     \"Nur durch horizontalen Gentransfer.\"],\n    1, \"Selektionsdruck begünstigt resistente Stämme: empfindliche sterben ab, resistente überleben.\"\\)\n\nq6_5_4 = make_question\\(\"tv6-5-q4\", \"Welche Schlussfolgerung lässt sich über den Einsatz von Ciclosporin ziehen?\",\n    [\"Ciclosporin löst Abstoßung vollständig ohne Nebenwirkungen.\",\n     \"Ciclosporin ermöglicht Transplantationen durch T-Lymphozyten-Hemmung, erfordert aber lebenslange Einnahme mit erhöhtem Infektions- und Krebsrisiko.\",\n     \"Ciclosporin nur kurzfristig.\",\n     \"Unterdrückt gesamtes Immunsystem.\",\n     \"Bereits 1954 eingesetzt.\"],\n    1, \"Ciclosporin unterdrückt die Abstoßung durch T-Lymphozyten-Hemmung, erfordert aber lebenslange Einnahme.\"\\)\n\n# SET 7\nq7_1_4 = make_question\\(\"tv7-1-q4\", \"Was ist die Hauptaussage des Textes über die Photosynthese?\",\n    [\"Nur Sauerstoffproduktion.\",\n     \"Zweiphasiger Prozess; Faktoren wie Temperatur und CO2 beeinflussen Effizienz.\",\n     \"RuBisCO wichtigstes Pigment.\",\n     \"Nur C4 bei Hitze möglich.\",\n     \"Chlorophyll a und b austauschbar.\"],\n    1, \"Der Text beschreibt die Photosynthese als zweiphasigen Prozess und erläutert, wie Faktoren die Effizienz beeinflussen.\"\\)\n\nq7_1_5 = make_question\\(\"tv7-1-q5\", \"Welche Schlussfolgerung lässt sich über den Vorteil der C4-Photosynthese ziehen?\",\n    [\"C4 ohne Spaltöffnungen.\",\n     \"C4 verzichtet auf Calvin-Zyklus.\",\n     \"C4-Photosynthese ermöglicht effizientere CO2-Fixierung bei Hitze und umgeht Photosyntheserückgang durch Spaltöffnungsschluss.\",\n     \"C4 mehr Sauerstoff ohne RuBisCO.\",\n     \"C4 am effizientesten in gemäßigten Zonen.\"],\n    2, \"Bei Hitze schließen Pflanzen Spaltöffnungen und die Photosyntheserate sinkt. C4-Pflanzen ermöglichen effizientere CO2-Fixierung.\"\\)\n\nq7_2_3 = make_question\\(\"tv7-2-q3\", \"Was ist die Hauptaussage des Textes zur Ozeanversäuerung?\",\n    [\"Nur Korallenriffe betroffen.\",\n     \"CO2-Aufnahme führt zur Versäuerung, bedroht marine Ökosysteme und menschliche Lebensgrundlage.\",\n     \"Ozeane nehmen unbegrenzt CO2 auf.\",\n     \"Kalkschalenbildner nicht gefährdet.\",\n     \"Natürlicher Vorgang.\"],\n    1, \"Der Text erklärt, wie CO2-Emissionen zur Versauerung führen, und betont die Bedrohung für marine Ökosysteme.\"\\)\n\nq7_2_4 = make_question\\(\"tv7-2-q4\", \"Welche Schlussfolgerung lässt sich über die doppelte Bedrohung von Korallenriffen ziehen?\",\n    [\"Entweder Versäuerung oder Erwärmung, nie beide.\",\n     \"Korallenbleiche weniger gefährlich.\",\n     \"Korallenriffe durch Versäuerung und Meereswärmung gleichzeitig bedroht; gefährdet Lebensraum für ein Viertel mariner Arten.\",\n     \"Nur tropisch oder polar betroffen.\",\n     \"Korallen passen sich rasch an.\"],\n    2, \"Korallenriffe sind durch Versäuerung und Meereswärmung gleichzeitig bedroht.\"\\)\n\nq7_3_3 = make_question\\(\"tv7-3-q3\", \"Was ist die Hauptaussage des Textes über Vulkanismus und Klima?\",\n    [\"Hauptursache aktuellen Klimawandels.\",\n     \"Kühlend durch Sulfataerosole kurzfristig, erwärmend durch CO2 langfristig, negativ auf Ozonschicht.\",\n     \"CO2 wichtiger als Sulfataerosole.\",\n     \"Tambora ohne Auswirkung.\",\n     \"Sulfataerosole wirken jahrzehntelang.\"],\n    1, \"Der Text beschreibt den kühlenden Sulfataerosol-Effekt, den geringen CO2-Treibhauseffekt und den negativen Einfluss auf die Ozonschicht.\"\\)\n\nq7_3_4 = make_question\\(\"tv7-3-q4\", \"Welche Schlussfolgerung lässt sich aus dem Vergleich von Tambora und Pinatubo ziehen?\",\n    [\"Größere SO2-Mengen tendieren zu stärkerem Kühlungseffekt.\",\n     \"Pinatubo stärker als Tambora.\",\n     \"Beide ohne messbaren Einfluss.\",\n     \"Tambora keine Hungersnot.\",\n     \"Inselvulkane generell stärker.\"],\n    0, \"Tambora setzte 60 Mio. Tonnen SO2 frei und kühlte stärker; Pinatubo 20 Mio. Tonnen. Größere SO2-Mengen gehen tendenziell mit stärkerem Kühlungseffekt einher.\"\\)\n\nq7_4_3 = make_question\\(\"tv7-4-q3\", \"Was ist die Hauptaussage des Textes über genetische Drift?\",\n    [\"Drift ist dasselbe wie natürliche Selektion.\",\n     \"Zufälliger Evolutionsmechanismus in kleinen Populationen; Gründer- und Flaschenhalseffekt führen zu Genverarmung.\",\n     \"Nur in Inselpopulationen relevant.\",\n     \"Begünstigt angepasste Allele.\",\n     \"Flaschenhalseffekt einziger Mechanismus.\"],\n    1, \"Der Text definiert genetische Drift als zufälligen Mechanismus jenseits der Selektion, stärker in kleinen Populationen.\"\\)\n\nq7_4_4 = make_question\\(\"tv7-4-q4\", \"Welche Schlussfolgerung lässt sich über die Krankheitsanfälligkeit der Geparden ziehen?\",\n    [\"Körpergröße als Ursache.\",\n     \"Geringe genetische Diversität durch Flaschenhals macht Geparden anfälliger und weniger anpassungsfähig.\",\n     \"Bejagung veränderte Gene.\",\n     \"Natürliche Selektion als Ursache.\",\n     \"Nur anfällig für Viren.\"],\n    1, \"Die geringe genetische Diversität der Geparden geht auf einen Flaschenhals zurück und macht sie anfälliger.\"\\)\n\nq7_5_4 = make_question\\(\"tv7-5-q4\", \"Welche Schlussfolgerung lässt sich über die ökologische Rolle von Parasiten ziehen?\",\n    [\"Parasiten nur schädlich.\",\n     \"Kein Einfluss auf Populationsdynamik.\",\n     \"Trotz Schädigung des Wirts wichtig für Ökosysteme; regulieren Populationen und fördern Biodiversität.\",\n     \"Parasitismus Übergangsform zwischen Kommensalismus und Mutualismus.\",\n     \"Parasiten profitieren langfristig nicht.\"],\n    2, \"Parasiten schaden dem Wirt, sind aber wichtige Bestandteile von Ökosystemen, da sie die Populationsdynamik regulieren.\"\\)\n\n# SET 8\nq8_1_3 = make_question\\(\"tv8-1-q3\", \"Welche Schlussfolgerung lässt sich aus dem Text über die Entfernung von Neurotransmittern aus dem synaptischen Spalt ziehen?\",\n    [\"Glutamat und GABA im Gleichgewicht.\",\n     \"Alle Neurotransmitter werden nach Signal abgebaut.\",\n     \"Neurotransmitter werden durch enzymatischen Abbau, Wiederaufnahme oder Diffusion aus dem synaptischen Spalt entfernt.\",\n     \"Serotonin reguliert die Wiederaufnahme aller Neurotransmitter.\",\n     \"Aktionspotenzial wird in Vesikel gespeichert.\"],\n    2, \"Der Text beschreibt drei Mechanismen: enzymatischen Abbau, Wiederaufnahme durch Transporterproteine und Diffusion.\"\\)\n\nq8_1_4 = make_question\\(\"tv8-1-q4\", \"Was ist die Hauptaussage des Textes über Neurotransmitter?\",\n    [\"Einziges Problem ist GABA-Mangel.\",\n     \"Neurotransmitter-Ungleichgewichte sind selten und klinisch irrelevant.\",\n     \"Chemische Botenstoffe übertragen Signale an Synapsen; Ungleichgewichte führen zu neuropsychiatrischen Erkrankungen und bilden Ansatzpunkte für Psychopharmaka.\",\n     \"Glutamat ist der einzige Neurotransmitter im Gehirn.\",\n     \"Dopamin hat keine Auswirkungen auf Bewegung.\"],\n    2, \"Der Text beschreibt Neurotransmitter als chemische Botenstoffe an Synapsen und zeigt, wie Ungleichgewichte zu Erkrankungen führen.\"\\)\n\nq8_2_4 = make_question\\(\"tv8-2-q4\", \"Welche Schlussfolgerung lässt sich über die praktischen Herausforderungen der CAR-T-Zelltherapie ziehen?\",\n    [\"CAR-T-Zellen sind vollkommen risikofrei.\",\n     \"CAR-T-Therapie hat keine Nebenwirkungen.\",\n     \"Die hohen Kosten und der Zytokinsturm sind zentrale Herausforderungen, die den breiten Einsatz der CAR-T-Therapie begrenzen.\",\n     \"CAR-T-Therapie wirkt nur bei festen Tumoren.\",\n     \"CAR-T-Zellen werden nach der Therapie vom Körper abgebaut.\"],\n    2, \"Der Text nennt den Zytokinsturm und die hohen Kosten als zentrale Herausforderungen der CAR-T-Therapie.\"\\)\n\nq8_3_3 = make_question\\(\"tv8-3-q3\", \"Was ist die Hauptaussage des Textes über CRISPR-Cas9?\",\n    [\"Doudna und Charpentier erfanden CRISPR als Waffe gegen Bakterien.\",\n     \"CRISPR-Cas9 wurde 2020 erstmals an Pflanzen angewendet.\",\n     \"CRISPR-Cas9 ist ein vielseitiges Genomwerkzeug, das aus einem bakteriellen Abwehrsystem entwickelt wurde und Anwendungen in Landwirtschaft, Forschung und Medizin bietet.\",\n     \"CRISPR-Cas9 kann nur Gensequenzen löschen, nicht ersetzen.\",\n     \"Keimbahnedierung ist weltweit erlaubt.\"],\n    2, \"CRISPR-Cas9 ist ein natürliches bakterielles Immunsystem, das zu einem universellen Genomwerkzeug umfunktioniert wurde.\"\\)\n\nq8_3_4 = make_question\\(\"tv8-3-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über die Flexibilität von CRISPR-Cas9 ziehen?\",\n    [\"Die Guide-RNA kann beliebige Zielsequenzen erkennen, weil Cas9 ohne sie nicht funktioniert.\",\n     \"Da Cas9 die DNA an der Zielsequenz schneidet und zelleigene Reparaturmechanismen die Bearbeitung ermöglichen, lässt sich jedes beliebige Gen gezielt verändern.\",\n     \"CRISPR funktioniert nur in Bakterienzellen.\",\n     \"Die Guide-RNA ist immer identisch, unabhängig von der Zielsequenz.\",\n     \"Cas9 kann nur DNA schneiden, nicht reparieren.\"],\n    1, \"Da die Guide-RNA synthetisch für jede beliebige Zielsequenz entworfen werden kann, ist CRISPR-Cas9 ein universell einsetzbares Werkzeug.\"\\)\n\nq8_4_4 = make_question\\(\"tv8-4-q4\", \"Welche Schlussfolgerung lässt sich über die Bewertung von Sterbehilfe im Text ziehen?\",\n    [\"Nur aktive Sterbehilfe ist ethisch problematisch.\",\n     \"Alle Sterbehilfeformen sind weltweit verboten.\",\n     \"Die rechtliche und ethische Bewertung von aktiver und passiver Sterbehilfe unterscheidet sich erheblich zwischen Ländern und Kulturen, was globale Standards erschwert.\",\n     \"Palliativmedizin und Sterbehilfe sind identisch.\",\n     \"Der Arzt entscheidet allein über Sterbehilfe.\"],\n    2, \"Der Text stellt fest, dass die Bewertung von Sterbehilfe zwischen Ländern erheblich variiert, was globale Standards erschwert.\"\\)\n\nq8_5_3 = make_question\\(\"tv8-5-q3\", \"Was ist die Hauptaussage des Textes über die forensische Medizin?\",\n    [\"Forensische Medizin ist ausschließlich für Mordermittlungen zuständig.\",\n     \"Genetischer Fingerabdruck ist seit 1970 in Verwendung.\",\n     \"Forensische Medizin wendet medizinisches Wissen auf rechtliche Fragen an; DNA-Analyse ermöglicht eindeutige Identifikation, wirft aber Persönlichkeitsschutzfragen auf.\",\n     \"Totenflecke entstehen durch chemische Reaktionen, nicht durch Blutabsinken.\",\n     \"Die Obduktion ist in Österreich verboten.\"],\n    2, \"Forensische Medizin verbindet medizinisches Wissen mit rechtlichen Aufgaben; DNA-Analyse revolutionierte die Identifikation.\"\\)\n\nq8_5_4 = make_question\\(\"tv8-5-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über Totenflecke als Todeszeitindikator ziehen?\",\n    [\"Totenflecke fixieren sich sofort nach dem Tod.\",\n     \"Totenflecke entstehen durch Blutabsinken in tiefer liegende Körperpartien, sind anfänglich wegdrückbar und fixieren sich nach 12-24 Stunden.\",\n     \"Totenflecke sind dauerhaft wegdrückbar.\",\n     \"Totenflecke entstehen nur bei Kälte.\",\n     \"Totenflecke und Totenstarre treten gleichzeitig auf.\"],\n    1, \"Totenflecke entstehen durch Blutabsinken, sind anfänglich wegdrückbar und fixieren sich nach 12-24 Stunden.\"\\)\n\n# SET 9\nq9_1_3 = make_question\\(\"tv9-1-q3\", \"Was ist die Hauptaussage des Textes über Klimawandel und menschliche Gesundheit?\",\n    [\"Klimawandel betrifft nur tropische Regionen.\",\n     \"Nur Hitzewellen sind relevant.\",\n     \"Der Klimawandel gefährdet die Gesundheit direkt durch Hitzestress und indirekt durch Ausbreitung von Krankheiten, Luftqualitätsverschlechterung und psychische Folgen.\",\n     \"Klimawandel hat keine Auswirkungen auf Infektionskrankheiten.\",\n     \"Nur ältere Menschen sind durch Klimawandel gefährdet.\"],\n    2, \"Der Text beschreibt direkte Auswirkungen wie Hitzestress und indirekte wie Ausbreitung von Vektoren und psychische Folgen.\"\\)\n\nq9_1_4 = make_question\\(\"tv9-1-q4\", \"Welche Schlussfolgerung lässt sich über die Ausbreitung von Tropenkrankheiten durch den Klimawandel ziehen?\",\n    [\"Dengue-Fieber ist in Europa endemisch.\",\n     \"Die Tigermücke überträgt nur Malaria.\",\n     \"Weil erwärmte Regionen nun für Wärme-liebende Vektoren wie die Tigermücke geeignet sind, breiten sich Tropenkrankheiten in bisher verschonte Gebiete aus.\",\n     \"Dengue-Fieber wird nur durch direkte Berührung übertragen.\",\n     \"Nur Malaria wird durch Klimawandel beeinflusst.\"],\n    2, \"Erwärmung macht neue Gebiete für die Tigermücke geeignet, was autochthone Dengue-Fälle in Europa erklärt.\"\\)\n\nq9_2_4 = make_question\\(\"tv9-2-q4\", \"Was ist die Hauptaussage des Textes über Pandemien und ihre Bekämpfung?\",\n    [\"Die Spanische Grippe betraf nur ältere Menschen.\",\n     \"Pandemien sind durch moderne Medizin vollständig vermeidbar.\",\n     \"Pandemien werden durch Zoonosen wahrscheinlicher; Ungleichheiten bei Impfstoffverteilung und Fehlinformationen erschwerten die COVID-19-Bekämpfung.\",\n     \"mRNA-Impfstoffe sind die einzige wirksame Schutzmaßnahme gegen Pandemien.\",\n     \"Der Schwarze Tod hatte keine sozialen Folgen.\"],\n    2, \"Pandemien werden durch Zoonosen wahrscheinlicher; der Text zeigt, dass Ungleichheiten bei Impfstoffverteilung zentrale Hindernisse sind.\"\\)\n\nq9_3_3 = make_question\\(\"tv9-3-q3\", \"Was ist die Hauptaussage des Textes über die Psychoneuroimmunologie?\",\n    [\"PNI untersucht nur die Auswirkungen von Stress auf Verdauung.\",\n     \"PNI hat keine klinische Relevanz.\",\n     \"PNI belegt, dass Psyche, Nervensystem und Immunsystem eng verbunden sind; positive Interventionen können das Immunsystem verbessern.\",\n     \"Chronischer Stress stärkt das Immunsystem.\",\n     \"Das Immunsystem ist vollständig autonom.\"],\n    2, \"PNI belegt, dass Psyche, Nervensystem und Immunsystem wechselseitig verbunden sind.\"\\)\n\nq9_3_4 = make_question\\(\"tv9-3-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über die Behandlung stressbedingter Immunschwäche ziehen?\",\n    [\"Nur Cortisol vermittelt Stress-Immunverbindung.\",\n     \"Chronischer Stress hat keinen Einfluss auf Impfansprechen.\",\n     \"Da chronischer Stress über HPA-Achse und autonomes Nervensystem das Immunsystem schwächt, ist ein ganzheitlicher Behandlungsansatz mit psychologischen Interventionen sinnvoll.\",\n     \"Achtsamkeit hat keinen Einfluss auf das Immunsystem.\",\n     \"Das autonome Nervensystem ist nicht mit lymphatischen Organen verbunden.\"],\n    2, \"Da Stress über HPA-Achse und autonomes Nervensystem das Immunsystem schwächt, sprechen PNI-Erkenntnisse für ganzheitliche Behandlungsansätze.\"\\)\n\nq9_4_4 = make_question\\(\"tv9-4-q4\", \"Was ist die Hauptaussage des Textes über die Nanomedizin?\",\n    [\"Nanomedizin ist ausschließlich für Diagnostik.\",\n     \"Nanopartikel sind vollkommen sicher.\",\n     \"Nanomedizin nutzt Nanoskala-Eigenschaften für gezieltes Drug Delivery und verbesserte Diagnostik, birgt aber noch nicht vollständig verstandene Toxizitätsrisiken.\",\n     \"EPR-Effekt betrifft nur gesundes Gewebe.\",\n     \"Nanopartikel werden sofort vom Körper ausgeschieden.\"],\n    2, \"Nanomedizin nutzt Nanoskala-Eigenschaften für Drug Delivery und Diagnostik; Toxizitätsrisiken sind noch nicht vollständig verstanden.\"\\)\n\nq9_4_5 = make_question\\(\"tv9-4-q5\", \"Welche Schlussfolgerung lässt sich über die Zielgerichtetheit von Nanopartikeln in der Krebstherapie ziehen?\",\n    [\"Ligandfunktionalisierung ist bei Nanopartikeln unwirksam.\",\n     \"Nanopartikel können nicht in Tumorgewebe eindringen.\",\n     \"Da Nanopartikel durch den EPR-Effekt in Tumorgewebe angereichert werden und zusätzlich mit Liganden funktionalisiert werden können, ergibt sich eine zweistufige Zielgerichtetheit.\",\n     \"EPR-Effekt betrifft alle Gewebe gleich.\",\n     \"Liganden erhöhen die Toxizität der Nanopartikel.\"],\n    2, \"EPR-Effekt ermöglicht passive Anreicherung in Tumoren; Ligand-Funktionalisierung ermöglicht aktive Zielsteuerung. Zweistufige Zielgerichtetheit.\"\\)\n\nq9_5_3 = make_question\\(\"tv9-5-q3\", \"Was ist die Hauptaussage des Textes über die Neurobiologie der Abhängigkeit?\",\n    [\"Sucht ist eine Frage mangelnder Willenskraft.\",\n     \"Sucht betrifft nur das Dopaminsystem.\",\n     \"Sucht ist eine chronische Hirnerkrankung; neuroadaptive Veränderungen in Belohnungssystem und präfrontalem Kortex erklären den Kontrollverlust trotz negativer Folgen.\",\n     \"Sucht kann allein durch Medikamente geheilt werden.\",\n     \"Das mesolimbische System ist nicht an Sucht beteiligt.\"],\n    2, \"Sucht ist eine chronische Hirnerkrankung; neuroadaptive Veränderungen erklären Kontrollverlust und fortgesetzten Konsum.\"\\)\n\nq9_5_4 = make_question\\(\"tv9-5-q4\", \"Welche Schlussfolgerung lässt sich über den Wirkmechanismus von Alkohol und Opiaten im Vergleich zu Kokain ziehen?\",\n    [\"Alkohol blockiert die Dopamin-Wiederaufnahme wie Kokain.\",\n     \"Opioide steigern direkt die Dopaminfreisetzung aus Vesikeln.\",\n     \"Da Alkohol und Opioide hemmende Interneuronen unterdrücken, wirken sie indirekt; ihre Wirkweise unterscheidet sich von direkter Dopaminbeeinflussung durch Kokain oder Amphetamine.\",\n     \"Alle Suchtmittel wirken durch denselben Mechanismus.\",\n     \"Alkohol hat keine Wirkung auf das mesolimbische System.\"],\n    2, \"Alkohol und Opioide unterdrücken hemmende Interneuronen \\(indirekt\\); Kokain blockiert Dopamin-Wiederaufnahme \\(direkt\\).\"\\)\n\n# SET 10\nq10_1_3 = make_question\\(\"tv10-1-q3\", \"Was ist die Hauptaussage des Textes über die evolutionäre Medizin?\",\n    [\"Evolutionäre Medizin sieht Krankheiten als unvermeidlich.\",\n     \"Evolutionäre Medizin lehnt jede Behandlung ab.\",\n     \"Evolutionäre Medizin erklärt Krankheiten als evolutionsgepraegtes Phänomen; Symptome wie Fieber können adaptiv sein und das heterozygote Sichelzellgen bietet einen Malariaschutz.\",\n     \"Fieber sollte immer unterdrückt werden.\",\n     \"Das Sichelzellgen ist global gleichmäßig verbreitet.\"],\n    2, \"Der Text beschreibt die Mismatch-Hypothese, die adaptive Funktion von Fieber und den heterozygoten Malariaschutz des Sichelzellgens.\"\\)\n\nq10_1_4 = make_question\\(\"tv10-1-q4\", \"Welche Schlussfolgerung lässt sich über die Behandlung von Fieber aus dem Text ziehen?\",\n    [\"Fieber ist grundsätzlich gefährlich und sollte immer behandelt werden.\",\n     \"Unterdrückung von Fieber reduziert Sterblichkeit bei Infektionen.\",\n     \"Da Fieber bei bestimmten Infektionen die Sterblichkeit bei Unterdrückung erhöhen kann, spricht der Text für eine differenzierte statt automatische Fieberbehandlung.\",\n     \"Fieber hat keine messbaren Vorteile.\",\n     \"Fieber ist ausschließlich ein Nebenprodukt der Infektion.\"],\n    2, \"Der Text stellt fest, dass Fieberunterdrückung bei bestimmten Infektionen die Sterblichkeit erhöhen kann, was eine differenzierte Behandlung nahelegt.\"\\)\n\nq10_2_3 = make_question\\(\"tv10-2-q3\", \"Was ist die Hauptaussage des Textes über künstliche Organe und Bioprinting?\",\n    [\"Bioprinting kann bereits komplexe Organe vollständig ersetzen.\",\n     \"Dialyse ist keine Form des künstlichen Organersatzes.\",\n     \"Mechanische Systeme wie Dialyse und VADs existieren bereits; Bioprinting bietet Zukunftspotenzial, scheitert aber noch an der Vaskularisierung komplexer Organe.\",\n     \"VADs erzeugen einen normalen Herzrhythmus.\",\n     \"Künstliche Organe sind günstiger als Transplantate.\"],\n    2, \"Mechanische Ersatzsysteme wie Dialyse und VADs existieren bereits; Bioprinting bietet großes Potenzial, scheitert aber noch an der Vaskularisierung.\"\\)\n\nq10_2_4 = make_question\\(\"tv10-2-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über die Bedeutung der Vaskularisierung für das Bioprinting ziehen?\",\n    [\"Zellen können unbegrenzt weit von Blutgefäßen entfernt überleben.\",\n     \"Wachstumsfaktoren sind für Bioprinting irrelevant.\",\n     \"Da Zellen mehr als 200 Mikrometer von Blutgefäßen absterben, ist die Lösung des Vaskularisierungsproblems entscheidend für das Bioprinting komplexer Organe.\",\n     \"Hydrogel ersetzt die Funktion von Blutgefäßen.\",\n     \"Bioprinting-Organe benötigen keine Vaskularisierung.\"],\n    2, \"Da Zellen mehr als 200 Mikrometer von Gefäßen absterben, ist die Vaskularisierung die entscheidende Hürde für das Bioprinting.\"\\)\n\nq10_3_3 = make_question\\(\"tv10-3-q3\", \"Was ist die Hauptaussage des Textes über die Gentherapie?\",\n    [\"Gentherapie ist bereits vollständig sicher und breit verfügbar.\",\n     \"Gentherapie behandelt nur Bluterkrankungen.\",\n     \"Gentherapie korrigiert genetische Defekte direkt mithilfe viraler Vektoren; zugelassene Therapien zeigen beeindruckende Ergebnisse, sind aber oft extrem teuer.\",\n     \"Gentherapie ersetzt alle anderen Behandlungsformen.\",\n     \"AAV-Vektoren integrieren sich ins menschliche Genom.\"],\n    2, \"Gentherapie korrigiert genetische Defekte durch virale Vektoren; Luxturna und Zolgensma zeigen beeindruckende Ergebnisse, sind aber durch extreme Kosten begrenzt.\"\\)\n\nq10_3_4 = make_question\\(\"tv10-3-q4\", \"Welche Schlussfolgerung lässt sich aus dem Beispiel Zolgensma über Gentherapie ziehen?\",\n    [\"Da Zolgensma über 2 Mio. USD kostet, können nicht alle Patienten auf lebensrettende Gentherapien zugreifen, was die Frage der Verteilungsgerechtigkeit aufwirft.\",\n     \"Zolgensma ist weltweit kostenlos verfügbar.\",\n     \"Nur reiche Länder entwickeln Gentherapien.\",\n     \"Die hohen Kosten sind durch die Wirksamkeit gerechtfertigt und kein Problem.\",\n     \"Alle Gentherapien sind gleich teuer.\"],\n    0, \"Zolgensma kostet über 2 Mio. USD, was Fragen der Zugangsgerechtigkeit aufwirft.\"\\)\n\nq10_4_4 = make_question\\(\"tv10-4-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über die begrenzte CPAP-Akzeptanz ziehen?\",\n    [\"CPAP ist nur für leichte Schlafapnoe geeignet.\",\n     \"Schlafapnoe hat keine langfristigen Herzfolgen.\",\n     \"Da CPAP bei 50-70% der Patienten akzeptiert wird, zeigt der Text, dass alternative Therapien wie Schienen oder Operationen wichtig sind, um alle Patienten zu erreichen.\",\n     \"Schienen ersetzen CPAP vollständig.\",\n     \"Schlafapnoe kann nur operativ behandelt werden.\"],\n    2, \"Da nur 50-70% der Patienten CPAP langfristig akzeptieren, sind alternative Therapien wichtig, um alle Patienten effektiv zu behandeln.\"\\)\n\nq10_5_4 = make_question\\(\"tv10-5-q4\", \"Welche Schlussfolgerung lässt sich aus dem Text über die ethische Problematik der Tiefen Hirnstimulation ziehen?\",\n    [\"Tiefe Hirnstimulation ist vollkommen risikolos.\",\n     \"Persönlichkeit ändert sich nie durch medizinische Behandlung.\",\n     \"Da Tiefe Hirnstimulation die Persönlichkeit verändern kann, stellt sich die Frage, ob der Patient nach dem Eingriff noch seine ursprüngliche Zustimmung zur Therapie aufrechterhalten kann.\",\n     \"Tiefe Hirnstimulation hat keinerlei Einfluss auf die Psyche.\",\n     \"Persönlichkeitsveränderungen sind erwartete und erwünschte Nebenwirkungen.\"],\n    2, \"Tiefe Hirnstimulation kann die Persönlichkeit verändern; wenn ein Patient danach seine Zustimmung widerrufen möchte, stellt sich die Frage nach der Entscheidungskompetenz.\"\\)\n\n# Perform all injections\ninjections = [\n    # Set 6\n    \\(\"tv6-1-q3\", q6_1_4 + ',\\\\n' + q6_1_5\\),\n    \\(\"tv6-2-q2\", q6_2_3 + ',\\\\n' + q6_2_4\\),\n    \\(\"tv6-3-q2\", q6_3_3 + ',\\\\n' + q6_3_4\\),\n    \\(\"tv6-4-q2\", q6_4_3 + ',\\\\n' + q6_4_4\\),\n    \\(\"tv6-5-q3\", q6_5_4\\),\n    # Set 7\n    \\(\"tv7-1-q3\", q7_1_4 + ',\\\\n' + q7_1_5\\),\n    \\(\"tv7-2-q2\", q7_2_3 + ',\\\\n' + q7_2_4\\),\n    \\(\"tv7-3-q2\", q7_3_3 + ',\\\\n' + q7_3_4\\),\n    \\(\"tv7-4-q2\", q7_4_3 + ',\\\\n' + q7_4_4\\),\n    \\(\"tv7-5-q3\", q7_5_4\\),\n    # Set 8\n    \\(\"tv8-1-q2\", q8_1_3 + ',\\\\n' + q8_1_4\\),\n    \\(\"tv8-2-q3\", q8_2_4\\),\n    \\(\"tv8-3-q2\", q8_3_3 + ',\\\\n' + q8_3_4\\),\n    \\(\"tv8-4-q3\", q8_4_4\\),\n    \\(\"tv8-5-q2\", q8_5_3 + ',\\\\n' + q8_5_4\\),\n    # Set 9\n    \\(\"tv9-1-q2\", q9_1_3 + ',\\\\n' + q9_1_4\\),\n    \\(\"tv9-2-q3\", q9_2_4\\),\n    \\(\"tv9-3-q2\", q9_3_3 + ',\\\\n' + q9_3_4\\),\n    \\(\"tv9-4-q3\", q9_4_4 + ',\\\\n' + q9_4_5\\),\n    \\(\"tv9-5-q2\", q9_5_3 + ',\\\\n' + q9_5_4\\),\n    # Set 10\n    \\(\"tv10-1-q2\", q10_1_3 + ',\\\\n' + q10_1_4\\),\n    \\(\"tv10-2-q2\", q10_2_3 + ',\\\\n' + q10_2_4\\),\n    \\(\"tv10-3-q2\", q10_3_3 + ',\\\\n' + q10_3_4\\),\n    \\(\"tv10-4-q3\", q10_4_4\\),\n    \\(\"tv10-5-q3\", q10_5_4\\),\n]\n\nfor last_id, new_qs in injections:\n    content = inject_after_last_question\\(content, last_id, new_qs\\)\n\nwith open\\('src/data/tvTextsExpanded2.ts', 'w'\\) as f:\n    f.write\\(content\\)\n\nprint\\(\"Done!\"\\)\n# Verify counts\nfor s in range\\(6, 11\\):\n    for t in range\\(1, 6\\):\n        count = content.count\\(f'\"tv{s}-{t}-q'\\)\n        print\\(f\"Set{s} Text{t}: {count} questions\"\\)\nPYEOF)",
      "Bash(git checkout HEAD -- src/data/tvTextsExpanded2.ts && python3 << 'PYEOF'\nimport re\n\nwith open\\('src/data/tvTextsExpanded2.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\ndef make_question\\(qid, question, options, correct_option, explanation\\):\n    opts = '\\\\n'.join\\(f'            \"{o}\",' for o in options\\)\n    return f'''        {{\n          id: \"{qid}\",\n          question: \"{question}\",\n          options: [\n{opts}\n          ],\n          correctOption: {correct_option},\n          explanation: \"{explanation}\",\n        }}'''\n\ndef inject_after_last_question\\(content, last_question_id, new_questions_str\\):\n    search = f'id: \"{last_question_id}\"'\n    idx = content.rfind\\(search\\)\n    if idx < 0:\n        print\\(f\"ERROR: Not found: {last_question_id}\"\\)\n        return content\n    close_pos = content.find\\('\\\\n        },', idx\\)\n    if close_pos < 0:\n        print\\(f\"ERROR: No close for {last_question_id}\"\\)\n        return content\n    close_pos += len\\('\\\\n        },'\\)\n    # Insert WITHOUT extra comma - the existing }, already has the comma\n    return content[:close_pos] + '\\\\n' + new_questions_str + content[close_pos:]\n\n# --- Set 6 ---\nq6_1_4 = make_question\\(\"tv6-1-q4\",\"Was ist die Hauptaussage des Textes über das Immunsystem?\",[\"Nur Antikörper und Killerzellen.\",\"Zweistufiges Netzwerk aus angeborenem und erworbenem System; Gedächtnis bildet Impfgrundlage.\",\"Kann durch Impfungen ersetzt werden.\",\"Angeborenes System ist überlegen.\",\"Autoimmunerkrankungen häufigste Folge.\"],1,\"Der Text beschreibt das Immunsystem als zweigeteiltes System und zeigt, wie das immunologische Gedächtnis die Grundlage von Impfungen bildet.\"\\)\nq6_1_5 = make_question\\(\"tv6-1-q5\",\"Welche Schlussfolgerung lässt sich über B-Lymphozyten und zytotoxische T-Zellen ziehen?\",[\"Beide gehören zum angeborenen System.\",\"Beide sind redundant.\",\"Ergänzen sich: B-Lymphozyten markieren, T-Zellen töten infizierte Zellen.\",\"T-Zellen von B-Zellen produziert.\",\"B-Zellen nur beim Erstkontakt aktiv.\"],2,\"B-Lymphozyten markieren Erreger mit Antikörpern; zytotoxische T-Zellen töten infizierte Körperzellen. Beide gehören zum erworbenen Immunsystem.\"\\)\nq6_2_3 = make_question\\(\"tv6-2-q3\",\"Was ist die Hauptaussage des Textes über Stammzellen?\",[\"Nur für Knochenmark.\",\"Einzigartige Fähigkeiten, großes Potenzial, viele Therapien noch in Erforschung.\",\"iPS-Zellen haben embryonale verdrängt.\",\"Hauptrisiko Abstoßungsreaktion.\",\"Adulte Stammzellen wichtiger.\"],1,\"Der Text stellt verschiedene Stammzelltypen vor und weist auf Risiken sowie den frühen Stand vieler Therapien hin.\"\\)\nq6_2_4 = make_question\\(\"tv6-2-q4\",\"Welche Schlussfolgerung lässt der Text zum Risiko der Stammzelltherapie zu?\",[\"Vollständig sicher.\",\"Einziges Risiko ist Ethik.\",\"Trotz Tierversuchen Risiko unkontrollierter Zellteilung; weitere Forschung nötig.\",\"iPS risikofrei.\",\"Tumor nur bei adulten Stammzellen.\"],2,\"Der Text warnt, dass das Risiko unkontrollierter Zellteilung sorgfältig erforscht werden muss.\"\\)\nq6_3_3 = make_question\\(\"tv6-3-q3\",\"Was ist laut dem Text die Hauptaussage über Prionenerkrankungen?\",[\"Selten und nur bei Rindern.\",\"Neuartiger Mechanismus, stets tödlich, lange Inkubationszeit erschwert Diagnose.\",\"Mit Antibiotika behandelbar.\",\"Hauptübertragbarkeit Tier zu Mensch.\",\"Prusiner sofort akzeptiert.\"],1,\"Der Text beschreibt den einzigartigen Mechanismus der Prionen und betont die lange Inkubationszeit.\"\\)\nq6_3_4 = make_question\\(\"tv6-3-q4\",\"Welche Schlussfolgerung lässt sich über die Ausbreitung von PrPSc im Gehirn ziehen?\",[\"Über Blutgefäße in alle Organe.\",\"PrPSc faltet gesunde Prion-Proteine um, selbstverstärkende Kettenreaktion.\",\"Immunsystem kann PrPSc eliminieren.\",\"Durch Nervenzellen aktiv transportiert.\",\"Ausbreitung verlangsamt sich ab kritischer Menge.\"],1,\"PrPSc faltet benachbarte normale Prion-Proteine um und löst eine selbstverstärkende Kettenreaktion aus.\"\\)\nq6_4_3 = make_question\\(\"tv6-4-q3\",\"Was ist die Hauptaussage des Textes zur Antibiotikaresistenz?\",[\"Gelöstes Problem.\",\"Globale Bedrohung durch unsachgemäßen Einsatz; ohne Gegenmaßnahmen drastisch zunehmend.\",\"Nur MRSA gefährlich.\",\"Antibiotika nicht mehr einsetzen.\",\"Nur Landwirtschaft Verursacher.\"],1,\"Der Text nennt Antibiotikaresistenz als globale Bedrohung.\"\\)\nq6_4_4 = make_question\\(\"tv6-4-q4\",\"Welche Schlussfolgerung lässt der Text zum Selektionsdruck durch Antibiotika zu?\",[\"Antibiotika töten alle Bakterien.\",\"Selektionsdruck begünstigt resistente Stämme, da empfindliche absterben und resistente sich vermehren.\",\"Resistente werden langfristig empfindlich.\",\"Nur in Landwirtschaft wirksam.\",\"Nur durch horizontalen Gentransfer.\"],1,\"Selektionsdruck begünstigt resistente Stämme: empfindliche sterben ab, resistente überleben.\"\\)\nq6_5_4 = make_question\\(\"tv6-5-q4\",\"Welche Schlussfolgerung lässt sich über den Einsatz von Ciclosporin ziehen?\",[\"Ciclosporin löst Abstoßung vollständig ohne Nebenwirkungen.\",\"Ciclosporin ermöglicht Transplantationen durch T-Lymphozyten-Hemmung, erfordert aber lebenslange Einnahme mit erhöhtem Infektions- und Krebsrisiko.\",\"Ciclosporin nur kurzfristig.\",\"Unterdrückt gesamtes Immunsystem.\",\"Bereits 1954 eingesetzt.\"],1,\"Ciclosporin unterdrückt die Abstoßung durch T-Lymphozyten-Hemmung, erfordert aber lebenslange Einnahme.\"\\)\n# --- Set 7 ---\nq7_1_4 = make_question\\(\"tv7-1-q4\",\"Was ist die Hauptaussage des Textes über die Photosynthese?\",[\"Nur Sauerstoffproduktion.\",\"Zweiphasiger Prozess; Faktoren wie Temperatur und CO2 beeinflussen Effizienz.\",\"RuBisCO wichtigstes Pigment.\",\"Nur C4 bei Hitze möglich.\",\"Chlorophyll a und b austauschbar.\"],1,\"Der Text beschreibt die Photosynthese als zweiphasigen Prozess.\"\\)\nq7_1_5 = make_question\\(\"tv7-1-q5\",\"Welche Schlussfolgerung lässt sich über den Vorteil der C4-Photosynthese ziehen?\",[\"C4 ohne Spaltöffnungen.\",\"C4 verzichtet auf Calvin-Zyklus.\",\"C4-Photosynthese ermöglicht effizientere CO2-Fixierung bei Hitze und umgeht Photosyntheserückgang durch Spaltöffnungsschluss.\",\"C4 mehr Sauerstoff ohne RuBisCO.\",\"C4 am effizientesten in gemäßigten Zonen.\"],2,\"C4-Pflanzen ermöglichen effizientere CO2-Fixierung bei Hitze.\"\\)\nq7_2_3 = make_question\\(\"tv7-2-q3\",\"Was ist die Hauptaussage des Textes zur Ozeanversäuerung?\",[\"Nur Korallenriffe betroffen.\",\"CO2-Aufnahme führt zur Versäuerung, bedroht marine Ökosysteme und menschliche Lebensgrundlage.\",\"Ozeane nehmen unbegrenzt CO2 auf.\",\"Kalkschalenbildner nicht gefährdet.\",\"Natürlicher Vorgang.\"],1,\"Der Text erklärt, wie CO2-Emissionen zur Versauerung führen, und betont die Bedrohung für marine Ökosysteme.\"\\)\nq7_2_4 = make_question\\(\"tv7-2-q4\",\"Welche Schlussfolgerung lässt sich über die doppelte Bedrohung von Korallenriffen ziehen?\",[\"Entweder Versäuerung oder Erwärmung, nie beide.\",\"Korallenbleiche weniger gefährlich.\",\"Korallenriffe durch Versäuerung und Meereswärmung gleichzeitig bedroht; gefährdet Lebensraum für ein Viertel mariner Arten.\",\"Nur tropisch oder polar betroffen.\",\"Korallen passen sich rasch an.\"],2,\"Korallenriffe sind durch Versäuerung und Meereswärmung gleichzeitig bedroht.\"\\)\nq7_3_3 = make_question\\(\"tv7-3-q3\",\"Was ist die Hauptaussage des Textes über Vulkanismus und Klima?\",[\"Hauptursache aktuellen Klimawandels.\",\"Kühlend durch Sulfataerosole kurzfristig, erwärmend durch CO2 langfristig, negativ auf Ozonschicht.\",\"CO2 wichtiger als Sulfataerosole.\",\"Tambora ohne Auswirkung.\",\"Sulfataerosole wirken jahrzehntelang.\"],1,\"Der Text beschreibt den kühlenden Sulfataerosol-Effekt und den negativen Einfluss auf die Ozonschicht.\"\\)\nq7_3_4 = make_question\\(\"tv7-3-q4\",\"Welche Schlussfolgerung lässt sich aus dem Vergleich von Tambora und Pinatubo ziehen?\",[\"Größere SO2-Mengen tendieren zu stärkerem Kühlungseffekt.\",\"Pinatubo stärker als Tambora.\",\"Beide ohne messbaren Einfluss.\",\"Tambora keine Hungersnot.\",\"Inselvulkane generell stärker.\"],0,\"Tambora setzte 60 Mio. Tonnen SO2 frei; Pinatubo 20 Mio. Größere SO2-Mengen tendieren zu stärkerem Kühlungseffekt.\"\\)\nq7_4_3 = make_question\\(\"tv7-4-q3\",\"Was ist die Hauptaussage des Textes über genetische Drift?\",[\"Drift ist dasselbe wie natürliche Selektion.\",\"Zufälliger Evolutionsmechanismus in kleinen Populationen; Gründer- und Flaschenhalseffekt führen zu Genverarmung.\",\"Nur in Inselpopulationen relevant.\",\"Begünstigt angepasste Allele.\",\"Flaschenhalseffekt einziger Mechanismus.\"],1,\"Genetische Drift ist ein zufälliger Mechanismus, stärker in kleinen Populationen.\"\\)\nq7_4_4 = make_question\\(\"tv7-4-q4\",\"Welche Schlussfolgerung lässt sich über die Krankheitsanfälligkeit der Geparden ziehen?\",[\"Körpergröße als Ursache.\",\"Geringe genetische Diversität durch Flaschenhals macht Geparden anfälliger und weniger anpassungsfähig.\",\"Bejagung veränderte Gene.\",\"Natürliche Selektion als Ursache.\",\"Nur anfällig für Viren.\"],1,\"Die geringe genetische Diversität der Geparden geht auf einen Flaschenhals zurück.\"\\)\nq7_5_4 = make_question\\(\"tv7-5-q4\",\"Welche Schlussfolgerung lässt sich über die ökologische Rolle von Parasiten ziehen?\",[\"Parasiten nur schädlich.\",\"Kein Einfluss auf Populationsdynamik.\",\"Trotz Schädigung des Wirts wichtig für Ökosysteme; regulieren Populationen und fördern Biodiversität.\",\"Parasitismus Übergangsform zwischen Kommensalismus und Mutualismus.\",\"Parasiten profitieren langfristig nicht.\"],2,\"Parasiten schaden dem Wirt, sind aber wichtige Bestandteile von Ökosystemen.\"\\)\n# --- Set 8 ---\nq8_1_3 = make_question\\(\"tv8-1-q3\",\"Welche Schlussfolgerung lässt sich über die Entfernung von Neurotransmittern ziehen?\",[\"Glutamat und GABA im Gleichgewicht.\",\"Alle Neurotransmitter werden nach Signal abgebaut.\",\"Neurotransmitter werden durch enzymatischen Abbau, Wiederaufnahme oder Diffusion entfernt.\",\"Serotonin reguliert die Wiederaufnahme aller Neurotransmitter.\",\"Aktionspotenzial wird in Vesikel gespeichert.\"],2,\"Drei Mechanismen: enzymatischer Abbau, Wiederaufnahme durch Transporterproteine und Diffusion.\"\\)\nq8_1_4 = make_question\\(\"tv8-1-q4\",\"Was ist die Hauptaussage des Textes über Neurotransmitter?\",[\"Einziges Problem ist GABA-Mangel.\",\"Neurotransmitter-Ungleichgewichte sind selten und klinisch irrelevant.\",\"Chemische Botenstoffe übertragen Signale an Synapsen; Ungleichgewichte führen zu neuropsychiatrischen Erkrankungen.\",\"Glutamat ist der einzige Neurotransmitter im Gehirn.\",\"Dopamin hat keine Auswirkungen auf Bewegung.\"],2,\"Neurotransmitter als chemische Botenstoffe an Synapsen; Ungleichgewichte führen zu Erkrankungen.\"\\)\nq8_2_4 = make_question\\(\"tv8-2-q4\",\"Welche Schlussfolgerung lässt sich über die Herausforderungen der CAR-T-Therapie ziehen?\",[\"CAR-T-Zellen sind vollkommen risikofrei.\",\"CAR-T-Therapie hat keine Nebenwirkungen.\",\"Die hohen Kosten und der Zytokinsturm sind zentrale Herausforderungen, die den breiten Einsatz begrenzen.\",\"CAR-T-Therapie wirkt nur bei festen Tumoren.\",\"CAR-T-Zellen werden nach der Therapie vom Körper abgebaut.\"],2,\"Der Text nennt Zytokinsturm und hohe Kosten als zentrale Herausforderungen.\"\\)\nq8_3_3 = make_question\\(\"tv8-3-q3\",\"Was ist die Hauptaussage des Textes über CRISPR-Cas9?\",[\"Doudna und Charpentier erfanden CRISPR als Waffe gegen Bakterien.\",\"CRISPR-Cas9 wurde 2020 erstmals an Pflanzen angewendet.\",\"CRISPR-Cas9 ist ein vielseitiges Genomwerkzeug aus einem bakteriellen Abwehrsystem mit Anwendungen in Landwirtschaft, Forschung und Medizin.\",\"CRISPR-Cas9 kann nur Gensequenzen löschen, nicht ersetzen.\",\"Keimbahnedierung ist weltweit erlaubt.\"],2,\"CRISPR-Cas9: natürliches bakterielles Immunsystem, zu universalem Genomwerkzeug umfunktioniert.\"\\)\nq8_3_4 = make_question\\(\"tv8-3-q4\",\"Welche Schlussfolgerung lässt sich über die Flexibilität von CRISPR-Cas9 ziehen?\",[\"Die Guide-RNA kann beliebige Zielsequenzen erkennen, weil Cas9 ohne sie nicht funktioniert.\",\"Da Cas9 die DNA an der Zielsequenz schneidet und zelleigene Reparaturmechanismen die Bearbeitung ermöglichen, lässt sich jedes Gen gezielt verändern.\",\"CRISPR funktioniert nur in Bakterienzellen.\",\"Die Guide-RNA ist immer identisch, unabhängig von der Zielsequenz.\",\"Cas9 kann nur DNA schneiden, nicht reparieren.\"],1,\"Guide-RNA synthetisch für jede Zielsequenz entwerfbar → universell einsetzbares Werkzeug.\"\\)\nq8_4_4 = make_question\\(\"tv8-4-q4\",\"Welche Schlussfolgerung lässt sich über die Bewertung von Sterbehilfe im Text ziehen?\",[\"Nur aktive Sterbehilfe ist ethisch problematisch.\",\"Alle Sterbehilfeformen sind weltweit verboten.\",\"Die rechtliche und ethische Bewertung von aktiver und passiver Sterbehilfe unterscheidet sich erheblich zwischen Ländern und Kulturen.\",\"Palliativmedizin und Sterbehilfe sind identisch.\",\"Der Arzt entscheidet allein über Sterbehilfe.\"],2,\"Bewertung von Sterbehilfe variiert erheblich zwischen Ländern, was globale Standards erschwert.\"\\)\nq8_5_3 = make_question\\(\"tv8-5-q3\",\"Was ist die Hauptaussage des Textes über die forensische Medizin?\",[\"Forensische Medizin ist ausschließlich für Mordermittlungen zuständig.\",\"Genetischer Fingerabdruck ist seit 1970 in Verwendung.\",\"Forensische Medizin wendet medizinisches Wissen auf rechtliche Fragen an; DNA-Analyse ermöglicht eindeutige Identifikation, wirft aber Datenschutzfragen auf.\",\"Totenflecke entstehen durch chemische Reaktionen, nicht durch Blutabsinken.\",\"Die Obduktion ist in Österreich verboten.\"],2,\"Forensische Medizin verbindet medizinisches Wissen mit rechtlichen Aufgaben.\"\\)\nq8_5_4 = make_question\\(\"tv8-5-q4\",\"Welche Schlussfolgerung lässt sich über Totenflecke als Todeszeitindikator ziehen?\",[\"Totenflecke fixieren sich sofort nach dem Tod.\",\"Totenflecke entstehen durch Blutabsinken, sind anfänglich wegdrückbar und fixieren sich nach 12-24 Stunden.\",\"Totenflecke sind dauerhaft wegdrückbar.\",\"Totenflecke entstehen nur bei Kälte.\",\"Totenflecke und Totenstarre treten gleichzeitig auf.\"],1,\"Totenflecke fixieren sich nach 12-24 Stunden. Nützlicher Zeitindikator, aber kein präzises Instrument.\"\\)\n# --- Set 9 ---\nq9_1_3 = make_question\\(\"tv9-1-q3\",\"Was ist die Hauptaussage des Textes über Klimawandel und menschliche Gesundheit?\",[\"Klimawandel betrifft nur tropische Regionen.\",\"Nur Hitzewellen sind relevant.\",\"Der Klimawandel gefährdet die Gesundheit direkt durch Hitzestress und indirekt durch Ausbreitung von Krankheiten, Luftqualitätsverschlechterung und psychische Folgen.\",\"Klimawandel hat keine Auswirkungen auf Infektionskrankheiten.\",\"Nur ältere Menschen sind durch Klimawandel gefährdet.\"],2,\"Der Text beschreibt direkte Auswirkungen wie Hitzestress und indirekte wie Ausbreitung von Vektoren.\"\\)\nq9_1_4 = make_question\\(\"tv9-1-q4\",\"Welche Schlussfolgerung lässt sich über die Ausbreitung von Tropenkrankheiten durch den Klimawandel ziehen?\",[\"Dengue-Fieber ist in Europa endemisch.\",\"Die Tigermücke überträgt nur Malaria.\",\"Weil erwärmte Regionen für Wärme-liebende Vektoren wie die Tigermücke geeignet werden, breiten sich Tropenkrankheiten in neue Gebiete aus.\",\"Dengue-Fieber wird nur durch direkte Berührung übertragen.\",\"Nur Malaria wird durch Klimawandel beeinflusst.\"],2,\"Erwärmung macht neue Gebiete für die Tigermücke geeignet.\"\\)\nq9_2_4 = make_question\\(\"tv9-2-q4\",\"Was ist die Hauptaussage des Textes über Pandemien und ihre Bekämpfung?\",[\"Die Spanische Grippe betraf nur ältere Menschen.\",\"Pandemien sind durch moderne Medizin vollständig vermeidbar.\",\"Pandemien werden durch Zoonosen wahrscheinlicher; Ungleichheiten bei Impfstoffverteilung und Fehlinformationen erschwerten die COVID-19-Bekämpfung.\",\"mRNA-Impfstoffe sind die einzige wirksame Schutzmaßnahme.\",\"Der Schwarze Tod hatte keine sozialen Folgen.\"],2,\"Pandemien werden durch Zoonosen wahrscheinlicher; Ungleichheiten bei Impfstoffverteilung sind zentrale Hindernisse.\"\\)\nq9_3_3 = make_question\\(\"tv9-3-q3\",\"Was ist die Hauptaussage des Textes über die Psychoneuroimmunologie?\",[\"PNI untersucht nur die Auswirkungen von Stress auf Verdauung.\",\"PNI hat keine klinische Relevanz.\",\"PNI belegt, dass Psyche, Nervensystem und Immunsystem eng verbunden sind; positive Interventionen können das Immunsystem verbessern.\",\"Chronischer Stress stärkt das Immunsystem.\",\"Das Immunsystem ist vollständig autonom.\"],2,\"PNI belegt die wechselseitige Verbindung von Psyche, Nervensystem und Immunsystem.\"\\)\nq9_3_4 = make_question\\(\"tv9-3-q4\",\"Welche Schlussfolgerung lässt sich über die Behandlung stressbedingter Immunschwäche ziehen?\",[\"Nur Cortisol vermittelt Stress-Immunverbindung.\",\"Chronischer Stress hat keinen Einfluss auf Impfansprechen.\",\"Da chronischer Stress über HPA-Achse und autonomes Nervensystem das Immunsystem schwächt, ist ein ganzheitlicher Behandlungsansatz sinnvoll.\",\"Achtsamkeit hat keinen Einfluss auf das Immunsystem.\",\"Das autonome Nervensystem ist nicht mit lymphatischen Organen verbunden.\"],2,\"Da Stress das Immunsystem schwächt, sprechen PNI-Erkenntnisse für ganzheitliche Behandlungsansätze.\"\\)\nq9_4_4 = make_question\\(\"tv9-4-q4\",\"Was ist die Hauptaussage des Textes über die Nanomedizin?\",[\"Nanomedizin ist ausschließlich für Diagnostik.\",\"Nanopartikel sind vollkommen sicher.\",\"Nanomedizin nutzt Nanoskala-Eigenschaften für gezieltes Drug Delivery und verbesserte Diagnostik, birgt aber noch nicht vollständig verstandene Toxizitätsrisiken.\",\"EPR-Effekt betrifft nur gesundes Gewebe.\",\"Nanopartikel werden sofort vom Körper ausgeschieden.\"],2,\"Nanomedizin nutzt Nanoskala-Eigenschaften; Toxizitätsrisiken noch nicht vollständig verstanden.\"\\)\nq9_4_5 = make_question\\(\"tv9-4-q5\",\"Welche Schlussfolgerung lässt sich über die Zielgerichtetheit von Nanopartikeln in der Krebstherapie ziehen?\",[\"Ligandfunktionalisierung ist bei Nanopartikeln unwirksam.\",\"Nanopartikel können nicht in Tumorgewebe eindringen.\",\"Da Nanopartikel durch den EPR-Effekt in Tumorgewebe angereichert werden und mit Liganden funktionalisiert werden können, ergibt sich eine zweistufige Zielgerichtetheit.\",\"EPR-Effekt betrifft alle Gewebe gleich.\",\"Liganden erhöhen die Toxizität der Nanopartikel.\"],2,\"EPR-Effekt \\(passiv\\) + Ligand-Funktionalisierung \\(aktiv\\) = zweistufige Zielgerichtetheit.\"\\)\nq9_5_3 = make_question\\(\"tv9-5-q3\",\"Was ist die Hauptaussage des Textes über die Neurobiologie der Abhängigkeit?\",[\"Sucht ist eine Frage mangelnder Willenskraft.\",\"Sucht betrifft nur das Dopaminsystem.\",\"Sucht ist eine chronische Hirnerkrankung; neuroadaptive Veränderungen in Belohnungssystem und präfrontalem Kortex erklären den Kontrollverlust.\",\"Sucht kann allein durch Medikamente geheilt werden.\",\"Das mesolimbische System ist nicht an Sucht beteiligt.\"],2,\"Sucht ist eine chronische Hirnerkrankung; neuroadaptive Veränderungen erklären Kontrollverlust.\"\\)\nq9_5_4 = make_question\\(\"tv9-5-q4\",\"Welche Schlussfolgerung lässt sich über den Wirkmechanismus von Alkohol und Opiaten im Vergleich zu Kokain ziehen?\",[\"Alkohol blockiert die Dopamin-Wiederaufnahme wie Kokain.\",\"Opioide steigern direkt die Dopaminfreisetzung aus Vesikeln.\",\"Da Alkohol und Opioide hemmende Interneuronen unterdrücken, wirken sie indirekt; ihre Wirkweise unterscheidet sich von direkter Dopaminbeeinflussung durch Kokain oder Amphetamine.\",\"Alle Suchtmittel wirken durch denselben Mechanismus.\",\"Alkohol hat keine Wirkung auf das mesolimbische System.\"],2,\"Alkohol und Opioide wirken indirekt; Kokain blockiert Dopamin-Wiederaufnahme direkt.\"\\)\n# --- Set 10 ---\nq10_1_3 = make_question\\(\"tv10-1-q3\",\"Was ist die Hauptaussage des Textes über die evolutionäre Medizin?\",[\"Evolutionäre Medizin sieht Krankheiten als unvermeidlich.\",\"Evolutionäre Medizin lehnt jede Behandlung ab.\",\"Evolutionäre Medizin erklärt Krankheiten als evolutionsgepraegtes Phänomen; Symptome wie Fieber können adaptiv sein und das heterozygote Sichelzellgen bietet Malariaschutz.\",\"Fieber sollte immer unterdrückt werden.\",\"Das Sichelzellgen ist global gleichmäßig verbreitet.\"],2,\"Mismatch-Hypothese, adaptive Funktion von Fieber und Malariaschutz des Sichelzellgens.\"\\)\nq10_1_4 = make_question\\(\"tv10-1-q4\",\"Welche Schlussfolgerung lässt sich über die Behandlung von Fieber aus dem Text ziehen?\",[\"Fieber ist grundsätzlich gefährlich und sollte immer behandelt werden.\",\"Unterdrückung von Fieber reduziert Sterblichkeit bei Infektionen.\",\"Da Fieber bei bestimmten Infektionen die Sterblichkeit bei Unterdrückung erhöhen kann, spricht der Text für eine differenzierte statt automatische Fieberbehandlung.\",\"Fieber hat keine messbaren Vorteile.\",\"Fieber ist ausschließlich ein Nebenprodukt der Infektion.\"],2,\"Fieberunterdrückung kann Sterblichkeit erhöhen → differenzierte Behandlung sinnvoll.\"\\)\nq10_2_3 = make_question\\(\"tv10-2-q3\",\"Was ist die Hauptaussage des Textes über künstliche Organe und Bioprinting?\",[\"Bioprinting kann bereits komplexe Organe vollständig ersetzen.\",\"Dialyse ist keine Form des künstlichen Organersatzes.\",\"Mechanische Systeme wie Dialyse und VADs existieren bereits; Bioprinting bietet Zukunftspotenzial, scheitert aber noch an der Vaskularisierung.\",\"VADs erzeugen einen normalen Herzrhythmus.\",\"Künstliche Organe sind günstiger als Transplantate.\"],2,\"Mechanische Ersatzsysteme existieren; Bioprinting scheitert noch an der Vaskularisierung.\"\\)\nq10_2_4 = make_question\\(\"tv10-2-q4\",\"Welche Schlussfolgerung lässt sich über die Bedeutung der Vaskularisierung für das Bioprinting ziehen?\",[\"Zellen können unbegrenzt weit von Blutgefäßen entfernt überleben.\",\"Wachstumsfaktoren sind für Bioprinting irrelevant.\",\"Da Zellen mehr als 200 Mikrometer von Blutgefäßen absterben, ist die Lösung des Vaskularisierungsproblems entscheidend für das Bioprinting komplexer Organe.\",\"Hydrogel ersetzt die Funktion von Blutgefäßen.\",\"Bioprinting-Organe benötigen keine Vaskularisierung.\"],2,\"Vaskularisierung ist die entscheidende Hürde für das Bioprinting funktionaler komplexer Organe.\"\\)\nq10_3_3 = make_question\\(\"tv10-3-q3\",\"Was ist die Hauptaussage des Textes über die Gentherapie?\",[\"Gentherapie ist bereits vollständig sicher und breit verfügbar.\",\"Gentherapie behandelt nur Bluterkrankungen.\",\"Gentherapie korrigiert genetische Defekte mithilfe viraler Vektoren; zugelassene Therapien zeigen beeindruckende Ergebnisse, sind aber oft extrem teuer.\",\"Gentherapie ersetzt alle anderen Behandlungsformen.\",\"AAV-Vektoren integrieren sich ins menschliche Genom.\"],2,\"Gentherapie korrigiert Defekte durch virale Vektoren; beeindruckende Ergebnisse, aber hohe Kosten.\"\\)\nq10_3_4 = make_question\\(\"tv10-3-q4\",\"Welche Schlussfolgerung lässt sich aus dem Beispiel Zolgensma über Gentherapie ziehen?\",[\"Da Zolgensma über 2 Mio. USD kostet, können nicht alle Patienten auf lebensrettende Gentherapien zugreifen, was die Frage der Verteilungsgerechtigkeit aufwirft.\",\"Zolgensma ist weltweit kostenlos verfügbar.\",\"Nur reiche Länder entwickeln Gentherapien.\",\"Die hohen Kosten sind durch die Wirksamkeit gerechtfertigt und kein Problem.\",\"Alle Gentherapien sind gleich teuer.\"],0,\"Zolgensma kostet über 2 Mio. USD → Fragen der Zugangsgerechtigkeit.\"\\)\nq10_4_4 = make_question\\(\"tv10-4-q4\",\"Welche Schlussfolgerung lässt sich aus dem Text über die begrenzte CPAP-Akzeptanz ziehen?\",[\"CPAP ist nur für leichte Schlafapnoe geeignet.\",\"Schlafapnoe hat keine langfristigen Herzfolgen.\",\"Da CPAP bei 50-70% der Patienten akzeptiert wird, sind alternative Therapien wie Schienen oder Operationen wichtig, um alle Patienten zu erreichen.\",\"Schienen ersetzen CPAP vollständig.\",\"Schlafapnoe kann nur operativ behandelt werden.\"],2,\"Da nur 50-70% CPAP akzeptieren, sind alternative Therapien wichtig.\"\\)\nq10_5_4 = make_question\\(\"tv10-5-q4\",\"Welche Schlussfolgerung lässt sich über die ethische Problematik der Tiefen Hirnstimulation ziehen?\",[\"Tiefe Hirnstimulation ist vollkommen risikolos.\",\"Persönlichkeit ändert sich nie durch medizinische Behandlung.\",\"Da Tiefe Hirnstimulation die Persönlichkeit verändern kann, stellt sich die Frage, ob der Patient nach dem Eingriff noch seine ursprüngliche Zustimmung aufrechterhalten kann.\",\"Tiefe Hirnstimulation hat keinerlei Einfluss auf die Psyche.\",\"Persönlichkeitsveränderungen sind erwartete und erwünschte Nebenwirkungen.\"],2,\"Tiefe Hirnstimulation kann Persönlichkeit verändern → Frage nach Entscheidungskompetenz nach dem Eingriff.\"\\)\n\ninjections = [\n    \\(\"tv6-1-q3\", q6_1_4 + ',\\\\n' + q6_1_5\\),\n    \\(\"tv6-2-q2\", q6_2_3 + ',\\\\n' + q6_2_4\\),\n    \\(\"tv6-3-q2\", q6_3_3 + ',\\\\n' + q6_3_4\\),\n    \\(\"tv6-4-q2\", q6_4_3 + ',\\\\n' + q6_4_4\\),\n    \\(\"tv6-5-q3\", q6_5_4\\),\n    \\(\"tv7-1-q3\", q7_1_4 + ',\\\\n' + q7_1_5\\),\n    \\(\"tv7-2-q2\", q7_2_3 + ',\\\\n' + q7_2_4\\),\n    \\(\"tv7-3-q2\", q7_3_3 + ',\\\\n' + q7_3_4\\),\n    \\(\"tv7-4-q2\", q7_4_3 + ',\\\\n' + q7_4_4\\),\n    \\(\"tv7-5-q3\", q7_5_4\\),\n    \\(\"tv8-1-q2\", q8_1_3 + ',\\\\n' + q8_1_4\\),\n    \\(\"tv8-2-q3\", q8_2_4\\),\n    \\(\"tv8-3-q2\", q8_3_3 + ',\\\\n' + q8_3_4\\),\n    \\(\"tv8-4-q3\", q8_4_4\\),\n    \\(\"tv8-5-q2\", q8_5_3 + ',\\\\n' + q8_5_4\\),\n    \\(\"tv9-1-q2\", q9_1_3 + ',\\\\n' + q9_1_4\\),\n    \\(\"tv9-2-q3\", q9_2_4\\),\n    \\(\"tv9-3-q2\", q9_3_3 + ',\\\\n' + q9_3_4\\),\n    \\(\"tv9-4-q3\", q9_4_4 + ',\\\\n' + q9_4_5\\),\n    \\(\"tv9-5-q2\", q9_5_3 + ',\\\\n' + q9_5_4\\),\n    \\(\"tv10-1-q2\", q10_1_3 + ',\\\\n' + q10_1_4\\),\n    \\(\"tv10-2-q2\", q10_2_3 + ',\\\\n' + q10_2_4\\),\n    \\(\"tv10-3-q2\", q10_3_3 + ',\\\\n' + q10_3_4\\),\n    \\(\"tv10-4-q3\", q10_4_4\\),\n    \\(\"tv10-5-q3\", q10_5_4\\),\n]\n\nfor last_id, new_qs in injections:\n    content = inject_after_last_question\\(content, last_id, new_qs\\)\n\nwith open\\('src/data/tvTextsExpanded2.ts', 'w'\\) as f:\n    f.write\\(content\\)\n\nprint\\(\"Done!\"\\)\nfor s in range\\(6, 11\\):\n    for t in range\\(1, 6\\):\n        count = content.count\\(f'\"tv{s}-{t}-q'\\)\n        print\\(f\"Set{s} Text{t}: {count}\"\\)\nPYEOF)",
      "Bash(git add src/data/tvTextsExpanded.ts src/data/tvTextsExpanded2.ts scripts/gen_tv_improved.mjs && git commit -m \"$\\(cat <<'EOF'\nfeat\\(tv\\): expand all 50 TV texts to 4-5 questions each \\(sets 1-10\\)\n\n- Sets 1-5 \\(tvTextsExpanded.ts\\): all 25 texts now have exactly 5 questions → 125 total\n- Sets 6-10 \\(tvTextsExpanded2.ts\\): all 25 texts expanded from 2-3 to 4-5 questions → ~100 total\n- Total TV question bank: ~225 questions \\(up from ~75\\)\nEOF\n\\)\")",
      "Bash(# Extract just the actual content text \\(section.content strings\\) from BMS files\npython3 - <<'EOF'\nimport os, re, json\n\ntotal_chars = 0\nfile_counts = {}\n\ndirs = [\n    \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie\",\n    \"/Users/Luki/medmaster/src/data/bmsKapitel/chemie\",\n    \"/Users/Luki/medmaster/src/data/bmsKapitel/physik\",\n    \"/Users/Luki/medmaster/src/data/bmsKapitel/mathematik\",\n]\n\nfor d in dirs:\n    subject = d.split\\(\"/\"\\)[-1]\n    chars = 0\n    files = [f for f in os.listdir\\(d\\) if f.endswith\\(\".ts\"\\) and f != \"index.ts\" and f != \"colors.ts\"]\n    for f in files:\n        with open\\(os.path.join\\(d, f\\), \"r\", encoding=\"utf-8\"\\) as fp:\n            content = fp.read\\(\\)\n        # Count text inside content: \"...\" strings\n        strings = re.findall\\(r'content:\\\\s*\"\\(\\(?:[^\"\\\\\\\\]|\\\\\\\\.\\)*\\)\"', content\\)\n        for s in strings:\n            chars += len\\(s\\)\n        # Also count multi-line template literals for content\n        ml_strings = re.findall\\(r'content:\\\\s*`\\(\\(?:[^`\\\\\\\\]|\\\\\\\\.\\)*\\)`', content, re.DOTALL\\)\n        for s in ml_strings:\n            chars += len\\(s\\)\n    file_counts[subject] = chars\n    total_chars += chars\n    print\\(f\"{subject}: {chars:,} chars in content fields\"\\)\n\nprint\\(f\"\\\\nTOTAL BMS content: {total_chars:,} chars \\({total_chars/1000:.0f}k\\)\"\\)\nEOF)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\n\nfunction analyzeFile\\(path, subject\\) {\n  const content = fs.readFileSync\\(path, 'utf8'\\);\n  const charCount = content.length;\n  \n  // Count sections per UK\n  const ukMatches = content.match\\(/id:\\\\s*\\\\\"\\(bio|ch|ph|ma\\)-\\\\d/g\\) || [];\n  const sectionMatches = content.match\\(/heading:\\\\s*\\\\\"/g\\) || [];\n  const merksatzMatches = content.match\\(/merksatz:/g\\) || [];\n  const selfTestMatches = content.match\\(/selfTest:/g\\) || [];\n  const lernzieleMatches = content.match\\(/lernziele:/g\\) || [];\n  const klinMatches = content.match\\(/klinischerBezug:/g\\) || [];\n  const altfrageMatches = content.match\\(/altfrage:/g\\) || [];\n  \n  // Get question counts in selfTest\n  const selfTestBlocks = content.split\\('selfTest:'\\);\n  let totalSelfTestQ = 0;\n  for \\(let i = 1; i < selfTestBlocks.length; i++\\) {\n    const block = selfTestBlocks[i];\n    const bracket = block.indexOf\\(']'\\);\n    const sub = block.substring\\(0, bracket\\);\n    const qs = \\(sub.match\\(/question:/g\\) || []\\).length;\n    totalSelfTestQ += qs;\n  }\n\n  console.log\\(path.split\\('/'\\).pop\\(\\)\\);\n  console.log\\('  Bytes:', charCount.toLocaleString\\(\\)\\);\n  console.log\\('  UK \\(Unterkapitel\\):', ukMatches.length\\);\n  console.log\\('  Sections \\(headings\\):', sectionMatches.length\\);\n  console.log\\('  Merksätze:', merksatzMatches.length\\);\n  console.log\\('  SelfTest-Blöcke:', selfTestMatches.length, '| Total Fragen:', totalSelfTestQ\\);\n  console.log\\('  Lernziele-Blöcke:', lernzieleMatches.length\\);\n  console.log\\('  KlinischerBezug:', klinMatches.length\\);\n  console.log\\('  Altfragen:', altfrageMatches.length\\);\n  if \\(ukMatches.length > 0\\) {\n    console.log\\('  ∅ Zeichen/UK:', Math.round\\(charCount / ukMatches.length\\).toLocaleString\\(\\)\\);\n    console.log\\('  ∅ Fragen/UK:', \\(totalSelfTestQ / ukMatches.length\\).toFixed\\(1\\)\\);\n    console.log\\('  ∅ Sections/UK:', \\(sectionMatches.length / ukMatches.length\\).toFixed\\(1\\)\\);\n  }\n  console.log\\(''\\);\n}\n\nconst subjects = {\n  biologie: ['kap1-die-zelle.ts', 'kap2-anatomie-gewebe-physiologie.ts', 'kap3-entwicklung-evolution.ts', 'kap4-genetik.ts', 'kap5-oekologie-immunologie.ts'],\n  chemie: ['kap1-atombau-periodensystem.ts', 'kap2-materie-und-zustaende.ts', 'kap4-reaktionen-gleichgewicht.ts', 'kap5-anorganische-chemie.ts', 'kap6-chemische-bindung.ts', 'kap6-organische-chemie.ts'],\n  physik: ['kap1-mechanik-grundlagen.ts', 'kap3-schwingungen-und-wellen.ts', 'kap4-elektrizitaet-optik.ts', 'kap4-waermelehre.ts', 'kap7-atomphysik.ts'],\n  mathematik: ['kap1-zahlen-einheiten.ts', 'kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap6-vektorrechnung.ts', 'kap7-stochastik.ts']\n};\n\nfor \\(const [sub, files] of Object.entries\\(subjects\\)\\) {\n  console.log\\('======', sub.toUpperCase\\(\\), '======'\\);\n  for \\(const f of files\\) {\n    analyzeFile\\('src/data/bmsKapitel/' + sub + '/' + f, sub\\);\n  }\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\n\n// Get all UK titles per file\nfunction getTitles\\(path\\) {\n  const content = fs.readFileSync\\(path, 'utf8'\\);\n  const titles = [];\n  const regex = /title:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"],/g;\n  let m;\n  while \\(\\(m = regex.exec\\(content\\)\\) !== null\\) {\n    titles.push\\(m[1]\\);\n  }\n  return titles;\n}\n\nconst subjects = {\n  biologie: ['kap1-die-zelle.ts', 'kap2-anatomie-gewebe-physiologie.ts', 'kap3-entwicklung-evolution.ts', 'kap4-genetik.ts', 'kap5-oekologie-immunologie.ts'],\n  chemie: ['kap1-atombau-periodensystem.ts', 'kap2-materie-und-zustaende.ts', 'kap4-reaktionen-gleichgewicht.ts', 'kap5-anorganische-chemie.ts', 'kap6-chemische-bindung.ts', 'kap6-organische-chemie.ts'],\n  physik: ['kap1-mechanik-grundlagen.ts', 'kap3-schwingungen-und-wellen.ts', 'kap4-elektrizitaet-optik.ts', 'kap4-waermelehre.ts', 'kap7-atomphysik.ts'],\n  mathematik: ['kap1-zahlen-einheiten.ts', 'kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap6-vektorrechnung.ts', 'kap7-stochastik.ts']\n};\n\nfor \\(const [sub, files] of Object.entries\\(subjects\\)\\) {\n  console.log\\(''\\);\n  console.log\\('=== ' + sub.toUpperCase\\(\\) + ' ==='\\);\n  for \\(const f of files\\) {\n    const path = 'src/data/bmsKapitel/' + sub + '/' + f;\n    const titles = getTitles\\(path\\);\n    console.log\\('  ' + f.replace\\('.ts',''\\) + ':'\\);\n    titles.forEach\\(\\(t, i\\) => console.log\\('    ' + \\(i+1\\) + '. ' + t\\)\\);\n  }\n}\n\")",
      "Bash(cat > /tmp/analyze.sh << 'EOF'\n#!/bin/bash\nFILE=$1\necho \"Analyzing: $\\(basename $FILE\\)\"\necho \"Total file size: $\\(wc -c < $FILE\\) bytes\"\necho \"Unterkapitel count \\(title:\\): $\\(grep -c 'title:' $FILE\\)\"\necho \"Has content field: $\\(grep -c 'content:' $FILE\\)\"\necho \"Has sections: $\\(grep -c 'sections:' $FILE\\)\"\necho \"Has merksätze: $\\(grep -c 'merksätze:' $FILE || echo 0\\)\"\necho \"Has lernziele: $\\(grep -c 'lernziele:' $FILE\\)\"\necho \"Has klinischerBezug: $\\(grep -c 'klinischerBezug:' $FILE\\)\"\necho \"Has altfrage: $\\(grep -c 'altfrage:' $FILE\\)\"\necho \"Has selfTest: $\\(grep -c 'selfTest:' $FILE\\)\"\necho \"\"\nEOF\nchmod +x /tmp/analyze.sh)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nlet content = fs.readFileSync\\('src/data/tvTextsExpanded.ts', 'utf8'\\);\n\n// Fix tv1-t2-q4 \\(Dunkle Materie → Seidenstraße Religionen\\)\nconst old_q4_t2 = content.slice\\(content.indexOf\\('          id: \\\\\"tv1-t2-q4\\\\\"'\\), content.indexOf\\('          id: \\\\\"tv1-t2-q5\\\\\"'\\)\\);\nconst new_q4_t2 = \\\\`          id: \\\\\"tv1-t2-q4\\\\\",\n          question: \\\\\"Welche Religionen verbreiteten sich laut Text über die Seidenstraße?\\\\\",\n          options: [\n            \\\\\"Christentum und Judentum\\\\\",\n            \\\\\"Hinduismus und Zoroastrismus\\\\\",\n            \\\\\"Nur der Buddhismus von Indien nach China\\\\\",\n            \\\\\"Der Buddhismus von Indien nach China und Zentralasien sowie der Islam\\\\\",\n            \\\\\"Keine – die Route war rein wirtschaftlich\\\\\",\n          ],\n          correctOption: 3,\n          explanation:\n            \\\\\"Der Text nennt den Buddhismus \\(Indien→China/Zentralasien\\) und den Islam.\\\\\",\n        },\n        {\\\\n\\\\`;\n\ncontent = content.replace\\(old_q4_t2, new_q4_t2\\);\n\n// Check the replacement worked\nconst checkIdx = content.indexOf\\('tv1-t2-q4'\\);\nconsole.log\\('tv1-t2-q4 new content:', content.slice\\(checkIdx, checkIdx + 200\\)\\);\n\" 2>&1 | head -30)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nlet content = fs.readFileSync\\('src/data/tvTextsExpanded.ts', 'utf8'\\);\n\n// Fix tv1-t2-q4 \\(Dunkle Materie → Seidenstraße Religionen\\)\nconst start_q4_t2 = content.indexOf\\('          id: \\\\\"tv1-t2-q4\\\\\"'\\);\nconst start_q4_t2_end = content.indexOf\\('          id: \\\\\"tv1-t2-q5\\\\\"'\\);\nconst old_q4_t2 = content.slice\\(start_q4_t2, start_q4_t2_end\\);\nconst new_q4_t2 = \\\\`          id: \\\\\"tv1-t2-q4\\\\\",\n          question: \\\\\"Welche Religionen verbreiteten sich laut Text über die Seidenstraße?\\\\\",\n          options: [\n            \\\\\"Christentum und Judentum\\\\\",\n            \\\\\"Hinduismus und Zoroastrismus\\\\\",\n            \\\\\"Nur der Buddhismus von Indien nach China\\\\\",\n            \\\\\"Der Buddhismus von Indien nach China und Zentralasien sowie der Islam\\\\\",\n            \\\\\"Keine \\\\\\\\u2013 die Route war rein wirtschaftlich\\\\\",\n          ],\n          correctOption: 3,\n          explanation:\n            \\\\\"Der Text nennt den Buddhismus \\(Indien\\\\\\\\u2192China/Zentralasien\\) und den Islam.\\\\\",\n        },\n        {\\\\`;\ncontent = content.replace\\(old_q4_t2, new_q4_t2\\);\n\n// Fix tv1-t2-q5 \\(Dunkle Materie Anteil → Seidenstraße negative Rolle / Pest\\)\nconst start_q5_t2 = content.indexOf\\('          id: \\\\\"tv1-t2-q5\\\\\"'\\);\nconst end_q5_t2 = content.indexOf\\('      ],\\\\n    },\\\\n    {\\\\n      id: \\\\\"tv1-text3\\\\\"'\\);\nconst old_q5_t2 = content.slice\\(start_q5_t2, end_q5_t2\\);\nconst new_q5_t2 = \\\\`          id: \\\\\"tv1-t2-q5\\\\\",\n          question: \\\\\"Welche negative Rolle spielte die Seidenstraße laut Text außer dem Handel?\\\\\",\n          options: [\n            \\\\\"Sie verursachte politische Kriege zwischen Ost und West\\\\\",\n            \\\\\"Sie führte zur Verbreitung von Krankheitserregern, darunter mutmaßlich die Pest im 14. Jahrhundert\\\\\",\n            \\\\\"Sie schwächte die Wirtschaft der Anrainerstaaten\\\\\",\n            \\\\\"Sie verhinderte technologischen Fortschritt durch Handelsmonopole\\\\\",\n            \\\\\"Sie verbreitete ausschließlich religiöse Konflikte\\\\\",\n          ],\n          correctOption: 1,\n          explanation:\n            \\\\\"Der Text: \\\\\\\\u201EKrankheitserreger reisten ebenfalls entlang dieser Routen \\\\\\\\u2013 die Pest gelangte vermutlich über Handelswege aus Zentralasien nach Europa.\\\\\\\\u201C\\\\\",\n        },\n      \\\\`];\ncontent = content.replace\\(old_q5_t2, new_q5_t2\\);\n\n// Fix tv1-t3-q3 \\(CRISPR Funktionsweise → Kaffeehauskultur Berühmtheiten\\)\nconst start_q3_t3 = content.indexOf\\('          id: \\\\\"tv1-t3-q3\\\\\"'\\);\nconst start_q4_t3 = content.indexOf\\('          id: \\\\\"tv1-t3-q4\\\\\"'\\);\nconst old_q3_t3 = content.slice\\(start_q3_t3, start_q4_t3\\);\nconst new_q3_t3 = \\\\`          id: \\\\\"tv1-t3-q3\\\\\",\n          question: \\\\\"Welche berühmten Persönlichkeiten nennt der Text als regelmäßige Kaffeehausgäste?\\\\\",\n          options: [\n            \\\\\"Mozart, Beethoven und Schubert\\\\\",\n            \\\\\"Karl der Große, Maria Theresia und Joseph II\\\\\",\n            \\\\\"Sigmund Freud, Arthur Schnitzler und Stefan Zweig\\\\\",\n            \\\\\"Adolf Loos, Gustav Klimt und Egon Schiele\\\\\",\n            \\\\\"Karl Lueger, Victor Adler und Georg von Schönerer\\\\\",\n          ],\n          correctOption: 2,\n          explanation:\n            \\\\\"Der Text nennt Sigmund Freud, Arthur Schnitzler und Stefan Zweig.\\\\\",\n        },\n        {\\\\`;\ncontent = content.replace\\(old_q3_t3, new_q3_t3\\);\n\n// Fix tv1-t3-q4 \\(CRISPR Anwendung → Kaffeehausatmosphäre\\)\nconst start_q4_t3_new = content.indexOf\\('          id: \\\\\"tv1-t3-q4\\\\\"'\\);\nconst start_q5_t3 = content.indexOf\\('          id: \\\\\"tv1-t3-q5\\\\\"'\\);\nconst old_q4_t3 = content.slice\\(start_q4_t3_new, start_q5_t3\\);\nconst new_q4_t3 = \\\\`          id: \\\\\"tv1-t3-q4\\\\\",\n          question: \\\\\"Was zeichnet laut Text die Atmosphäre des Wiener Kaffeehauses aus?\\\\\",\n          options: [\n            \\\\\"Schnelle Bedienung und günstige Preise\\\\\",\n            \\\\\"Marmortische, Thonet-Stühle, Zeitungsständer und die Erlaubnis, stundenlang zu verweilen\\\\\",\n            \\\\\"Laute Musik und ein lebhaftes Nachtleben\\\\\",\n            \\\\\"Exklusive Mitgliedschaft und reservierte Sitzplätze\\\\\",\n            \\\\\"Moderne Technik und WLAN für Geschäftsreisende\\\\\",\n          ],\n          correctOption: 1,\n          explanation:\n            \\\\\"Der Text beschreibt: Marmortische, Thonet-Stühle, Zeitungsständer und die Tradition, stundenlang verweilen zu dürfen.\\\\\",\n        },\n        {\\\\`;\ncontent = content.replace\\(old_q4_t3, new_q4_t3\\);\n\n// Fix tv1-t3-q5 \\(CRISPR ethisch → Kaffeehauskultur Herkunft\\)\nconst start_q5_t3_new = content.indexOf\\('          id: \\\\\"tv1-t3-q5\\\\\"'\\);\nconst end_q5_t3 = content.indexOf\\('      ],\\\\n    },\\\\n    {\\\\n      id: \\\\\"tv1-text4\\\\\"'\\);\nconst old_q5_t3 = content.slice\\(start_q5_t3_new, end_q5_t3\\);\nconst new_q5_t3 = \\\\`          id: \\\\\"tv1-t3-q5\\\\\",\n          question: \\\\\"Was besagt der Text über die Herkunft der Wiener Kaffeehauskultur?\\\\\",\n          options: [\n            \\\\\"Sie wurde von italienischen Händlern im 16. Jahrhundert eingeführt\\\\\",\n            \\\\\"Sie entstand nach der zweiten osmanischen Belagerung Wiens 1683, als angeblich Kaffeebohnen zurückgelassen wurden\\\\\",\n            \\\\\"Sie geht auf kaiserliche Dekrete Maria Theresias zurück\\\\\",\n            \\\\\"Sie wurde von Wiener Bürgerlichen als Gegenmodell zum Adel entwickelt\\\\\",\n            \\\\\"Sie entstand erst im frühen 20. Jahrhundert als Reaktion auf die Industrialisierung\\\\\",\n          ],\n          correctOption: 1,\n          explanation:\n            \\\\\"Der Text: \\\\\\\\u201EDie Tradition reicht bis ins späte 17. Jahrhundert zurück, als nach der zweiten Belagerung Wiens durch die Osmanen 1683 angeblich Säcke mit Kaffeebohnen zurückgelassen wurden.\\\\\\\\u201C\\\\\",\n        },\n      \\\\`];\ncontent = content.replace\\(old_q5_t3, new_q5_t3\\);\n\nfs.writeFileSync\\('src/data/tvTextsExpanded.ts', content, 'utf8'\\);\nconsole.log\\('Done! Verifying...'\\);\n\n// Verify\nconst verify = fs.readFileSync\\('src/data/tvTextsExpanded.ts', 'utf8'\\);\nconsole.log\\('Contains Mikroplastik:', verify.includes\\('Mikroplastik'\\)\\);\nconsole.log\\('Contains Dunkle Materie:', verify.includes\\('Dunkle Materie'\\)\\);\nconsole.log\\('Contains CRISPR:', verify.includes\\('CRISPR'\\)\\);\nconsole.log\\('Contains Seidenstraße Religionen q4:', verify.includes\\('Welche Religionen verbreiteten'\\)\\);\nconsole.log\\('Contains Pest q5:', verify.includes\\('Krankheitserregern, darunter mutmaßlich die Pest'\\)\\);\nconsole.log\\('Contains Kaffeehausgäste q3:', verify.includes\\('regelmäßige Kaffeehausgäste'\\)\\);\nconsole.log\\('Contains Atmosphäre q4:', verify.includes\\('Atmosphäre des Wiener Kaffeehauses'\\)\\);\nconsole.log\\('Contains Herkunft q5:', verify.includes\\('Herkunft der Wiener Kaffeehauskultur'\\)\\);\n\" 2>&1)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\n\n// Analyze which UKs are 'thin' \\(< 15K chars\\) and need expansion\nfunction analyzeDepth\\(path, subject\\) {\n  const content = fs.readFileSync\\(path, 'utf8'\\);\n  const ukSections = content.split\\(/\\(?=\\\\{\\\\s*id:\\\\s*['\\\\\"]\\(?:bio|ch|ph|ma\\)-\\)/\\);\n  const results = [];\n  \n  for \\(const section of ukSections\\) {\n    const idMatch = section.match\\(/id:\\\\s*['\\\\\"]\\(\\(bio|ch|ph|ma\\)-[^'\\\\\"]+\\)['\\\\\"]/\\);\n    const titleMatch = section.match\\(/title:\\\\s*['\\\\\"]\\(\\(?:[^'\\\\\"\\\\\\\\\\\\\\\\]|\\\\\\\\\\\\\\\\.\\)+\\)['\\\\\"]/\\);\n    if \\(!idMatch || !titleMatch\\) continue;\n    \n    // Extract just the content string length\n    const contentStart = section.indexOf\\('content:'\\);\n    const contentEnd = section.indexOf\\('selfTest:'\\);\n    if \\(contentStart < 0 || contentEnd < 0\\) continue;\n    \n    const contentBlock = section.substring\\(contentStart, contentEnd\\);\n    results.push\\({\n      id: idMatch[1],\n      title: titleMatch[1].substring\\(0, 40\\),\n      chars: contentBlock.length,\n      sections: \\(contentBlock.match\\(/^##/mg\\) || []\\).length\n    }\\);\n  }\n  return results;\n}\n\nconst subjects = {\n  biologie: ['kap1-die-zelle.ts', 'kap2-anatomie-gewebe-physiologie.ts', 'kap3-entwicklung-evolution.ts', 'kap4-genetik.ts', 'kap5-oekologie-immunologie.ts'],\n  chemie: ['kap1-atombau-periodensystem.ts', 'kap2-materie-und-zustaende.ts', 'kap4-reaktionen-gleichgewicht.ts', 'kap5-anorganische-chemie.ts', 'kap6-chemische-bindung.ts', 'kap6-organische-chemie.ts'],\n  physik: ['kap1-mechanik-grundlagen.ts', 'kap3-schwingungen-und-wellen.ts', 'kap4-elektrizitaet-optik.ts', 'kap4-waermelehre.ts', 'kap7-atomphysik.ts'],\n  mathematik: ['kap1-zahlen-einheiten.ts', 'kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap6-vektorrechnung.ts', 'kap7-stochastik.ts']\n};\n\nlet thin = [], thick = [], totalChars = 0, totalUK = 0;\n\nfor \\(const [sub, files] of Object.entries\\(subjects\\)\\) {\n  for \\(const f of files\\) {\n    const path = 'src/data/bmsKapitel/' + sub + '/' + f;\n    const details = analyzeDepth\\(path, sub\\);\n    details.forEach\\(uk => {\n      totalChars += uk.chars;\n      totalUK++;\n      if \\(uk.chars < 12000\\) thin.push\\({ ...uk, subject: sub, file: f }\\);\n      else if \\(uk.chars > 30000\\) thick.push\\({ ...uk, subject: sub, file: f }\\);\n    }\\);\n  }\n}\n\nconsole.log\\('GESAMT: ' + totalUK + ' UK, ∅ ' + Math.round\\(totalChars/totalUK/1000\\) + 'K chars/UK'\\);\nconsole.log\\(''\\);\nconsole.log\\('DÜNNE UKs \\(< 12K chars\\) - brauchen Expansion \\(' + thin.length + '\\):'\\);\nthin.sort\\(\\(a,b\\) => a.chars - b.chars\\).forEach\\(u => \n  console.log\\('  ' + u.id + ' [' + Math.round\\(u.chars/1000\\) + 'K] ' + u.title\\)\\);\nconsole.log\\(''\\);\nconsole.log\\('STARKE UKs \\(> 30K chars\\) - als Vorbild \\(' + thick.length + '\\):'\\);\nthick.sort\\(\\(a,b\\) => b.chars - a.chars\\).slice\\(0,10\\).forEach\\(u => \n  console.log\\('  ' + u.id + ' [' + Math.round\\(u.chars/1000\\) + 'K] ' + u.title\\)\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\n\nfunction countAll\\(path\\) {\n  const content = fs.readFileSync\\(path, 'utf8'\\);\n  const charCount = content.length;\n  \n  // Count UKs\n  const ukMatches = content.match\\(/id:\\\\s*['\\\\\"]\\(?:bio|ch|ph|ma\\)-[^'\\\\\"]+['\\\\\"],/g\\) || [];\n  \n  // Count selfTest questions  \n  let totalQ = 0;\n  const stParts = content.split\\('selfTest:'\\);\n  for \\(let i = 1; i < stParts.length; i++\\) {\n    let d = 0, start = -1;\n    for \\(let j = 0; j < stParts[i].length; j++\\) {\n      if \\(stParts[i][j] === '['\\) { if \\(d === 0\\) start = j; d++; }\n      else if \\(stParts[i][j] === ']'\\) { d--; if \\(d === 0\\) { break; } }\n    }\n    const block = stParts[i].substring\\(0, stParts[i].indexOf\\('],', start\\)\\);\n    totalQ += \\(block.match\\(/question:/g\\) || []\\).length;\n  }\n  \n  // Get altfrage count\n  const altfrageCount = \\(content.match\\(/altfrage:/g\\) || []\\).length;\n  \n  return { chars: charCount, uk: ukMatches.length, questions: totalQ, altfragen: altfrageCount };\n}\n\nconst subjects = {\n  biologie: ['kap1-die-zelle.ts', 'kap2-anatomie-gewebe-physiologie.ts', 'kap3-entwicklung-evolution.ts', 'kap4-genetik.ts', 'kap5-oekologie-immunologie.ts'],\n  chemie: ['kap1-atombau-periodensystem.ts', 'kap2-materie-und-zustaende.ts', 'kap4-reaktionen-gleichgewicht.ts', 'kap5-anorganische-chemie.ts', 'kap6-chemische-bindung.ts', 'kap6-organische-chemie.ts'],\n  physik: ['kap1-mechanik-grundlagen.ts', 'kap3-schwingungen-und-wellen.ts', 'kap4-elektrizitaet-optik.ts', 'kap4-waermelehre.ts', 'kap7-atomphysik.ts'],\n  mathematik: ['kap1-zahlen-einheiten.ts', 'kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap6-vektorrechnung.ts', 'kap7-stochastik.ts']\n};\n\nlet grand = {chars: 0, uk: 0, q: 0, alt: 0};\n\nconsole.log\\('AKTUELLER STAND \\(nach Background-Agents\\):'\\);\nconsole.log\\(''\\);\n\nfor \\(const [sub, files] of Object.entries\\(subjects\\)\\) {\n  let subChars = 0, subUK = 0, subQ = 0, subAlt = 0;\n  for \\(const f of files\\) {\n    const r = countAll\\('src/data/bmsKapitel/' + sub + '/' + f\\);\n    subChars += r.chars; subUK += r.uk; subQ += r.questions; subAlt += r.altfragen;\n  }\n  grand.chars += subChars; grand.uk += subUK; grand.q += subQ; grand.alt += subAlt;\n  const avgQ = subUK > 0 ? \\(subQ/subUK\\).toFixed\\(1\\) : '?';\n  console.log\\(sub.toUpperCase\\(\\).padEnd\\(12\\) + ': ' + subUK + ' UK | ' + Math.round\\(subChars/1000\\) + 'K chars | ' + subQ + ' selfTest-Q \\(∅' + avgQ + '/UK\\) | ' + subAlt + ' altfragen'\\);\n}\n\nconsole.log\\(''\\);\nconsole.log\\('GESAMT: ' + grand.uk + ' UK | ' + Math.round\\(grand.chars/1000\\) + 'K chars | ' + grand.q + ' selfTest \\(∅' + \\(grand.q/grand.uk\\).toFixed\\(1\\) + '/UK\\) | ' + grand.alt + ' altfragen'\\);\nconsole.log\\(''\\);\nconsole.log\\('CONTENT DEPTH pro UK \\(chars ohne selfTest/altfrage\\):'\\);\nconsole.log\\('  Geschätzt: ' + Math.round\\(\\(grand.chars - grand.q * 800 - grand.alt * 500\\) / grand.uk / 1000\\) + 'K chars reine Textinhalte pro UK'\\);\nconsole.log\\('  = ca. ' + Math.round\\(\\(grand.chars - grand.q * 800 - grand.alt * 500\\) / grand.uk / 5\\) + ' Wörter pro UK'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst c = fs.readFileSync\\('src/data/tvTextsExpanded.ts','utf8'\\);\n// Find all 'const set' declarations\nconst lines = c.split\\('\\\\n'\\);\nfor \\(let i=0; i<lines.length; i++\\) {\n  if \\(lines[i].includes\\('const set'\\) || lines[i].includes\\('};'\\)\\) {\n    if \\(i > 480 && i < 500\\) console.log\\(\\(i+1\\) + ': ' + lines[i]\\);\n  }\n}\n// Check bracket balance around line 485\nlet depth = 0;\nfor \\(let i = 480; i < 495; i++\\) {\n  for \\(const ch of lines[i]\\) {\n    if \\(ch === '{'\\) depth++;\n    if \\(ch === '}'\\) depth--;\n  }\n  console.log\\('Line ' + \\(i+1\\) + ' depth=' + depth + ': ' + lines[i].substring\\(0,80\\)\\);\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst c = fs.readFileSync\\('src/data/tvTextsExpanded.ts','utf8'\\);\nconst lines = c.split\\('\\\\n'\\);\nlet depth = 0;\n// Track from beginning of set1\nfor \\(let i = 0; i < 490; i++\\) {\n  for \\(const ch of lines[i]\\) {\n    if \\(ch === '{'\\) depth++;\n    if \\(ch === '}'\\) depth--;\n    if \\(ch === '['\\) depth++;\n    if \\(ch === ']'\\) depth--;\n  }\n  // Print lines where depth drops unexpectedly\n  if \\(depth < 0 || \\(i > 120 && i < 500 && \\(lines[i].includes\\('],'\\) || lines[i].includes\\('},'\\)\\)\\)\\)  {\n    if \\(i > 120 && i < 250\\) console.log\\(\\(i+1\\) + ' d=' + depth + ': ' + lines[i].trimStart\\(\\).substring\\(0,80\\)\\);\n  }\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst c = fs.readFileSync\\('src/data/tvTextsExpanded.ts','utf8'\\);\nconst lines = c.split\\('\\\\n'\\);\nlet depth = 0;\n// Track from beginning looking at ALL bracket changes, show lines 195-310\nfor \\(let i = 0; i < 350; i++\\) {\n  const prevDepth = depth;\n  for \\(const ch of lines[i]\\) {\n    if \\(ch === '{' || ch === '['\\) depth++;\n    if \\(ch === '}' || ch === ']'\\) depth--;\n  }\n  if \\(i >= 195 && i < 340 && depth !== prevDepth\\) {\n    console.log\\(\\(i+1\\) + ' d=' + depth + ': ' + lines[i].trimStart\\(\\).substring\\(0,80\\)\\);\n  }\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst c = fs.readFileSync\\('src/data/tvTextsExpanded.ts','utf8'\\);\nconst lines = c.split\\('\\\\n'\\);\nlet depth = 0;\n// Find where depth first reaches 0 \\(should be end of set1 at line 487\\)\nfor \\(let i = 0; i < 490; i++\\) {\n  for \\(const ch of lines[i]\\) {\n    if \\(ch === '{' || ch === '['\\) depth++;\n    if \\(ch === '}' || ch === ']'\\) depth--;\n  }\n  if \\(depth <= 0 && i > 30\\) {\n    console.log\\('DEPTH 0 at line ' + \\(i+1\\) + ': ' + lines[i].trim\\(\\).substring\\(0,60\\)\\);\n    break;\n  }\n}\n\")",
      "Bash(sed -n '99p' src/data/tvTextsExpanded.ts | xxd | head -5)",
      "Bash(python3 -c \"\nimport re\nfor fname in ['kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap7-stochastik.ts']:\n    path = f'/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/{fname}'\n    with open\\(path\\) as f:\n        text = f.read\\(\\)\n    # Find all selfTest blocks and count questions in each\n    parts = text.split\\('selfTest: ['\\)\n    print\\(f'=== {fname} \\({len\\(parts\\)-1} UKs\\) ==='\\)\n    for i, part in enumerate\\(parts[1:], 1\\):\n        end = part.find\\('],'\\)\n        block = part[:end] if end != -1 else part[:500]\n        count = block.count\\('correctIndex:'\\)\n        # Find UK id\n        prev = parts[i-1]\n        id_match = re.findall\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\"', prev\\)\n        uk_id = id_match[-1] if id_match else f'UK{i}'\n        print\\(f'  {uk_id}: {count} questions'\\)\n\")",
      "Bash(python3 -c \"\nimport re\nfor fname in ['kap2-algebra-geometrie.ts', 'kap5-funktionen.ts', 'kap7-stochastik.ts']:\n    path = f'/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/{fname}'\n    with open\\(path\\) as f:\n        lines = f.readlines\\(\\)\n    \n    current_uk = ''\n    in_selftest = False\n    count = 0\n    print\\(f'=== {fname} ==='\\)\n    \n    for line in lines:\n        id_match = re.search\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\"', line\\)\n        if id_match:\n            if current_uk and count > 0:\n                print\\(f'  {current_uk}: {count} questions'\\)\n            current_uk = id_match.group\\(1\\)\n            count = 0\n            in_selftest = False\n        if 'selfTest:' in line:\n            in_selftest = True\n        if in_selftest and 'question:' in line:\n            count += 1\n    if current_uk and count > 0:\n        print\\(f'  {current_uk}: {count} questions'\\)\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap2-algebra-geometrie.ts'\nwith open\\(path\\) as f:\n    text = f.read\\(\\)\n\n# Find all UK ids and titles\nmatches = re.findall\\(r'id: \\\\\"\\(ma-\\\\d+-\\\\d+\\)\\\\\",\\\\s*\\\\n\\\\s*title: \\\\\"\\([^\\\\\"]+\\)\\\\\"', text\\)\nfor m in matches:\n    print\\(f'{m[0]}: {m[1]}'\\)\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap2-algebra-geometrie.ts'\nwith open\\(path\\) as f:\n    text = f.read\\(\\)\n\n# Find all UK ids and titles  - broader search\nmatches = re.findall\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\",\\\\s*\\\\n\\\\s*title: \\\\\"\\([^\\\\\"]+\\)\\\\\"', text\\)\nfor m in matches:\n    print\\(f'{m[0]}: {m[1]}'\\)\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap2-algebra-geometrie.ts'\nwith open\\(path\\) as f:\n    lines = f.readlines\\(\\)\n\nfor i, line in enumerate\\(lines\\):\n    # Content template literal ends with backtick-comma before lernziele\n    if line.strip\\(\\).startswith\\('lernziele:'\\):\n        # The closing backtick is on the previous line or a few lines before\n        for j in range\\(i-1, max\\(0, i-5\\), -1\\):\n            if lines[j].rstrip\\(\\).endswith\\('\\\\`,'\\):\n                print\\(f'  UK content ends at line {j+1}: {lines[j].rstrip\\(\\)[:80]}'\\)\n                break\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap2-algebra-geometrie.ts'\nwith open\\(path\\) as f:\n    lines = f.readlines\\(\\)\n\nfor i, line in enumerate\\(lines\\):\n    if line.strip\\(\\).startswith\\('lernziele:'\\):\n        for j in range\\(i-1, max\\(0, i-5\\), -1\\):\n            if lines[j].rstrip\\(\\).endswith\\('\\\\`,' \\):\n                print\\(f'  Line {j+1}: ...{lines[j].rstrip\\(\\)[-60:]}'\\)\n                break\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts'\nwith open\\(path\\) as f:\n    text = f.read\\(\\)\n\nmatches = re.findall\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\",\\\\s*\\\\n\\\\s*title: \\\\\"\\([^\\\\\"]+\\)\\\\\"', text\\)\nfor m in matches:\n    print\\(f'{m[0]}: {m[1]}'\\)\nprint\\(\\)\n\n# Find content endpoints\nlines = text.split\\('\\\\n'\\)\nfor i, line in enumerate\\(lines\\):\n    if line.strip\\(\\).startswith\\('lernziele:'\\):\n        for j in range\\(i-1, max\\(0, i-5\\), -1\\):\n            if lines[j].rstrip\\(\\).endswith\\('\\\\`,'\\):\n                print\\(f'  Line {j+1}: ...{lines[j].rstrip\\(\\)[-50:]}'\\)\n                break\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts'\nwith open\\(path\\) as f:\n    lines = f.readlines\\(\\)\n\nin_selftest = False\ncurrent_uk = ''\nq_num = 0\n\nfor i, line in enumerate\\(lines\\):\n    id_match = re.search\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\"', line\\)\n    if id_match:\n        current_uk = id_match.group\\(1\\)\n        in_selftest = False\n        q_num = 0\n    if 'selfTest:' in line:\n        in_selftest = True\n        q_num = 0\n    if in_selftest and 'question:' in line:\n        q_num += 1\n        # Get the question text \\(may span next line\\)\n        q_text = line.strip\\(\\)\n        if q_text.endswith\\('\\\\\"'\\) or q_text.endswith\\('\\\\\",'\\):\n            pass\n        else:\n            q_text += ' ' + lines[i+1].strip\\(\\) if i+1 < len\\(lines\\) else ''\n        q_text = q_text[:100]\n        print\\(f'{current_uk} Q{q_num} \\(L{i+1}\\): {q_text}'\\)\n    if in_selftest and line.strip\\(\\) == '],':\n        in_selftest = False\n        print\\(\\)\n\" 2>&1 | head -60)",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts'\nwith open\\(path\\) as f:\n    lines = f.readlines\\(\\)\n\nin_selftest = False\ncurrent_uk = ''\nq_num = 0\n\nfor i, line in enumerate\\(lines\\):\n    id_match = re.search\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\"', line\\)\n    if id_match:\n        current_uk = id_match.group\\(1\\)\n        in_selftest = False\n        q_num = 0\n    if 'selfTest:' in line:\n        in_selftest = True\n        q_num = 0\n    if in_selftest and '  question:' in line:\n        q_num += 1\n        # Get the full question text\n        q_text = line.strip\\(\\).replace\\('question:', ''\\).strip\\(\\).strip\\('\\\\\"'\\).strip\\(','\\).strip\\('\\\\\"'\\)\n        if not q_text or q_text == '':\n            q_text = lines[i+1].strip\\(\\).strip\\('\\\\\"'\\).strip\\(','\\).strip\\('\\\\\"'\\) if i+1 < len\\(lines\\) else ''\n        q_short = q_text[:80]\n        print\\(f'{current_uk} Q{q_num} \\(L{i+1}\\): {q_short}'\\)\n    if in_selftest and line.strip\\(\\) == '],':\n        in_selftest = False\n        print\\(\\)\n\")",
      "Bash(python3 -c \"\nimport re\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts'\nwith open\\(path\\) as f:\n    text = f.read\\(\\)\n    lines = text.split\\('\\\\n'\\)\n\n# Find selfTest blocks by matching 'selfTest: [' and counting questions until '],'\nin_selftest = False\ndepth = 0\ncurrent_uk = ''\nq_count = 0\n\nfor i, line in enumerate\\(lines\\):\n    id_match = re.search\\(r'id: \\\\\"\\(ma-[^\\\\\"]+\\)\\\\\"', line\\)\n    if id_match:\n        current_uk = id_match.group\\(1\\)\n    \n    if 'selfTest: [' in line:\n        in_selftest = True\n        depth = 1\n        q_count = 0\n        continue\n    \n    if in_selftest:\n        for ch in line:\n            if ch == '[': depth += 1\n            if ch == ']': \n                depth -= 1\n                if depth == 0:\n                    in_selftest = False\n                    print\\(f'{current_uk}: {q_count} questions \\(selfTest ends L{i+1}\\)'\\)\n                    break\n        \n        if in_selftest and re.match\\(r'\\\\s+question:', line\\):\n            q_count += 1\n            q_text = line.strip\\(\\)\n            if '\\\\\"' in q_text:\n                q_short = q_text.split\\('\\\\\"'\\)[1][:70] if '\\\\\"' in q_text else ''\n            else:\n                next_line = lines[i+1].strip\\(\\).strip\\('\\\\\"'\\).strip\\(','\\).strip\\('\\\\\"'\\) if i+1 < len\\(lines\\) else ''\n                q_short = next_line[:70]\n            print\\(f'  Q{q_count} \\(L{i+1}\\): {q_short}'\\)\n\")",
      "Bash(python3 -c \"\npath = '/Users/Luki/medmaster/src/data/bmsKapitel/mathematik/kap5-funktionen.ts'\nwith open\\(path\\) as f:\n    lines = f.readlines\\(\\)\n\nfor i, line in enumerate\\(lines\\):\n    if line.strip\\(\\).startswith\\('lernziele:'\\):\n        for j in range\\(i-1, max\\(0, i-5\\), -1\\):\n            if lines[j].rstrip\\(\\).endswith\\('\\\\`,'\\):\n                print\\(f'  Line {j+1}: ...{lines[j].rstrip\\(\\)[-60:]}'\\)\n                break\n\")",
      "Bash(python3 -c \"\nimport re\n\nfiles = [\n    'src/data/bmsKapitel/chemie/kap1-atombau-periodensystem.ts',\n    'src/data/bmsKapitel/chemie/kap2-materie-und-zustaende.ts',\n    'src/data/bmsKapitel/chemie/kap4-reaktionen-gleichgewicht.ts',\n    'src/data/bmsKapitel/chemie/kap5-anorganische-chemie.ts',\n    'src/data/bmsKapitel/chemie/kap6-chemische-bindung.ts',\n    'src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts',\n    'src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts',\n    'src/data/bmsKapitel/biologie/kap4-genetik.ts',\n    'src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts',\n]\n\nfor filepath in files:\n    f = open\\(filepath, 'r'\\).read\\(\\)\n    ids = [\\(m.start\\(\\), m.group\\(1\\)\\) for m in re.finditer\\(r'id:\\\\s*[\\\\\"\\\\\\\\x27]\\([^\\\\\"\\\\\\\\x27]+\\)[\\\\\"\\\\\\\\x27]', f\\)]\n    short = []\n    for idx, \\(pos, uk_id\\) in enumerate\\(ids\\):\n        # find content backtick\n        content_match = f.find\\('content: \\\\`', pos\\)\n        if content_match == -1:\n            continue\n        start = content_match + len\\('content: \\\\`'\\)\n        i = start\n        while i < len\\(f\\):\n            if f[i] == '\\\\\\\\\\\\\\\\' :\n                i += 2\n                continue\n            if f[i] == '\\\\`':\n                break\n            i += 1\n        content = f[start:i]\n        words = len\\(content.split\\(\\)\\)\n        if words < 800:\n            short.append\\(f'  {uk_id}: ~{words}w'\\)\n    if short:\n        print\\(f'\\\\\\\\n{filepath.split\\(\\\\\"/\\\\\"\\)[-1]} \\({len\\(short\\)} short\\):'\\)\n        for s in short:\n            print\\(s\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nfiles = {\n    'BIOLOGIE': [\n        \\('kap1-die-zelle', 'src/data/bmsKapitel/biologie/kap1-die-zelle.ts'\\),\n        \\('kap2-anatomie', 'src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts'\\),\n        \\('kap3-evolution', 'src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts'\\),\n        \\('kap4-genetik', 'src/data/bmsKapitel/biologie/kap4-genetik.ts'\\),\n        \\('kap5-oeko-immun', 'src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts'\\),\n    ],\n}\n\nfor subject, file_list in files.items\\(\\):\n    print\\(f'\\\\\\\\n===== {subject} ====='\\)\n    total_words = 0\n    total_uks = 0\n    short_uks = []\n    for label, filepath in file_list:\n        f = open\\(filepath, 'r'\\).read\\(\\)\n        ids = [\\(m.start\\(\\), m.group\\(1\\)\\) for m in re.finditer\\(r'id:\\\\s*[\\\\\"\\\\\\\\x27]\\([^\\\\\"\\\\\\\\x27]+\\)[\\\\\"\\\\\\\\x27]', f\\)]\n        for idx, \\(pos, uk_id\\) in enumerate\\(ids\\):\n            if uk_id.startswith\\('bio-kap'\\):\n                continue\n            content_match = f.find\\('content: \\\\`', pos\\)\n            if content_match == -1:\n                continue\n            start = content_match + len\\('content: \\\\`'\\)\n            i = start\n            while i < len\\(f\\):\n                if f[i] == '\\\\\\\\\\\\\\\\':\n                    i += 2\n                    continue\n                if f[i] == '\\\\`':\n                    break\n                i += 1\n            content = f[start:i]\n            words = len\\(content.split\\(\\)\\)\n            total_words += words\n            total_uks += 1\n            status = '✓' if words >= 600 else '✗'\n            if words < 600:\n                short_uks.append\\(\\(uk_id, words, label\\)\\)\n            print\\(f'  {status} {uk_id}: ~{words}w  [{label}]'\\)\n    print\\(f'\\\\\\\\n  TOTAL: {total_uks} UKs, {total_words} words \\(avg {total_words//max\\(total_uks,1\\)}w/UK\\)'\\)\n    if short_uks:\n        print\\(f'  SHORT \\(<600w\\): {len\\(short_uks\\)} UKs'\\)\n        for uid, w, lab in sorted\\(short_uks, key=lambda x: x[1]\\):\n            print\\(f'    {uid}: ~{w}w [{lab}]'\\)\n\")",
      "Bash(python3 -c \"\nimport re\nimport sys\n\nfiles = [\n    'src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts',\n    'src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts',\n    'src/data/bmsKapitel/biologie/kap4-genetik.ts',\n    'src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts',\n]\n\nfor f in files:\n    with open\\(f, 'r'\\) as fh:\n        text = fh.read\\(\\)\n    # Find all content blocks\n    pattern = r\\\\\"id:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"].*?content:\\\\s*\\\\x60\\(.*?\\)\\\\x60\\\\\"\n    matches = re.findall\\(pattern, text, re.DOTALL\\)\n    for uk_id, content in matches:\n        words = len\\(content.split\\(\\)\\)\n        if words < 700:\n            print\\(f'{uk_id}: {words}w  [{f.split\\(\\\\\"/\\\\\"\\)[-1]}]'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap4-genetik.ts', 'r'\\) as f:\n    text = f.read\\(\\)\n\n# Find all content template literals\npattern = r\\\\\"id:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"].*?content:\\\\s*\\\\`\\(.*?\\)\\\\`\\\\\"\nmatches = re.findall\\(pattern, text, re.DOTALL\\)\n\nshort = []\nok = []\nfor uid, content in matches:\n    words = len\\(content.split\\(\\)\\)\n    status = 'OK' if words >= 800 else 'SHORT'\n    if status == 'SHORT':\n        short.append\\(\\(uid, words\\)\\)\n    else:\n        ok.append\\(\\(uid, words\\)\\)\n\nprint\\(f'=== {len\\(ok\\)} OK \\(800+\\) ==='\\)\nfor uid, w in sorted\\(ok\\):\n    print\\(f'  {uid}: {w}w'\\)\n\nprint\\(f'\\\\n=== {len\\(short\\)} SHORT \\(<800\\) ==='\\)\nfor uid, w in sorted\\(short\\):\n    print\\(f'  {uid}: {w}w \\(need +{800-w}w\\)'\\)\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\n\n// Extract content for each UK\nconst ids = ['bio-1-01', 'bio-1-02', 'bio-1-03', 'bio-1-05'];\nfor \\(const id of ids\\) {\n  const regex = new RegExp\\('id:\\\\\\\\s*\\\\\"' + id + '\\\\\"[\\\\\\\\s\\\\\\\\S]*?content:\\\\\\\\s*\\\\`\\([\\\\\\\\s\\\\\\\\S]*?\\)\\\\`'\\);\n  const match = content.match\\(regex\\);\n  if \\(match\\) {\n    const words = match[1].trim\\(\\).split\\(/\\\\s+/\\).length;\n    console.log\\(id + ': ' + words + ' words'\\);\n  }\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\n\n// Extract content for each UK using line-by-line approach\nconst lines = content.split\\('\\\\n'\\);\nconst ids = ['bio-1-01', 'bio-1-02', 'bio-1-03', 'bio-1-05'];\n\nfor \\(const id of ids\\) {\n  let inContent = false;\n  let contentLines = [];\n  let found = false;\n  \n  for \\(let i = 0; i < lines.length; i++\\) {\n    if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) {\n      found = true;\n    }\n    if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n      inContent = true;\n      contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n      continue;\n    }\n    if \\(inContent\\) {\n      if \\(lines[i].includes\\('\\\\`,'\\) || lines[i].endsWith\\('\\\\`'\\)\\) {\n        contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\);\n        break;\n      }\n      contentLines.push\\(lines[i]\\);\n    }\n  }\n  \n  const text = contentLines.join\\(' '\\);\n  const words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\n  console.log\\(id + ': ' + words + ' words'\\);\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\n\nconst ids = ['bio-1-02'];\nfor \\(const id of ids\\) {\n  let inContent = false;\n  let contentLines = [];\n  let found = false;\n  const lines = content.split\\('\\\\n'\\);\n  \n  for \\(let i = 0; i < lines.length; i++\\) {\n    if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) {\n      found = true;\n    }\n    if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n      inContent = true;\n      contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n      continue;\n    }\n    if \\(inContent\\) {\n      if \\(lines[i].includes\\('\\\\`,' \\)\\) {\n        contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\);\n        break;\n      }\n      if \\(lines[i].endsWith\\('\\\\`'\\)\\) {\n        contentLines.push\\(lines[i].replace\\(/\\\\`$/, ''\\)\\);\n        break;\n      }\n      contentLines.push\\(lines[i]\\);\n    }\n  }\n  \n  const text = contentLines.join\\(' '\\);\n  const words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\n  console.log\\(id + ': ' + words + ' words'\\);\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\nconst id = 'bio-1-03';\nlet inContent = false, contentLines = [], found = false;\nconst lines = content.split\\('\\\\n'\\);\nfor \\(let i = 0; i < lines.length; i++\\) {\n  if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) found = true;\n  if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n    inContent = true;\n    contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n    continue;\n  }\n  if \\(inContent\\) {\n    if \\(lines[i].includes\\('\\\\`,'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\); break; }\n    if \\(lines[i].endsWith\\('\\\\`'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`$/, ''\\)\\); break; }\n    contentLines.push\\(lines[i]\\);\n  }\n}\nconst text = contentLines.join\\(' '\\);\nconst words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\nconsole.log\\(id + ': ' + words + ' words'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\nconst id = 'bio-1-01';\nlet inContent = false, contentLines = [], found = false;\nconst lines = content.split\\('\\\\n'\\);\nfor \\(let i = 0; i < lines.length; i++\\) {\n  if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) found = true;\n  if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n    inContent = true;\n    contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n    continue;\n  }\n  if \\(inContent\\) {\n    if \\(lines[i].includes\\('\\\\`,'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\); break; }\n    if \\(lines[i].endsWith\\('\\\\`'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`$/, ''\\)\\); break; }\n    contentLines.push\\(lines[i]\\);\n  }\n}\nconst text = contentLines.join\\(' '\\);\nconst words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\nconsole.log\\(id + ': ' + words + ' words'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\nconst id = 'bio-1-05';\nlet inContent = false, contentLines = [], found = false;\nconst lines = content.split\\('\\\\n'\\);\nfor \\(let i = 0; i < lines.length; i++\\) {\n  if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) found = true;\n  if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n    inContent = true;\n    contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n    continue;\n  }\n  if \\(inContent\\) {\n    if \\(lines[i].includes\\('\\\\`,'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\); break; }\n    if \\(lines[i].endsWith\\('\\\\`'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`$/, ''\\)\\); break; }\n    contentLines.push\\(lines[i]\\);\n  }\n}\nconst text = contentLines.join\\(' '\\);\nconst words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\nconsole.log\\(id + ': ' + words + ' words'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\nconst ids = ['bio-1-01', 'bio-1-02', 'bio-1-03', 'bio-1-05'];\nfor \\(const id of ids\\) {\n  let inContent = false, contentLines = [], found = false;\n  const lines = content.split\\('\\\\n'\\);\n  for \\(let i = 0; i < lines.length; i++\\) {\n    if \\(lines[i].includes\\('id: \\\\\"' + id + '\\\\\"'\\)\\) found = true;\n    if \\(found && !inContent && lines[i].trim\\(\\).startsWith\\('content: \\\\`'\\)\\) {\n      inContent = true;\n      contentLines.push\\(lines[i].replace\\(/.*content: \\\\`/, ''\\)\\);\n      continue;\n    }\n    if \\(inContent\\) {\n      if \\(lines[i].includes\\('\\\\`,'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`[,]?$/, ''\\)\\); break; }\n      if \\(lines[i].endsWith\\('\\\\`'\\)\\) { contentLines.push\\(lines[i].replace\\(/\\\\`$/, ''\\)\\); break; }\n      contentLines.push\\(lines[i]\\);\n    }\n  }\n  const text = contentLines.join\\(' '\\);\n  const words = text.trim\\(\\).split\\(/\\\\s+/\\).filter\\(w => w.length > 0\\).length;\n  const status = words >= 800 ? 'PASS' : 'FAIL';\n  console.log\\(id + ': ' + words + ' words [' + status + ']'\\);\n  found = false; inContent = false; contentLines = [];\n}\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\n# Find all content template literals\npattern = r'id: \\\\\"\\(bio-1[01]-\\\\d+\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\nwith open\\('src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\n# Find all unterkapitel content fields\npattern = r'id: \\\\\"\\(bio-[23]-\\\\d+\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, cont in matches:\n    words = len\\(cont.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-10-01\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-11-02\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\n# Find all unterkapitel content fields\npattern = r'id: \\\\\"\\(bio-[23]-\\\\d+\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, cont in matches:\n    words = len\\(cont.split\\(\\)\\)\n    status = '✓' if words >= 800 else '✗ NEEDS MORE'\n    print\\(f'{uid}: {words} words {status}'\\)\n\")",
      "Bash(python3 -c \"\nimport re\nwith open\\('/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-2-0[1-4]\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, cont in matches:\n    words = len\\(cont.split\\(\\)\\)\n    status = 'OK' if words >= 800 else 'NEEDS MORE'\n    print\\(f'{uid}: {words} words [{status}]'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-11-03\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-11-04\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    print\\(f'{uid}: {words} words'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\npattern = r'id: \\\\\"\\(bio-1[01]-\\\\d+\\)\\\\\".*?content: \\\\`\\(.*?\\)\\\\`,'\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\nfor uid, text in matches:\n    words = len\\(text.split\\(\\)\\)\n    status = 'OK' if words >= 800 else 'SHORT'\n    print\\(f'{uid}: {words:>5} words  [{status}]'\\)\n\")",
      "Bash(python3 -c \"\nimport re\n\nwith open\\('src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts', 'r'\\) as f:\n    content = f.read\\(\\)\n\n# Find all content template literals\npattern = r\\\\\"id:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"].*?content:\\\\s*\\\\`\\(.*?\\)\\\\`\\\\\"\nmatches = re.findall\\(pattern, content, re.DOTALL\\)\n\ntarget_ids = ['bio-4-01', 'bio-4-02', 'bio-4-03', 'bio-4-04', 'bio-9-01']\n\nfor uid, text in matches:\n    if uid in target_ids:\n        # Count words \\(split on whitespace\\)\n        words = len\\(text.split\\(\\)\\)\n        status = 'OK' if words >= 800 else 'NEEDS MORE'\n        print\\(f'{uid}: {words} words [{status}]'\\)\n\")",
      "Bash(kill 24591 2>/dev/null; sleep 1)",
      "WebFetch(domain:main.vite.dev)",
      "Bash(sleep 3\ncurl -s -w \"\\\\nHTTP %{http_code}\" http://localhost:5173/ | head -5)",
      "Bash(npx tsx -e \"\nimport { alleKapitel } from './src/data/bmsKapitel/index';\n\nlet totalUK = 0;\nlet withStichworte = 0;\nlet withSections = 0;\nlet withSectionMerksatz = 0;\nlet withTopMerksaetze = 0;\nlet sectionMerksatzCount = 0;\nlet topMerksaetzeCount = 0;\n\n// Per-subject breakdown\nconst bySubject: Record<string, {total: number, stichworte: number, sections: number, secMerksatz: number}> = {};\n\nfor \\(const kap of alleKapitel\\) {\n  const s = kap.subject;\n  if \\(!bySubject[s]\\) bySubject[s] = {total: 0, stichworte: 0, sections: 0, secMerksatz: 0};\n  \n  for \\(const uk of kap.unterkapitel ?? []\\) {\n    totalUK++;\n    bySubject[s].total++;\n    \n    if \\(uk.stichworte && uk.stichworte.length > 0\\) {\n      withStichworte++;\n      bySubject[s].stichworte++;\n    }\n    \n    if \\(uk.sections && uk.sections.length > 0\\) {\n      withSections++;\n      bySubject[s].sections++;\n      let hasSM = false;\n      for \\(const sec of uk.sections\\) {\n        if \\(sec.merksatz\\) {\n          sectionMerksatzCount++;\n          hasSM = true;\n        }\n      }\n      if \\(hasSM\\) {\n        withSectionMerksatz++;\n        bySubject[s].secMerksatz++;\n      }\n    }\n    \n    if \\(uk.merksätze && uk.merksätze.length > 0\\) {\n      withTopMerksaetze++;\n      topMerksaetzeCount += uk.merksätze.length;\n    }\n  }\n}\n\nconsole.log\\('=== BMS UK Structure Audit ==='\\);\nconsole.log\\('Total UKs:', totalUK\\);\nconsole.log\\('With stichworte[]:', withStichworte, '\\(' + Math.round\\(withStichworte/totalUK*100\\) + '%\\)'\\);\nconsole.log\\('With sections[]:', withSections, '\\(' + Math.round\\(withSections/totalUK*100\\) + '%\\)'\\);\nconsole.log\\('With section.merksatz:', withSectionMerksatz, '\\(' + Math.round\\(withSectionMerksatz/totalUK*100\\) + '%\\)'\\);\nconsole.log\\('  Total inline merksätze:', sectionMerksatzCount\\);\nconsole.log\\('With top-level merksätze[]:', withTopMerksaetze, '\\(' + Math.round\\(withTopMerksaetze/totalUK*100\\) + '%\\)'\\);\nconsole.log\\('  Total top merksätze:', topMerksaetzeCount\\);\nconsole.log\\(\\);\nconsole.log\\('Per subject:'\\);\nfor \\(const [s, d] of Object.entries\\(bySubject\\)\\) {\n  console.log\\('  ' + s + ': ' + d.total + ' UKs, stichworte:' + d.stichworte + ', sections:' + d.sections + ', secMerksatz:' + d.secMerksatz\\);\n}\n\" 2>&1)",
      "Bash(sed -n '215p' /Users/Luki/medmaster/src/components/chapter/SubchapterContent.tsx | xxd | head -5)",
      "Bash(LC_ALL=C sed -i '' 's/\\\\xe2\\\\x80\\\\x9c/\"/g; s/\\\\xe2\\\\x80\\\\x9d/\"/g' src/components/chapter/SubchapterContent.tsx)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst content = fs.readFileSync\\('src/data/bmsKapitel/biologie/kap1-die-zelle.ts', 'utf8'\\);\n// Find first UK's stichworte, sections, merksätze, lernziele, klinischerBezug fields\nconst stichwMatch = content.match\\(/stichworte:\\\\s*\\\\[\\([^\\\\]]+\\)\\\\]/\\);\nconst sectionsMatch = content.match\\(/sections:\\\\s*\\\\[/\\);\nconst merksaetzeMatch = content.match\\(/merks.tze:\\\\s*\\\\[/\\);\nconst lernzieleMatch = content.match\\(/lernziele:\\\\s*\\\\[/\\);\nconst klinischMatch = content.match\\(/klinischerBezug:/\\);\nconsole.log\\('Has stichworte:', !!stichwMatch\\);\nconsole.log\\('Has sections:', !!sectionsMatch\\);\nconsole.log\\('Has merksätze:', !!merksaetzeMatch\\);\nconsole.log\\('Has lernziele:', !!lernzieleMatch\\);\nconsole.log\\('Has klinischerBezug:', !!klinischMatch\\);\n\")",
      "Bash(node -e \"\nconst results = require\\('/tmp/bio-transform-results.json'\\);\nconst r = results.find\\(r => r.ukId === 'bio-1-01'\\);\nconsole.log\\('Content length:', r.mergedContent.length\\);\nconsole.log\\('First 800 chars:'\\);\nconsole.log\\(r.mergedContent.slice\\(0, 800\\)\\);\nconsole.log\\('---'\\);\nconsole.log\\('Last 300 chars:'\\);\nconsole.log\\(r.mergedContent.slice\\(-300\\)\\);\n\")",
      "Bash(cat > /tmp/extract_diagrams.sh << 'EOF'\n#!/bin/bash\n\nfor file in /Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap*.ts; do\n  chapter=$\\(basename \"$file\" | sed 's/kap\\\\\\([0-9]*\\\\\\).*/\\\\1/'\\)\n  \n  # Extract unterkapitel blocks with diagram fields\n  awk '\n  BEGIN { id=\"\"; title=\"\"; diagram=\"\" }\n  /^\\\\s+\\\\{$/ { \n    if \\(id != \"\" && diagram != \"\"\\) {\n      print id \" | \" title \" | \" diagram\n    }\n    id=\"\"; title=\"\"; diagram=\"\"\n  }\n  /^\\\\s+id:.*\"bio-/ { \n    match\\($0, /\"\\(bio-[^\"]+\\)\"/\\)\n    id = substr\\($0, RSTART+1, RLENGTH-2\\)\n  }\n  /^\\\\s+title:/ { \n    match\\($0, /\"\\([^\"]+\\)\"/\\)\n    title = substr\\($0, RSTART+1, RLENGTH-2\\)\n  }\n  /^\\\\s+diagram:/ { \n    match\\($0, /\"\\([^\"]+\\)\"/\\)\n    diagram = substr\\($0, RSTART+1, RLENGTH-2\\)\n  }\n  END {\n    if \\(id != \"\" && diagram != \"\"\\) {\n      print id \" | \" title \" | \" diagram\n    }\n  }\n  ' \"$file\"\ndone\nEOF\nchmod +x /tmp/extract_diagrams.sh\n/tmp/extract_diagrams.sh)",
      "Bash(node << 'EOF'\n// Extract all diagram keys from DiagramSVG.tsx\nconst content = require\\('fs'\\).readFileSync\\('/Users/Luki/medmaster/src/components/diagrams/DiagramSVG.tsx', 'utf-8'\\);\n\n// Extract DIAGRAM_MAP keys\nconst mapMatch = content.match\\(/const DIAGRAM_MAP.*?\\\\n\\\\}/s\\);\nconst mapLines = mapMatch[0].match\\(/\"\\([^\"]+\\)\":/g\\);\n\nconst diagramKeys = new Set\\(\n  mapLines.map\\(line => line.replace\\(/\"\\([^\"]+\\)\":/g, '$1'\\)\\)\n\\);\n\nconsole.log\\(\"Valid diagram types in DIAGRAM_MAP:\"\\);\nArray.from\\(diagramKeys\\).sort\\(\\).forEach\\(k => console.log\\(`  ${k}`\\)\\);\n\n// Now check the data files\nconst fs = require\\('fs'\\);\nconst files = [\n  \"src/data/bmsKapitel/biologie/kap1-die-zelle.ts\",\n  \"src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts\",\n  \"src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts\",\n  \"src/data/bmsKapitel/biologie/kap4-genetik.ts\",\n  \"src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts\",\n];\n\nconst usedDiagrams = new Set\\(\\);\nfiles.forEach\\(filepath => {\n  const content = fs.readFileSync\\(filepath, 'utf-8'\\);\n  const diagramRegex = /diagram:\\\\s*[\"']\\([^\"']+\\)[\"']/g;\n  let match;\n  while \\(\\(match = diagramRegex.exec\\(content\\)\\) !== null\\) {\n    usedDiagrams.add\\(match[1]\\);\n  }\n}\\);\n\nconsole.log\\(\"\\\\nDiagram types used in bio data files:\"\\);\nArray.from\\(usedDiagrams\\).sort\\(\\).forEach\\(d => {\n  const valid = diagramKeys.has\\(d\\) ? \"✓\" : \"✗ INVALID\";\n  console.log\\(`  ${d} ${valid}`\\);\n}\\);\nEOF)",
      "Bash(cat > /tmp/extract_chapters.mjs << 'EOF'\nimport fs from \"fs\";\n\nconst files = [\n  \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap1-die-zelle.ts\",\n  \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts\",\n  \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts\",\n  \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap4-genetik.ts\",\n  \"/Users/Luki/medmaster/src/data/bmsKapitel/biologie/kap5-oekologie-immunologie.ts\",\n];\n\nfor \\(const file of files\\) {\n  const content = fs.readFileSync\\(file, \"utf-8\"\\);\n  const lines = content.split\\(\"\\\\n\"\\);\n\n  let currentUK = { id: null, title: null, hasDiagram: false };\n  let bracketDepth = 0;\n  let foundId = false;\n\n  for \\(let i = 0; i < lines.length; i++\\) {\n    const line = lines[i];\n\n    if \\(line.includes\\('id: \"bio-'\\)\\) {\n      if \\(currentUK.id\\) {\n        console.log\\(\n          `${currentUK.id} | ${currentUK.title} | ${currentUK.hasDiagram}`\n        \\);\n      }\n      const match = line.match\\(/id: \"\\([^\"]+\\)\"/\\);\n      if \\(match\\) {\n        currentUK.id = match[1];\n        currentUK.hasDiagram = false;\n        foundId = true;\n      }\n    }\n\n    if \\(foundId && line.includes\\('title: \"'\\)\\) {\n      const match = line.match\\(/title: \"\\([^\"]+\\)\"/\\);\n      if \\(match\\) {\n        currentUK.title = match[1];\n      }\n    }\n\n    if \\(line.includes\\(\"diagram:\"\\)\\) {\n      currentUK.hasDiagram = true;\n    }\n  }\n\n  if \\(currentUK.id\\) {\n    console.log\\(\n      `${currentUK.id} | ${currentUK.title} | ${currentUK.hasDiagram}`\n    \\);\n  }\n}\nEOF\nnode /tmp/extract_chapters.mjs)",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst file = 'src/data/bmsKapitel/biologie/kap1-die-zelle.ts';\nlet content = fs.readFileSync\\(file, 'utf8'\\);\n\n// Check remaining issues\nconst checks = ['sexüll', 'asexüll', 'Inflünza'];\nfor \\(const c of checks\\) {\n  if \\(content.includes\\(c\\)\\) console.log\\('Found: ' + c\\);\n  else console.log\\('NOT found: ' + c\\);\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst file = 'src/data/bmsKapitel/biologie/kap1-die-zelle.ts';\nlet content = fs.readFileSync\\(file, 'utf8'\\);\n\nconst replacements = [\n  ['sexüll', 'sexuell'],\n  ['asexüll', 'asexuell'],\n  ['Inflünza', 'Influenza'],\n];\n\nlet count = 0;\nfor \\(const [old, neu] of replacements\\) {\n  while \\(content.includes\\(old\\)\\) {\n    content = content.replace\\(old, neu\\);\n    count++;\n  }\n}\n\nfs.writeFileSync\\(file, content\\);\nconsole.log\\('Replaced ' + count + ' more occurrences'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst file = 'src/data/bmsKapitel/biologie/kap1-die-zelle.ts';\nlet content = fs.readFileSync\\(file, 'utf8'\\);\n\n// Find all altfrage positions\nconst lines = content.split\\('\\\\n'\\);\nconst altfrageLines = [];\nlines.forEach\\(\\(line, i\\) => {\n  if \\(line.match\\(/^\\\\s+altfrage:\\\\s*\\\\{/\\)\\) {\n    altfrageLines.push\\(i\\);\n  }\n}\\);\nconsole.log\\('altfrage lines \\(0-indexed\\):', altfrageLines\\);\n\n// Group by UK - altfragen that appear in the same UK block\n// UK boundaries: search for '    {' \\(4-space indent with opening brace\\) or id: patterns\nconst ukStarts = [];\nlines.forEach\\(\\(line, i\\) => {\n  if \\(line.match\\(/^\\\\s+id:\\\\s+\\\\\"/\\)\\) {\n    ukStarts.push\\(i\\);\n  }\n}\\);\nconsole.log\\('UK start lines:', ukStarts.map\\(l => lines[l].trim\\(\\).substring\\(0, 30\\)\\)\\);\n\n// For each UK, find if it has 2 altfrage\nfor \\(let u = 0; u < ukStarts.length; u++\\) {\n  const start = ukStarts[u];\n  const end = u < ukStarts.length - 1 ? ukStarts[u + 1] : lines.length;\n  const ukAltfragen = altfrageLines.filter\\(l => l >= start && l < end\\);\n  if \\(ukAltfragen.length > 1\\) {\n    const id = lines[start].trim\\(\\);\n    console.log\\('DUPLICATE altfrage in ' + id + ' at lines ' + ukAltfragen.map\\(l=>l+1\\).join\\(', '\\)\\);\n  }\n}\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst file = 'src/data/bmsKapitel/biologie/kap1-die-zelle.ts';\nconst lines = fs.readFileSync\\(file, 'utf8'\\).split\\('\\\\n'\\);\n\n// Check for any remaining duplicate properties\nconst ukStarts = [];\nlines.forEach\\(\\(line, i\\) => {\n  if \\(line.match\\(/^\\\\s+id:\\\\s+\\\\\"bio-1-0/\\)\\) ukStarts.push\\(i\\);\n}\\);\n\nfor \\(let u = 0; u < ukStarts.length; u++\\) {\n  const start = ukStarts[u];\n  const end = u < ukStarts.length - 1 ? ukStarts[u + 1] : lines.length;\n  const props = {};\n  for \\(let i = start; i < end; i++\\) {\n    const m = lines[i].match\\(/^\\\\s{6}\\(\\\\w+\\):/\\);\n    if \\(m\\) {\n      const prop = m[1];\n      if \\(props[prop]\\) console.log\\('DUPLICATE: ' + prop + ' in ' + lines[start].trim\\(\\) + ' lines ' + props[prop] + ' and ' + \\(i+1\\)\\);\n      else props[prop] = i+1;\n    }\n  }\n}\nconsole.log\\('Check complete.'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\n\n// Fix kap2 broken words and typos\nconst kap2 = 'src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts';\nlet c2 = fs.readFileSync\\(kap2, 'utf8'\\);\nconst kap2fixes = [\n  ['hochpermea bel', 'hochpermeabel'],\n  ['Kimmels tiel-Wilson', 'Kimmelstiel-Wilson'],\n  ['rückresorbi ert', 'rückresorbiort'],\n  ['Fil trationsbarriere', 'Filtrationsbarriere'],\n  ['Fasslörmi ge', 'fassförmige'],\n  ['Tinnnitus', 'Tinnitus'],\n  ['Hochtonchwerhörigkeit', 'Hochtonschwerhörigkeit'],\n];\nlet count2 = 0;\nfor \\(const [old, neu] of kap2fixes\\) {\n  while \\(c2.includes\\(old\\)\\) { c2 = c2.replace\\(old, neu\\); count2++; }\n}\nfs.writeFileSync\\(kap2, c2\\);\nconsole.log\\('kap2: ' + count2 + ' fixes'\\);\n\n// Fix kap3 typos\nconst kap3 = 'src/data/bmsKapitel/biologie/kap3-entwicklung-evolution.ts';\nlet c3 = fs.readFileSync\\(kap3, 'utf8'\\);\nconst kap3fixes = [\n  ['Selektionsvortei le', 'Selektionsvorteile'],\n  ['kollidiiert', 'kollidiert'],\n  ['evolovierte', 'evolvierte'],\n  ['Energiezufurf', 'Energiezufuhr'],\n  ['reproduktive Erfolg', 'reproduktiver Erfolg'],\n];\nlet count3 = 0;\nfor \\(const [old, neu] of kap3fixes\\) {\n  while \\(c3.includes\\(old\\)\\) { c3 = c3.replace\\(old, neu\\); count3++; }\n}\nfs.writeFileSync\\(kap3, c3\\);\nconsole.log\\('kap3: ' + count3 + ' fixes'\\);\n\")",
      "Bash(node -e \"\nconst fs = require\\('fs'\\);\nconst files = [\n  {file:'kap1-die-zelle', name:'Kap 1: Zellbiologie'},\n  {file:'kap2-anatomie-gewebe-physiologie', name:'Kap 2: Humanbiologie'},\n  {file:'kap3-entwicklung-evolution', name:'Kap 3: Entwicklung & Evolution'},\n  {file:'kap4-genetik', name:'Kap 4: Genetik'},\n  {file:'kap5-oekologie-immunologie', name:'Kap 5: Ökologie & Immunologie'}\n];\nconst result = [];\nfor \\(const f of files\\) {\n  const content = fs.readFileSync\\('src/data/bmsKapitel/biologie/' + f.file + '.ts', 'utf-8'\\);\n  // Extract each UK block\n  const ukRegex = /\\\\{\\\\s*id:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"]\\\\s*,\\\\s*title:\\\\s*['\\\\\"]\\([^'\\\\\"]+\\)['\\\\\"]/g;\n  let m;\n  const uks = [];\n  while \\(\\(m = ukRegex.exec\\(content\\)\\) !== null\\) {\n    if \\(m[1].startsWith\\('bio-'\\)\\) {\n      uks.push\\({id: m[1], title: m[2]}\\);\n    }\n  }\n  \n  // For each UK, find stichworte count, selfTest question count, merksätze count, content length\n  for \\(const uk of uks\\) {\n    const ukStart = content.indexOf\\('id: \\\\\"' + uk.id + '\\\\\"'\\) || content.indexOf\\(\\\\\"id: '\\\\\" + uk.id + \\\\\"'\\\\\"\\);\n    // Find next UK or end\n    const nextUkMatch = content.indexOf\\('id: \\\\\"bio-', ukStart + 10\\);\n    const ukContent = nextUkMatch > 0 ? content.substring\\(ukStart, nextUkMatch\\) : content.substring\\(ukStart\\);\n    \n    const stichwortMatch = ukContent.match\\(/stichworte:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n    const stichwortCount = stichwortMatch ? \\(stichwortMatch[1].match\\(/['\\\\\"][^'\\\\\"]+['\\\\\"]/g\\) || []\\).length : 0;\n    \n    const merksatzMatch = ukContent.match\\(/merksätze:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n    const merksatzCount = merksatzMatch ? \\(merksatzMatch[1].match\\(/['\\\\\"][^'\\\\\"]+['\\\\\"]/g\\) || []\\).length : 0;\n    \n    const selfTestQuestions = \\(ukContent.match\\(/question:\\\\s*['\\\\\"][^'\\\\\"]+['\\\\\"]/g\\) || []\\).length;\n    \n    const contentMatch = ukContent.match\\(/content:\\\\s*\\\\x60\\([\\\\s\\\\S]*?\\)\\\\x60/\\);\n    const contentWords = contentMatch ? contentMatch[1].split\\(/\\\\s+/\\).length : 0;\n    \n    const hasAltfrage = /altfrage:\\\\s*\\\\{/.test\\(ukContent\\);\n    const hasKlinBezug = ukContent.includes\\('klinischerBezug'\\);\n    const hasDiagram = ukContent.includes\\('diagram:'\\);\n    const hasLernziele = /lernziele:\\\\s*\\\\[/.test\\(ukContent\\);\n    const lernzieleCount = hasLernziele ? \\(\\(ukContent.match\\(/lernziele:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\) || ['','']\\)[1].match\\(/['\\\\\"][^'\\\\\"]+['\\\\\"]/g\\) || []\\).length : 0;\n    \n    uk.stichworte = stichwortCount;\n    uk.merksaetze = merksatzCount;\n    uk.selfTestQuestions = selfTestQuestions;\n    uk.contentWords = contentWords;\n    uk.hasAltfrage = hasAltfrage;\n    uk.hasKlinBezug = hasKlinBezug;\n    uk.hasDiagram = hasDiagram;\n    uk.lernziele = lernzieleCount;\n  }\n  \n  result.push\\({name: f.name, file: f.file, uks}\\);\n}\nconsole.log\\(JSON.stringify\\(result, null, 2\\)\\);\n\" 2>&1 | head -500)",
      "Bash(node -e '\nconst fs = require\\(\"fs\"\\);\nconst files = [\n  {file:\"kap1-die-zelle\", name:\"Kap 1: Zellbiologie\"},\n  {file:\"kap2-anatomie-gewebe-physiologie\", name:\"Kap 2: Humanbiologie\"},\n  {file:\"kap3-entwicklung-evolution\", name:\"Kap 3: Entwicklung & Evolution\"},\n  {file:\"kap4-genetik\", name:\"Kap 4: Genetik\"},\n  {file:\"kap5-oekologie-immunologie\", name:\"Kap 5: Ökologie & Immunologie\"}\n];\nconst result = [];\nfor \\(const f of files\\) {\n  const content = fs.readFileSync\\(\"src/data/bmsKapitel/biologie/\" + f.file + \".ts\", \"utf-8\"\\);\n  const ukRegex = /\\\\{\\\\s*id:\\\\s*\"\\([^\"]+\\)\"\\\\s*,\\\\s*title:\\\\s*\"\\([^\"]+\\)\"/g;\n  let m;\n  const uks = [];\n  while \\(\\(m = ukRegex.exec\\(content\\)\\) !== null\\) {\n    if \\(m[1].startsWith\\(\"bio-\"\\)\\) {\n      uks.push\\({id: m[1], title: m[2]}\\);\n    }\n  }\n  \n  for \\(const uk of uks\\) {\n    const ukStart = content.indexOf\\(\"id: \\\\\"\" + uk.id + \"\\\\\"\"\\);\n    const rest = content.substring\\(ukStart + 10\\);\n    const nextUk = rest.search\\(/id:\\\\s*\"bio-\\\\d+-\\\\d+\"/\\);\n    const ukContent = nextUk > 0 ? rest.substring\\(0, nextUk\\) : rest.substring\\(0, Math.min\\(rest.length, 50000\\)\\);\n    \n    const stichwortMatch = ukContent.match\\(/stichworte:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n    uk.stichworte = stichwortMatch ? \\(stichwortMatch[1].match\\(/\"[^\"]+\"/g\\) || []\\).length : 0;\n    \n    const contentMatch = ukContent.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n    uk.contentWords = contentMatch ? contentMatch[1].split\\(/\\\\s+/\\).length : 0;\n    \n    uk.selfTestQ = \\(ukContent.match\\(/question:/g\\) || []\\).length - 1; // minus altfrage question\n    if \\(uk.selfTestQ < 0\\) uk.selfTestQ = 0;\n    \n    uk.hasAltfrage = /altfrage:\\\\s*\\\\{/.test\\(ukContent\\);\n    uk.hasKlinBezug = ukContent.includes\\(\"klinischerBezug\"\\);\n    uk.hasDiagram = ukContent.includes\\(\"diagram:\"\\);\n    \n    const merksatzMatch = ukContent.match\\(/merks\\\\u00e4tze:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n    uk.merksaetze = merksatzMatch ? \\(merksatzMatch[1].match\\(/\"[^\"]+\"/g\\) || []\\).length : 0;\n  }\n  \n  result.push\\({name: f.name, file: f.file, uks}\\);\n}\nconsole.log\\(JSON.stringify\\(result, null, 2\\)\\);\n' 2>&1 | head -800)",
      "Bash(node -e '\nconst fs = require\\(\"fs\"\\);\nconst files = {\n  \"kap2-anatomie-gewebe-physiologie\": [\"bio-2-01\",\"bio-2-02\",\"bio-2-04\",\"bio-3-05\",\"bio-3-07\",\"bio-3-08\",\"bio-3-09\",\"bio-3-10\",\"bio-3-11\"],\n  \"kap3-entwicklung-evolution\": [\"bio-9-01\",\"bio-9-03\",\"bio-9-04\",\"bio-9-05\",\"bio-9-06\",\"bio-9-07\"],\n  \"kap4-genetik\": [\"bio-5-01\",\"bio-5-02\",\"bio-5-03\",\"bio-5-04\",\"bio-5-05\",\"bio-5-06\",\"bio-5-07\",\"bio-6-01\",\"bio-6-02\",\"bio-6-03\",\"bio-6-04\",\"bio-7-01\",\"bio-7-02\",\"bio-7-03\",\"bio-7-04\",\"bio-7-06\",\"bio-8-01\",\"bio-8-03\",\"bio-8-02\",\"bio-8-04\"],\n  \"kap5-oekologie-immunologie\": [\"bio-11-02\"]\n};\nfor \\(const [file, ids] of Object.entries\\(files\\)\\) {\n  const content = fs.readFileSync\\(\"src/data/bmsKapitel/biologie/\"+file+\".ts\",\"utf-8\"\\);\n  for \\(const id of ids\\) {\n    const start = content.indexOf\\(\"id: \\\\\"\"+id+\"\\\\\"\"\\);\n    if \\(start === -1\\) { console.log\\(file+\": \"+id+\" NOT FOUND\"\\); continue; }\n    const rest = content.substring\\(start\\);\n    const contentMatch = rest.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n    const words = contentMatch ? contentMatch[1].split\\(/\\\\s+/\\).length : 0;\n    console.log\\(file+\" | \"+id+\" | \"+words+\" words\"\\);\n  }\n}\n')",
      "Bash(node -e '\nconst fs = require\\(\"fs\"\\);\nconst targets = {\n  \"kap2-anatomie-gewebe-physiologie\": [\"bio-2-01\",\"bio-2-02\",\"bio-2-04\",\"bio-3-05\",\"bio-3-07\",\"bio-3-08\",\"bio-3-09\",\"bio-3-10\",\"bio-3-11\"],\n  \"kap3-entwicklung-evolution\": [\"bio-9-01\",\"bio-9-03\",\"bio-9-04\",\"bio-9-05\",\"bio-9-06\",\"bio-9-07\"],\n  \"kap4-genetik\": [\"bio-5-01\",\"bio-5-02\",\"bio-5-03\",\"bio-5-04\",\"bio-5-05\",\"bio-5-06\",\"bio-5-07\",\"bio-6-01\",\"bio-6-02\",\"bio-6-03\",\"bio-6-04\",\"bio-7-01\",\"bio-7-02\",\"bio-7-03\",\"bio-7-04\",\"bio-7-06\",\"bio-8-01\",\"bio-8-03\",\"bio-8-02\",\"bio-8-04\"],\n  \"kap5-oekologie-immunologie\": [\"bio-11-02\"]\n};\nlet under800 = 0, total = 0;\nfor \\(const [file, ids] of Object.entries\\(targets\\)\\) {\n  const content = fs.readFileSync\\(\"src/data/bmsKapitel/biologie/\"+file+\".ts\",\"utf-8\"\\);\n  for \\(const id of ids\\) {\n    const start = content.indexOf\\(\"id: \\\\\"\"+id+\"\\\\\"\"\\);\n    if \\(start === -1\\) continue;\n    const rest = content.substring\\(start\\);\n    const m = rest.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n    const words = m ? m[1].split\\(/\\\\s+/\\).length : 0;\n    const status = words >= 800 ? \"OK\" : \"SHORT\";\n    if \\(status === \"SHORT\"\\) under800++;\n    total++;\n    console.log\\(id + \": \" + words + \" words \" + status\\);\n  }\n}\nconsole.log\\(\"\\\\n\" + under800 + \"/\" + total + \" still under 800 words\"\\);\n')",
      "Bash(node -e '\nconst fs = require\\(\"fs\"\\);\nconst targets = {\n  \"kap2-anatomie-gewebe-physiologie\": [\"bio-2-01\",\"bio-3-05\",\"bio-3-07\",\"bio-3-08\",\"bio-3-09\",\"bio-3-10\",\"bio-3-11\"],\n  \"kap4-genetik\": [\"bio-5-05\",\"bio-5-07\",\"bio-7-01\",\"bio-7-03\",\"bio-7-04\",\"bio-7-06\"]\n};\nlet under = 0;\nfor \\(const [file, ids] of Object.entries\\(targets\\)\\) {\n  const content = fs.readFileSync\\(\"src/data/bmsKapitel/biologie/\"+file+\".ts\",\"utf-8\"\\);\n  for \\(const id of ids\\) {\n    const start = content.indexOf\\(\"id: \\\\\"\"+id+\"\\\\\"\"\\);\n    const rest = content.substring\\(start\\);\n    const m = rest.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n    const w = m ? m[1].split\\(/\\\\s+/\\).length : 0;\n    const ok = w >= 800 ? \"OK\" : \"SHORT\";\n    if \\(ok === \"SHORT\"\\) under++;\n    console.log\\(id + \": \" + w + \" \" + ok\\);\n  }\n}\nconsole.log\\(\"\\\\n\" + under + \" still under 800\"\\);\n' && npm run build 2>&1 | tail -2)",
      "Bash(git add src/data/bmsKapitel/biologie/kap2-anatomie-gewebe-physiologie.ts src/data/bmsKapitel/biologie/kap4-genetik.ts && git commit -m \"$\\(cat <<'EOF'\nfeat\\(bms-bio\\): expand remaining 13 short UKs to ~800 words\n\n- 8 UKs now at 800+ words \\(bio-2-01, bio-3-05, bio-3-07, bio-3-08, bio-5-05, bio-5-07, bio-7-04, bio-7-06\\)\n- 5 UKs at 768-796 words \\(within acceptable range\\)\n- Added sections: Spirometrie, forensische STRs, Base/Prime Editing, Penetranz/Expressivität\n- Build passes clean\nEOF\n\\)\")",
      "Bash(node -e '\nconst fs = require\\(\"fs\"\\);\nconst subjects = {\n  chemie: {dir:\"chemie\",files:[\"kap5-anorganische-chemie\",\"kap6-organische-chemie\"]},\n  physik: {dir:\"physik\",files:[\"kap1-mechanik-grundlagen\",\"kap3-schwingungen-und-wellen\",\"kap4-waermelehre\",\"kap4-elektrizitaet-optik\",\"kap7-atomphysik\"]},\n  mathematik: {dir:\"mathematik\",files:[\"kap1-zahlen-einheiten\",\"kap2-algebra-geometrie\",\"kap5-funktionen\",\"kap6-vektorrechnung\",\"kap7-stochastik\"]}\n};\nfor \\(const [subj, info] of Object.entries\\(subjects\\)\\) {\n  for \\(const f of info.files\\) {\n    const content = fs.readFileSync\\(\"src/data/bmsKapitel/\"+info.dir+\"/\"+f+\".ts\",\"utf-8\"\\);\n    const ukRegex = /id:\\\\s*\"\\([a-z]+-\\\\d+-\\\\d+\\)\"\\\\s*,\\\\s*title:\\\\s*\"\\([^\"]+\\)\"/g;\n    let m;\n    while \\(\\(m = ukRegex.exec\\(content\\)\\) !== null\\) {\n      const id = m[1], title = m[2];\n      const start = content.indexOf\\(\"id: \\\\\"\"+id+\"\\\\\"\"\\);\n      const rest = content.substring\\(start\\);\n      const cm = rest.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n      const words = cm ? cm[1].split\\(/\\\\s+/\\).length : 0;\n      const ms = rest.substring\\(0, 5000\\).match\\(/merks..tze:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n      const msCount = ms ? \\(ms[1].match\\(/\"[^\"]+\"/g\\) || []\\).length : 0;\n      const stm = rest.substring\\(0, 3000\\).match\\(/stichworte:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n      const stCount = stm ? \\(stm[1].match\\(/\"[^\"]+\"/g\\) || []\\).length : 0;\n      const selfQ = \\(rest.substring\\(0, 15000\\).match\\(/question:/g\\) || []\\).length - 1;\n      const hasDiag = rest.substring\\(0, 2000\\).includes\\(\"diagram:\"\\);\n      const hasAlt = rest.substring\\(0, 15000\\).includes\\(\"altfrage:\"\\);\n      const hasKlin = rest.substring\\(0, 15000\\).includes\\(\"klinischerBezug\"\\);\n      console.log\\(JSON.stringify\\({subj,file:f,id,title:title.substring\\(0,50\\),words,ms:msCount,st:stCount,sq:Math.max\\(0,selfQ\\),diag:hasDiag,alt:hasAlt,klin:hasKlin}\\)\\);\n    }\n  }\n}\n' 2>&1)",
      "Bash(node --input-type=module -e '\nimport fs from \"fs\";\nconst subjects = {\n  chemie: {dir:\"chemie\",files:[\"kap5-anorganische-chemie\",\"kap6-organische-chemie\"]},\n  physik: {dir:\"physik\",files:[\"kap1-mechanik-grundlagen\",\"kap3-schwingungen-und-wellen\",\"kap4-waermelehre\",\"kap4-elektrizitaet-optik\",\"kap7-atomphysik\"]},\n  mathematik: {dir:\"mathematik\",files:[\"kap1-zahlen-einheiten\",\"kap2-algebra-geometrie\",\"kap5-funktionen\",\"kap6-vektorrechnung\",\"kap7-stochastik\"]}\n};\nconst rows = [];\nfor \\(const [subj, info] of Object.entries\\(subjects\\)\\) {\n  for \\(const f of info.files\\) {\n    const content = fs.readFileSync\\(\"src/data/bmsKapitel/\"+info.dir+\"/\"+f+\".ts\",\"utf-8\"\\);\n    const ukRegex = /id:\\\\s*\"\\([a-z]+-[\\\\w-]+\\\\d+\\)\"\\\\s*,\\\\s*title:\\\\s*\"\\([^\"]+\\)\"/g;\n    let m;\n    while \\(\\(m = ukRegex.exec\\(content\\)\\) !== null\\) {\n      const id = m[1], title = m[2];\n      if \\(id.includes\\(\"kap\"\\)\\) continue;\n      const start = content.indexOf\\(\"id: \\\\\"\"+id+\"\\\\\"\"\\);\n      const rest = content.substring\\(start\\);\n      const cm = rest.match\\(/content:\\\\s*`\\([\\\\s\\\\S]*?\\)`/\\);\n      const words = cm ? cm[1].split\\(/\\\\s+/\\).length : 0;\n      const msMatch = rest.substring\\(0,8000\\).match\\(/merks\\\\u00e4tze:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n      const msCount = msMatch ? \\(msMatch[1].match\\(/\"[^\"]+\"/g\\)||[]\\).length : 0;\n      const stMatch = rest.substring\\(0,3000\\).match\\(/stichworte:\\\\s*\\\\[\\([\\\\s\\\\S]*?\\)\\\\]/\\);\n      const stCount = stMatch ? \\(stMatch[1].match\\(/\"[^\"]+\"/g\\)||[]\\).length : 0;\n      const sqBlock = rest.substring\\(0,20000\\);\n      const selfQ = \\(sqBlock.match\\(/question:\\\\s*\"/g\\)||[]\\).length;\n      const hasDiag = rest.substring\\(0,2000\\).includes\\(\"diagram:\"\\);\n      const hasAlt = sqBlock.includes\\(\"altfrage:\"\\);\n      const hasKlin = sqBlock.includes\\(\"klinischerBezug\"\\);\n      rows.push\\({subj,file:f,id,title:title.substring\\(0,50\\),words,ms:msCount,st:stCount,sq:Math.max\\(0,selfQ-1\\),diag:hasDiag,alt:hasAlt,klin:hasKlin}\\);\n    }\n  }\n}\nconsole.log\\(JSON.stringify\\(rows\\)\\);\n')",
      "Bash(node -e '\nconst d = require\\(\"/tmp/bms_all_data.json\"\\);\nconst stats = {};\nfor \\(const r of d\\) {\n  if \\(!stats[r.subj]\\) stats[r.subj] = {total:0,under800:0,noMs:0,noSt:0};\n  stats[r.subj].total++;\n  if \\(r.words < 800\\) stats[r.subj].under800++;\n  if \\(r.ms === 0\\) stats[r.subj].noMs++;\n  if \\(r.st === 0\\) stats[r.subj].noSt++;\n}\nconsole.log\\(JSON.stringify\\(stats, null, 2\\)\\);\n')",
      "Bash(cat /tmp/bms_all_data.json | node -e '\nlet data = \"\";\nprocess.stdin.on\\(\"data\", c => data += c\\);\nprocess.stdin.on\\(\"end\", \\(\\) => {\n  const rows = JSON.parse\\(data\\);\n  // Build JS data literal\n  const bySubj = {};\n  for \\(const r of rows\\) {\n    if \\(!bySubj[r.subj]\\) bySubj[r.subj] = [];\n    bySubj[r.subj].push\\(r\\);\n  }\n  console.log\\(\"const DATA = \" + JSON.stringify\\(bySubj\\) + \";\"\\);\n}\\);\n' > /tmp/bms_data_literal.js)",
      "Bash(cat > /Users/Luki/medmaster/scripts/extract-bms-data.mjs << 'SCRIPT_EOF'\n#!/usr/bin/env npx tsx\n// Run with: npx tsx scripts/extract-bms-data.mjs\n// Extracts all BMS chapter data into a single JSON file for the playground\n\nimport { writeFileSync } from 'node:fs';\nimport { resolve, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\nimport { alleKapitel } from '../src/data/bmsKapitel/index.js';\n\nconst __dirname = dirname\\(fileURLToPath\\(import.meta.url\\)\\);\nconst outPath = resolve\\(__dirname, '..', 'bms-playground-data.json'\\);\n\nconst data = {};\nlet totalUK = 0;\n\nfor \\(const kap of alleKapitel\\) {\n  if \\(!data[kap.subject]\\) data[kap.subject] = [];\n\n  for \\(const uk of kap.unterkapitel\\) {\n    totalUK++;\n    const wordCount = uk.content ? uk.content.split\\(/\\\\s+/\\).filter\\(Boolean\\).length : 0;\n\n    data[kap.subject].push\\({\n      id: uk.id,\n      title: uk.title,\n      kapitelId: kap.id,\n      kapitelTitle: kap.title,\n      subject: kap.subject,\n      words: wordCount,\n      stichworte: uk.stichworte || [],\n      merksaetzeCount: \\(uk.merksätze || []\\).length,\n      merksaetze: uk.merksätze || [],\n      lernziele: uk.lernziele || [],\n      selfTestCount: \\(uk.selfTest || []\\).length,\n      selfTest: uk.selfTest || [],\n      hasAltfrage: !!uk.altfrage,\n      altfrage: uk.altfrage || null,\n      hasKlinBezug: !!uk.klinischerBezug,\n      klinischerBezug: uk.klinischerBezug || '',\n      hasDiagram: !!uk.diagram,\n      diagram: uk.diagram || '',\n      content: uk.content,\n    }\\);\n  }\n}\n\n// Build summary stats\nconst stats = {};\nfor \\(const [subject, uks] of Object.entries\\(data\\)\\) {\n  const totalWords = uks.reduce\\(\\(sum, uk\\) => sum + uk.words, 0\\);\n  const under800 = uks.filter\\(uk => uk.words < 800\\).length;\n  const noMerksaetze = uks.filter\\(uk => uk.merksaetzeCount === 0\\).length;\n  const noStichworte = uks.filter\\(uk => uk.stichworte.length === 0\\).length;\n  const noSelfTest = uks.filter\\(uk => uk.selfTestCount === 0\\).length;\n\n  stats[subject] = {\n    count: uks.length,\n    totalWords,\n    avgWords: Math.round\\(totalWords / uks.length\\),\n    under800,\n    noMerksaetze,\n    noStichworte,\n    noSelfTest,\n  };\n}\n\nconst output = {\n  _generated: new Date\\(\\).toISOString\\(\\),\n  _stats: stats,\n  _totalUnterkapitel: totalUK,\n  subjects: data,\n};\n\nwriteFileSync\\(outPath, JSON.stringify\\(output, null, 2\\), 'utf-8'\\);\n\n// Print summary\nconsole.log\\(`\\\\n=== BMS Data Extraction Complete ===\\\\n`\\);\nconsole.log\\(`Output: ${outPath}`\\);\nconsole.log\\(`Total Unterkapitel: ${totalUK}\\\\n`\\);\n\nfor \\(const [subject, s] of Object.entries\\(stats\\)\\) {\n  console.log\\(`${subject.toUpperCase\\(\\)}: ${s.count} UKs | ${s.totalWords} words \\(avg ${s.avgWords}\\) | ${s.under800} under 800w | ${s.noMerksaetze} no Merksätze | ${s.noStichworte} no Stichworte | ${s.noSelfTest} no SelfTest`\\);\n}\nconsole.log\\(''\\);\nSCRIPT_EOF)",
      "Bash(wc -c /Users/Luki/medmaster/bms-playground-data.json && python3 -c \"\nimport json\nwith open\\('/Users/Luki/medmaster/bms-playground-data.json'\\) as f:\n    d = json.load\\(f\\)\nprint\\('Keys:', list\\(d.keys\\(\\)\\)\\)\nprint\\('Stats:', json.dumps\\(d['_stats'], indent=2\\)\\)\nprint\\('Subjects:', {k: len\\(v\\) for k,v in d['subjects'].items\\(\\)}\\)\nprint\\('Sample UK keys:', list\\(d['subjects']['Biologie'][0].keys\\(\\)\\)\\)\n\")",
      "Bash(cat bms-playground-data.json | python3 -c \"\nimport json, sys\ndata = json.load\\(sys.stdin\\)\n# Count UKs per subject and their status\nsubjects = {}\nbad_uks = []\nfor uk in data:\n    subj = uk.get\\('subject', 'unknown'\\)\n    if subj not in subjects:\n        subjects[subj] = {'total': 0, 'no_stichworte': 0, 'no_merksatz': 0, 'under_800': 0}\n    subjects[subj]['total'] += 1\n    \n    stichworte = uk.get\\('stichworte', []\\)\n    merksaetze = uk.get\\('merksaetze', []\\)\n    word_count = uk.get\\('wordCount', 0\\)\n    \n    if not stichworte or len\\(stichworte\\) == 0:\n        subjects[subj]['no_stichworte'] += 1\n    if not merksaetze or len\\(merksaetze\\) == 0:\n        subjects[subj]['no_merksatz'] += 1\n    if word_count < 800:\n        subjects[subj]['under_800'] += 1\n    \n    score = 0\n    if not stichworte: score += 3\n    if not merksaetze: score += 2\n    if word_count < 800: score += 2\n    if word_count < 400: score += 2\n    \n    bad_uks.append\\({\n        'id': uk.get\\('id', '?'\\),\n        'title': uk.get\\('title', '?'\\)[:40],\n        'subject': subj,\n        'words': word_count,\n        'stichworte': len\\(stichworte\\) if stichworte else 0,\n        'merksaetze': len\\(merksaetze\\) if merksaetze else 0,\n        'score': score\n    }\\)\n\nprint\\('=== SUBJECT SUMMARY ==='\\)\nfor s, d in sorted\\(subjects.items\\(\\)\\):\n    print\\(f'{s}: {d[\\\\\"total\\\\\"]} UKs | {d[\\\\\"no_stichworte\\\\\"]} no stichworte | {d[\\\\\"no_merksatz\\\\\"]} no merksatz | {d[\\\\\"under_800\\\\\"]} under 800w'\\)\n\nprint\\(f'\\\\nTotal: {sum\\(d[\\\\\"total\\\\\"] for d in subjects.values\\(\\)\\)} UKs'\\)\n\nbad_uks.sort\\(key=lambda x: -x['score']\\)\nprint\\('\\\\n=== TOP 30 WORST UKs ==='\\)\nfor uk in bad_uks[:30]:\n    print\\(f'{uk[\\\\\"id\\\\\"]:15} | {uk[\\\\\"words\\\\\"]:5}w | st:{uk[\\\\\"stichworte\\\\\"]} ms:{uk[\\\\\"merksaetze\\\\\"]} | {uk[\\\\\"subject\\\\\"]:8} | {uk[\\\\\"title\\\\\"]}'\\)\n\" 2>&1 | head -60)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\nprint\\(type\\(data\\)\\)\nif isinstance\\(data, dict\\):\n    print\\(list\\(data.keys\\(\\)\\)[:10]\\)\nelif isinstance\\(data, list\\):\n    print\\(len\\(data\\)\\)\n    print\\(type\\(data[0]\\)\\)\n    if isinstance\\(data[0], str\\):\n        print\\(data[0][:200]\\)\n\" 2>&1)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\n\nprint\\('Stats:', json.dumps\\(data.get\\('_stats', {}\\), indent=2, ensure_ascii=False\\)[:500]\\)\nprint\\('Total UKs:', data.get\\('_totalUnterkapitel'\\)\\)\nprint\\('Subjects:', list\\(data['subjects'].keys\\(\\)\\)\\)\n\n# Dig into structure\nfor subj_name, subj_data in data['subjects'].items\\(\\):\n    print\\(f'\\\\n--- {subj_name} ---'\\)\n    if isinstance\\(subj_data, dict\\):\n        print\\('Keys:', list\\(subj_data.keys\\(\\)\\)[:5]\\)\n        chapters = subj_data.get\\('chapters', subj_data.get\\('kapitel', []\\)\\)\n        if isinstance\\(chapters, list\\) and len\\(chapters\\) > 0:\n            ch = chapters[0]\n            if isinstance\\(ch, dict\\):\n                print\\('Chapter keys:', list\\(ch.keys\\(\\)\\)[:10]\\)\n                uks = ch.get\\('unterkapitel', ch.get\\('subchapters', []\\)\\)\n                if isinstance\\(uks, list\\) and len\\(uks\\) > 0:\n                    uk = uks[0]\n                    if isinstance\\(uk, dict\\):\n                        print\\('UK keys:', list\\(uk.keys\\(\\)\\)[:15]\\)\n                        print\\('UK sample:', {k: str\\(v\\)[:80] for k, v in list\\(uk.items\\(\\)\\)[:8]}\\)\n\" 2>&1)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\n\nbad_uks = []\nfor subj_name, subj_data in data['subjects'].items\\(\\):\n    if not isinstance\\(subj_data, dict\\):\n        continue\n    for ch in subj_data.get\\('chapters', []\\):\n        for uk in ch.get\\('unterkapitel', []\\):\n            wc = uk.get\\('wordCount', 0\\)\n            st = len\\(uk.get\\('stichworte', []\\)\\)\n            ms = len\\(uk.get\\('merksaetze', []\\)\\)\n            selftest = len\\(uk.get\\('selfTest', []\\)\\)\n            \n            score = 0\n            if st == 0: score += 3\n            if ms == 0: score += 2  \n            if wc < 800: score += 2\n            if wc < 400: score += 2\n            if selftest == 0: score += 1\n            \n            bad_uks.append\\({\n                'id': uk.get\\('id', '?'\\),\n                'title': uk.get\\('title', '?'\\)[:45],\n                'subject': subj_name[:4],\n                'words': wc,\n                'st': st,\n                'ms': ms,\n                'test': selftest,\n                'score': score,\n                'chapter_file': ch.get\\('file', '?'\\)\n            }\\)\n\nbad_uks.sort\\(key=lambda x: -x['score']\\)\nprint\\(f'Total UKs: {len\\(bad_uks\\)}'\\)\nprint\\(f'Need upgrade \\(score>0\\): {sum\\(1 for u in bad_uks if u[\\\\\"score\\\\\"] > 0\\)}'\\)\nprint\\(\\)\nprint\\(f'{\\\\\"ID\\\\\":15} {\\\\\"Words\\\\\":>5} {\\\\\"ST\\\\\":>3} {\\\\\"MS\\\\\":>3} {\\\\\"TQ\\\\\":>3} {\\\\\"Score\\\\\":>5} {\\\\\"Subj\\\\\":5} Title'\\)\nprint\\('-' * 100\\)\nfor uk in bad_uks[:50]:\n    print\\(f'{uk[\\\\\"id\\\\\"]:15} {uk[\\\\\"words\\\\\"]:5} {uk[\\\\\"st\\\\\"]:3} {uk[\\\\\"ms\\\\\"]:3} {uk[\\\\\"test\\\\\"]:3} {uk[\\\\\"score\\\\\"]:5} {uk[\\\\\"subject\\\\\"]:5} {uk[\\\\\"title\\\\\"]}'\\)\n\" 2>&1)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\n\n# Check actual structure of subjects\nfor subj_name, subj_data in data['subjects'].items\\(\\):\n    print\\(f'{subj_name}: type={type\\(subj_data\\).__name__}'\\)\n    if isinstance\\(subj_data, dict\\):\n        print\\(f'  keys: {list\\(subj_data.keys\\(\\)\\)[:10]}'\\)\n    elif isinstance\\(subj_data, list\\):\n        print\\(f'  len: {len\\(subj_data\\)}'\\)\n        if len\\(subj_data\\) > 0:\n            print\\(f'  [0] type: {type\\(subj_data[0]\\).__name__}'\\)\n            if isinstance\\(subj_data[0], dict\\):\n                print\\(f'  [0] keys: {list\\(subj_data[0].keys\\(\\)\\)[:10]}'\\)\n\" 2>&1)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\n\n# Now with correct structure\nbad_uks = []\nfor subj_name, uks in data['subjects'].items\\(\\):\n    for uk in uks:\n        wc = uk.get\\('words', 0\\)\n        st = len\\(uk.get\\('stichworte', []\\) or []\\)\n        ms = uk.get\\('merksaetzeCount', 0\\)\n        selftest = uk.get\\('selfTestCount', 0\\)\n        \n        score = 0\n        if st == 0: score += 3\n        if ms == 0: score += 2  \n        if wc < 800: score += 2\n        if wc < 400: score += 2\n        if selftest == 0: score += 1\n        \n        bad_uks.append\\({\n            'id': uk.get\\('id', '?'\\),\n            'title': uk.get\\('title', '?'\\)[:45],\n            'subject': subj_name[:4],\n            'words': wc,\n            'st': st,\n            'ms': ms,\n            'test': selftest,\n            'score': score,\n            'file': uk.get\\('kapitelId', '?'\\)\n        }\\)\n\nbad_uks.sort\\(key=lambda x: \\(-x['score'], x['subject'], x['id']\\)\\)\n\nprint\\(f'Total UKs: {len\\(bad_uks\\)}'\\)\nprint\\(f'Need upgrade \\(score>0\\): {sum\\(1 for u in bad_uks if u[\\\\\"score\\\\\"] > 0\\)}'\\)\nprint\\(f'Perfect \\(score=0\\): {sum\\(1 for u in bad_uks if u[\\\\\"score\\\\\"] == 0\\)}'\\)\nprint\\(\\)\n\n# Summary per subject\nfor subj in ['bio', 'chem', 'phys', 'math']:\n    s_uks = [u for u in bad_uks if u['subject'] == subj[:4]]\n    needs = sum\\(1 for u in s_uks if u['score'] > 0\\)\n    print\\(f'{subj:6}: {len\\(s_uks\\):3} total | {needs:3} need upgrade | avg {sum\\(u[\\\\\"words\\\\\"] for u in s_uks\\)//max\\(1,len\\(s_uks\\)\\)}w'\\)\n\nprint\\(\\)\nprint\\(f'{\\\\\"ID\\\\\":15} {\\\\\"Words\\\\\":>5} {\\\\\"ST\\\\\":>3} {\\\\\"MS\\\\\":>3} {\\\\\"Score\\\\\":>5} {\\\\\"Subj\\\\\":5} Title'\\)\nprint\\('-' * 95\\)\nfor uk in bad_uks[:60]:\n    if uk['score'] > 0:\n        print\\(f'{uk[\\\\\"id\\\\\"]:15} {uk[\\\\\"words\\\\\"]:5} {uk[\\\\\"st\\\\\"]:3} {uk[\\\\\"ms\\\\\"]:3} {uk[\\\\\"score\\\\\"]:5} {uk[\\\\\"subject\\\\\"]:5} {uk[\\\\\"title\\\\\"]}'\\)\n\" 2>&1)",
      "Bash(python3 -c \"\nimport json\nwith open\\('bms-playground-data.json'\\) as f:\n    data = json.load\\(f\\)\n\n# Group UKs by kapitelId to know which files to edit\nfor subj in ['chemie', 'physik', 'mathematik']:\n    print\\(f'\\\\n=== {subj.upper\\(\\)} ==='\\)\n    chapters = {}\n    for uk in data['subjects'][subj]:\n        kid = uk.get\\('kapitelId', '?'\\)\n        if kid not in chapters:\n            chapters[kid] = []\n        chapters[kid].append\\({'id': uk['id'], 'title': uk['title'][:50], 'words': uk['words']}\\)\n    \n    for kid, uks in sorted\\(chapters.items\\(\\)\\):\n        print\\(f'\\\\n  {kid} \\({len\\(uks\\)} UKs\\):'\\)\n        for uk in uks:\n            print\\(f'    {uk[\\\\\"id\\\\\"]:12} {uk[\\\\\"words\\\\\"]:5}w  {uk[\\\\\"title\\\\\"]}'\\)\n\" 2>&1)"
    ]
  }
}
