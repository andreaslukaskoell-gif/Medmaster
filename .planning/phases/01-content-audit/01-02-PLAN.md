---
phase: 01-content-audit
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/01-content-audit/QUALITY-AUDIT.md
  - src/components/chapter/MerksatzBox.tsx
  - src/components/chapter/QuizQuestion.tsx
autonomous: true
requirements:
  - SYNC-05

must_haves:
  truths:
    - "All existing chapters validated against MerksatzBox premium pattern"
    - "All existing questions validated against QuizQuestion premium pattern"
    - "Non-compliant chapters documented with specific violations"
  artifacts:
    - path: ".planning/phases/01-content-audit/QUALITY-AUDIT.md"
      provides: "Premium pattern compliance report for existing chapters"
      min_lines: 50
    - path: "src/components/chapter/MerksatzBox.tsx"
      provides: "Premium merksatz component benchmark (5 types)"
      contains: "merke.*altfragen.*klinisch.*achtung.*tipp"
  key_links:
    - from: ".planning/phases/01-content-audit/QUALITY-AUDIT.md"
      to: "src/data/bmsKapitel"
      via: "Chapter compliance analysis references Kapitel.id"
      pattern: "bio-|ch-|ph-|ma-"
---

<objective>
Validate existing BMS chapters against premium design standards (MerksatzBox + QuizQuestion patterns).

Purpose: Identify chapters that don't meet Amboss/Apple Health visual quality standards; establish quality baseline for Phase 3 elevation work.
Output: QUALITY-AUDIT.md documenting premium pattern compliance and violations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-content-audit/01-RESEARCH.md
@.planning/phases/01-content-audit/01-CONTEXT.md

@src/components/chapter/MerksatzBox.tsx
@src/components/chapter/QuizQuestion.tsx
@src/data/bmsKapitel/types.ts
@src/data/bmsKapitel/biologie/kap2-zellkern-und-ribosomen.ts
</context>

<tasks>

<task type="auto">
  <name>Audit MerksatzBox pattern compliance across existing chapters</name>
  <files>
    .planning/phases/01-content-audit/QUALITY-AUDIT.md
  </files>
  <action>
**User Decision (from CONTEXT):** Use MerksatzBox.tsx as quality benchmark. Every chapter must use MerksatzBox component with 5 types: merke, altfragen, klinisch, achtung, tipp.

Analyze all existing Kapitel files (currently: biologie/kap1-die-zelle-test.ts, kap2-zellkern-und-ribosomen.ts; chemie/mathematik/physik appear empty based on directory listing).

For each Kapitel:
1. **Check merks채tze array:**
   - Are merks채tze strings stored in Unterkapitel.merks채tze?
   - Expected: strings rendered with MerksatzBox component
   - Violation: plain text without component rendering

2. **Check premium types:**
   - Does chapter use multiple MerksatzBox types? (merke, altfragen, klinisch)
   - Expected: at least 2 types per chapter (merke + one other)
   - Violation: only default "merke" type used

3. **Check altfragen marking:**
   - Does chapter have Unterkapitel.altfrage field?
   - Expected: exam questions marked with type="altfragen"
   - Violation: exam content not differentiated

4. **Check klinischer Bezug:**
   - Does chapter have Unterkapitel.klinischerBezug field?
   - Expected: clinical highlights with type="klinisch"
   - Violation: missing clinical context

Write QUALITY-AUDIT.md with:
- **MerksatzBox Compliance** section
- Table: Kapitel ID | Merks채tze count | Types used | Altfragen marked | Klinischer Bezug present | Status
- **Violations** subsection listing specific issues per chapter
- **Benchmark Example** showing ideal pattern from kap2-zellkern-und-ribosomen.ts (if compliant)

**Premium Visual Pass (user decision):** Audit checks not just correctness but premium presentation quality. Flag chapters that use plain HTML instead of MerksatzBox component.
  </action>
  <verify>
cat .planning/phases/01-content-audit/QUALITY-AUDIT.md and confirm it contains:
- MerksatzBox Compliance section with table
- Violations listed per chapter
- Benchmark example (if any compliant chapter exists)
  </verify>
  <done>
All existing chapters audited for MerksatzBox pattern compliance; violations documented in QUALITY-AUDIT.md.
  </done>
</task>

<task type="auto">
  <name>Audit QuizQuestion pattern compliance and tag linkage</name>
  <files>
    .planning/phases/01-content-audit/QUALITY-AUDIT.md
  </files>
  <action>
**User Decision (from CONTEXT):** Use QuizQuestion.tsx as quality benchmark. Every question must use QuizQuestion component with hints, explanations, and immediate feedback.

For each chapter with selfTest or quiz arrays:
1. **Check question structure:**
   - Does SelfTestQuestion have hints array?
   - Expected: Socratic hints before solution reveal
   - Violation: missing hints (empty or undefined)

2. **Check explanation quality:**
   - Does explanation provide textbook-level detail?
   - Expected: "why" explanation, not just "correct/incorrect"
   - Violation: explanations like "Richtig" or single-word answers

3. **Check tag linkage (SYNC-05):**
   - Does question have tags field?
   - Expected: tags match linkedQuestionTags from Stichwortliste entry
   - Violation: missing tags or tags not in linkedQuestionTags

   **Implementation note:** SelfTestQuestion interface (types.ts) does NOT currently have a tags field. Document this as architectural gap requiring addition in Phase 2 or 3.

4. **Check option count (MedAT format):**
   - Does every question have exactly 5 options (A-E)?
   - Expected: options.length === 5
   - Violation: fewer or more than 5 options

Add to QUALITY-AUDIT.md:
- **QuizQuestion Compliance** section
- Table: Kapitel ID | Questions count | Have hints | Textbook explanations | Tags present | 5 options | Status
- **Tag Linkage Gaps** subsection (SYNC-05 requirement)
- **Architectural Gap** note: SelfTestQuestion.tags field missing from interface

**Stripe-Readiness (user decision):** Document in QUALITY-AUDIT.md which questions/chapters should be marked for freemium tier assignment (preparation for Phase 8). Suggest marking high-priority topics as pro content.
  </action>
  <verify>
grep -A 20 "QuizQuestion Compliance" .planning/phases/01-content-audit/QUALITY-AUDIT.md confirms section exists with compliance table and tag linkage analysis.
  </verify>
  <done>
All existing questions audited for QuizQuestion pattern compliance; tag linkage gaps and architectural requirements documented in QUALITY-AUDIT.md.
  </done>
</task>

</tasks>

<verification>
- [ ] QUALITY-AUDIT.md exists with MerksatzBox and QuizQuestion compliance sections
- [ ] MerksatzBox violations documented per chapter (types used, altfragen marking, klinischer Bezug)
- [ ] QuizQuestion violations documented (hints, explanations, tag linkage, option count)
- [ ] Architectural gap noted: SelfTestQuestion.tags field missing
- [ ] Freemium tier recommendations documented for Phase 8 preparation
</verification>

<success_criteria>
**Measurable completion:**
1. QUALITY-AUDIT.md contains compliance tables for both MerksatzBox and QuizQuestion patterns
2. Every existing Kapitel has a compliance status: "compliant", "partial", or "non-compliant"
3. Tag linkage requirement (SYNC-05) addressed with documented gaps and recommendation to add tags field to SelfTestQuestion interface
4. Freemium-readiness notes included per user decision (isPro-checks preparation)
</success_criteria>

<output>
After completion, create `.planning/phases/01-content-audit/01-02-SUMMARY.md`
</output>
