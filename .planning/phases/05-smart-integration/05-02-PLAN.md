---
phase: 05-smart-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/chapter/QuizQuestion.tsx
autonomous: true
requirements: [SMART-03]

must_haves:
  truths:
    - "Hints display automatically after user's first incorrect answer"
    - "Hint button shows 'Gib mir einen Tipp' and reveals hints incrementally"
    - "Hints are visible before solution is revealed"
  artifacts:
    - path: "src/components/chapter/QuizQuestion.tsx"
      provides: "Hint display logic with incremental reveal"
      contains: "hintIndex"
  key_links:
    - from: "QuizQuestion hint state"
      to: "question.hints array"
      via: "hintIndex counter"
      pattern: "hints.slice\\(0, hintIndex\\)"
---

<objective>
Verify hint display mechanics in QuizQuestion component work correctly for SMART-03 requirement.

Purpose: Ensure hints appear after first wrong answer and are revealed incrementally via "Gib mir einen Tipp" button, improving learning outcomes by scaffolding users toward correct answers.

Output: Documentation that hint mechanics already satisfy SMART-03, or minimal fixes if edge cases found.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-smart-integration/05-CONTEXT.md
@.planning/phases/05-smart-integration/05-RESEARCH.md

# Key Files
@src/components/chapter/QuizQuestion.tsx
@src/data/bmsKapitel/types.ts
</context>

<tasks>

<task type="auto">
  <name>Verify and document hint display logic in QuizQuestion</name>
  <files>src/components/chapter/QuizQuestion.tsx</files>
  <action>
Review QuizQuestion.tsx to verify SMART-03 requirement (hints display after first incorrect attempt):

1. **Verify hint state management** (lines 25-26):
   - `hintIndex` state starts at 0 (no hints shown initially)
   - `showNextHint()` function increments hintIndex (line 53-55)

2. **Verify hint display conditions** (lines 161-176):
   - Hints only render when `isWrong` is true (line 159: `isWrong && ...`)
   - Hints only render when `hintIndex > 0` (line 161: conditional check)
   - Hints display via `hints.slice(0, hintIndex).map(...)` (shows all hints up to current index)

3. **Verify hint button** (lines 206-218):
   - Button shows when `!solutionRevealed && hasMoreHints` (line 206)
   - Button text: "Gib mir einen Tipp" with Lightbulb icon (line 216)
   - Button onClick calls `showNextHint()` (line 209)

4. **Verify fallback hint** (line 8, 33):
   - FALLBACK_HINT constant provides default if question.hints is empty
   - Ensures hints array always has at least one entry

5. **Check for edge cases**:
   - What if question.hints is undefined? → Line 33 handles this: `question.hints && question.hints.length > 0 ? question.hints : [FALLBACK_HINT]`
   - What if user answers correctly first time? → Hints never show (isWrong=false)
   - What if user clicks "Lösung anzeigen" before hints? → solutionRevealed blocks hint button (line 206)

**If all checks pass:** No code changes needed. Document in SUMMARY that QuizQuestion already satisfies SMART-03.

**If issues found:** Make minimal fixes (e.g., add missing null checks, fix button visibility logic).

Implementation notes:
- This is primarily a verification task with documentation
- QuizQuestion was implemented in Phase 3-4 and should already work correctly
- Focus on edge case testing (empty hints array, undefined hints, etc.)
  </action>
  <verify>
Check that QuizQuestion.tsx:
- Hints only render when isWrong=true and hintIndex>0
- "Gib mir einen Tipp" button appears after first wrong answer
- showNextHint() increments hintIndex correctly
- FALLBACK_HINT prevents empty hints array
- solutionRevealed blocks hint button visibility
  </verify>
  <done>
QuizQuestion hint mechanics verified as working correctly for SMART-03, with edge cases handled (empty hints, undefined, etc.).
  </done>
</task>

</tasks>

<verification>
Manual verification steps:

1. Open any BMS chapter with quiz questions
2. Answer a question incorrectly → verify hint button appears ("Gib mir einen Tipp")
3. Click hint button → verify first hint displays in amber box
4. Click hint button again → verify second hint displays (if question has multiple hints)
5. Click "Lösung anzeigen" → verify hints stop appearing
6. Answer a question correctly on first try → verify no hints ever appear

Test edge cases:
- Question with 0 hints in data → verify FALLBACK_HINT appears
- Question with 1 hint → verify button disappears after hint shown
- Question with 3+ hints → verify button allows incremental reveal
</verification>

<success_criteria>
- Hints display only after first incorrect answer (never before, never on correct answer)
- "Gib mir einen Tipp" button reveals hints incrementally (one per click)
- FALLBACK_HINT prevents crashes when question.hints is empty/undefined
- Hints are visible before solution reveal
- Edge cases handled gracefully (no console errors)
</success_criteria>

<output>
After completion, create `.planning/phases/05-smart-integration/05-02-SUMMARY.md`
</output>
